(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var pt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Fh(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function zh(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var qd={exports:{}},Za={},Wd={exports:{}},ae={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var In=Symbol.for("react.element"),Vh=Symbol.for("react.portal"),Uh=Symbol.for("react.fragment"),Bh=Symbol.for("react.strict_mode"),qh=Symbol.for("react.profiler"),Wh=Symbol.for("react.provider"),Hh=Symbol.for("react.context"),Gh=Symbol.for("react.forward_ref"),Yh=Symbol.for("react.suspense"),Qh=Symbol.for("react.memo"),Kh=Symbol.for("react.lazy"),hc=Symbol.iterator;function Jh(e){return e===null||typeof e!="object"?null:(e=hc&&e[hc]||e["@@iterator"],typeof e=="function"?e:null)}var Hd={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Gd=Object.assign,Yd={};function $r(e,t,r){this.props=e,this.context=t,this.refs=Yd,this.updater=r||Hd}$r.prototype.isReactComponent={};$r.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};$r.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Qd(){}Qd.prototype=$r.prototype;function ul(e,t,r){this.props=e,this.context=t,this.refs=Yd,this.updater=r||Hd}var ml=ul.prototype=new Qd;ml.constructor=ul;Gd(ml,$r.prototype);ml.isPureReactComponent=!0;var xc=Array.isArray,Kd=Object.prototype.hasOwnProperty,hl={current:null},Jd={key:!0,ref:!0,__self:!0,__source:!0};function Xd(e,t,r){var n,a={},i=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)Kd.call(t,n)&&!Jd.hasOwnProperty(n)&&(a[n]=t[n]);var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];a.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)a[n]===void 0&&(a[n]=l[n]);return{$$typeof:In,type:e,key:i,ref:o,props:a,_owner:hl.current}}function Xh(e,t){return{$$typeof:In,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function xl(e){return typeof e=="object"&&e!==null&&e.$$typeof===In}function Zh(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var fc=/\/+/g;function _i(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Zh(""+e.key):t.toString(36)}function xa(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case In:case Vh:o=!0}}if(o)return o=e,a=a(o),e=n===""?"."+_i(o,0):n,xc(a)?(r="",e!=null&&(r=e.replace(fc,"$&/")+"/"),xa(a,t,r,"",function(d){return d})):a!=null&&(xl(a)&&(a=Xh(a,r+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(fc,"$&/")+"/")+e)),t.push(a)),1;if(o=0,n=n===""?".":n+":",xc(e))for(var l=0;l<e.length;l++){i=e[l];var c=n+_i(i,l);o+=xa(i,t,r,c,a)}else if(c=Jh(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=n+_i(i,l++),o+=xa(i,t,r,c,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Wn(e,t,r){if(e==null)return e;var n=[],a=0;return xa(e,n,"","",function(i){return t.call(r,i,a++)}),n}function ex(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var He={current:null},fa={transition:null},tx={ReactCurrentDispatcher:He,ReactCurrentBatchConfig:fa,ReactCurrentOwner:hl};function Zd(){throw Error("act(...) is not supported in production builds of React.")}ae.Children={map:Wn,forEach:function(e,t,r){Wn(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Wn(e,function(){t++}),t},toArray:function(e){return Wn(e,function(t){return t})||[]},only:function(e){if(!xl(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ae.Component=$r;ae.Fragment=Uh;ae.Profiler=qh;ae.PureComponent=ul;ae.StrictMode=Bh;ae.Suspense=Yh;ae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tx;ae.act=Zd;ae.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Gd({},e.props),a=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=hl.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)Kd.call(t,c)&&!Jd.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];n.children=l}return{$$typeof:In,type:e.type,key:a,ref:i,props:n,_owner:o}};ae.createContext=function(e){return e={$$typeof:Hh,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Wh,_context:e},e.Consumer=e};ae.createElement=Xd;ae.createFactory=function(e){var t=Xd.bind(null,e);return t.type=e,t};ae.createRef=function(){return{current:null}};ae.forwardRef=function(e){return{$$typeof:Gh,render:e}};ae.isValidElement=xl;ae.lazy=function(e){return{$$typeof:Kh,_payload:{_status:-1,_result:e},_init:ex}};ae.memo=function(e,t){return{$$typeof:Qh,type:e,compare:t===void 0?null:t}};ae.startTransition=function(e){var t=fa.transition;fa.transition={};try{e()}finally{fa.transition=t}};ae.unstable_act=Zd;ae.useCallback=function(e,t){return He.current.useCallback(e,t)};ae.useContext=function(e){return He.current.useContext(e)};ae.useDebugValue=function(){};ae.useDeferredValue=function(e){return He.current.useDeferredValue(e)};ae.useEffect=function(e,t){return He.current.useEffect(e,t)};ae.useId=function(){return He.current.useId()};ae.useImperativeHandle=function(e,t,r){return He.current.useImperativeHandle(e,t,r)};ae.useInsertionEffect=function(e,t){return He.current.useInsertionEffect(e,t)};ae.useLayoutEffect=function(e,t){return He.current.useLayoutEffect(e,t)};ae.useMemo=function(e,t){return He.current.useMemo(e,t)};ae.useReducer=function(e,t,r){return He.current.useReducer(e,t,r)};ae.useRef=function(e){return He.current.useRef(e)};ae.useState=function(e){return He.current.useState(e)};ae.useSyncExternalStore=function(e,t,r){return He.current.useSyncExternalStore(e,t,r)};ae.useTransition=function(){return He.current.useTransition()};ae.version="18.3.1";Wd.exports=ae;var M=Wd.exports;const je=Fh(M);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sx=M,rx=Symbol.for("react.element"),nx=Symbol.for("react.fragment"),ax=Object.prototype.hasOwnProperty,ix=sx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ox={key:!0,ref:!0,__self:!0,__source:!0};function eu(e,t,r){var n,a={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)ax.call(t,n)&&!ox.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:rx,type:e,key:i,ref:o,props:a,_owner:ix.current}}Za.Fragment=nx;Za.jsx=eu;Za.jsxs=eu;qd.exports=Za;var s=qd.exports,tu={exports:{}},lt={},su={exports:{}},ru={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(P,z){var R=P.length;P.push(z);e:for(;0<R;){var $=R-1>>>1,q=P[$];if(0<a(q,z))P[$]=z,P[R]=q,R=$;else break e}}function r(P){return P.length===0?null:P[0]}function n(P){if(P.length===0)return null;var z=P[0],R=P.pop();if(R!==z){P[0]=R;e:for(var $=0,q=P.length,Y=q>>>1;$<Y;){var F=2*($+1)-1,G=P[F],W=F+1,ee=P[W];if(0>a(G,R))W<q&&0>a(ee,G)?(P[$]=ee,P[W]=R,$=W):(P[$]=G,P[F]=R,$=F);else if(W<q&&0>a(ee,R))P[$]=ee,P[W]=R,$=W;else break e}}return z}function a(P,z){var R=P.sortIndex-z.sortIndex;return R!==0?R:P.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,m=null,h=3,g=!1,b=!1,y=!1,k=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,f=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function p(P){for(var z=r(d);z!==null;){if(z.callback===null)n(d);else if(z.startTime<=P)n(d),z.sortIndex=z.expirationTime,t(c,z);else break;z=r(d)}}function S(P){if(y=!1,p(P),!b)if(r(c)!==null)b=!0,T(C);else{var z=r(d);z!==null&&I(S,z.startTime-P)}}function C(P,z){b=!1,y&&(y=!1,x(A),A=-1),g=!0;var R=h;try{for(p(z),m=r(c);m!==null&&(!(m.expirationTime>z)||P&&!w());){var $=m.callback;if(typeof $=="function"){m.callback=null,h=m.priorityLevel;var q=$(m.expirationTime<=z);z=e.unstable_now(),typeof q=="function"?m.callback=q:m===r(c)&&n(c),p(z)}else n(c);m=r(c)}if(m!==null)var Y=!0;else{var F=r(d);F!==null&&I(S,F.startTime-z),Y=!1}return Y}finally{m=null,h=R,g=!1}}var v=!1,j=null,A=-1,L=5,E=-1;function w(){return!(e.unstable_now()-E<L)}function O(){if(j!==null){var P=e.unstable_now();E=P;var z=!0;try{z=j(!0,P)}finally{z?U():(v=!1,j=null)}}else v=!1}var U;if(typeof f=="function")U=function(){f(O)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,_=N.port2;N.port1.onmessage=O,U=function(){_.postMessage(null)}}else U=function(){k(O,0)};function T(P){j=P,v||(v=!0,U())}function I(P,z){A=k(function(){P(e.unstable_now())},z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(P){P.callback=null},e.unstable_continueExecution=function(){b||g||(b=!0,T(C))},e.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<P?Math.floor(1e3/P):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(P){switch(h){case 1:case 2:case 3:var z=3;break;default:z=h}var R=h;h=z;try{return P()}finally{h=R}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(P,z){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var R=h;h=P;try{return z()}finally{h=R}},e.unstable_scheduleCallback=function(P,z,R){var $=e.unstable_now();switch(typeof R=="object"&&R!==null?(R=R.delay,R=typeof R=="number"&&0<R?$+R:$):R=$,P){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=R+q,P={id:u++,callback:z,priorityLevel:P,startTime:R,expirationTime:q,sortIndex:-1},R>$?(P.sortIndex=R,t(d,P),r(c)===null&&P===r(d)&&(y?(x(A),A=-1):y=!0,I(S,R-$))):(P.sortIndex=q,t(c,P),b||g||(b=!0,T(C))),P},e.unstable_shouldYield=w,e.unstable_wrapCallback=function(P){var z=h;return function(){var R=h;h=z;try{return P.apply(this,arguments)}finally{h=R}}}})(ru);su.exports=ru;var lx=su.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cx=M,it=lx;function B(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var nu=new Set,xn={};function Ys(e,t){kr(e,t),kr(e+"Capture",t)}function kr(e,t){for(xn[e]=t,e=0;e<t.length;e++)nu.add(t[e])}var Qt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ao=Object.prototype.hasOwnProperty,dx=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,gc={},pc={};function ux(e){return ao.call(pc,e)?!0:ao.call(gc,e)?!1:dx.test(e)?pc[e]=!0:(gc[e]=!0,!1)}function mx(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function hx(e,t,r,n){if(t===null||typeof t>"u"||mx(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ge(e,t,r,n,a,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var Re={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Re[e]=new Ge(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Re[t]=new Ge(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Re[e]=new Ge(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Re[e]=new Ge(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Re[e]=new Ge(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Re[e]=new Ge(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Re[e]=new Ge(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Re[e]=new Ge(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Re[e]=new Ge(e,5,!1,e.toLowerCase(),null,!1,!1)});var fl=/[\-:]([a-z])/g;function gl(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(fl,gl);Re[t]=new Ge(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(fl,gl);Re[t]=new Ge(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(fl,gl);Re[t]=new Ge(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Re[e]=new Ge(e,1,!1,e.toLowerCase(),null,!1,!1)});Re.xlinkHref=new Ge("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Re[e]=new Ge(e,1,!1,e.toLowerCase(),null,!0,!0)});function pl(e,t,r,n){var a=Re.hasOwnProperty(t)?Re[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(hx(t,r,a,n)&&(r=null),n||a===null?ux(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var es=cx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Hn=Symbol.for("react.element"),ar=Symbol.for("react.portal"),ir=Symbol.for("react.fragment"),yl=Symbol.for("react.strict_mode"),io=Symbol.for("react.profiler"),au=Symbol.for("react.provider"),iu=Symbol.for("react.context"),vl=Symbol.for("react.forward_ref"),oo=Symbol.for("react.suspense"),lo=Symbol.for("react.suspense_list"),bl=Symbol.for("react.memo"),as=Symbol.for("react.lazy"),ou=Symbol.for("react.offscreen"),yc=Symbol.iterator;function Lr(e){return e===null||typeof e!="object"?null:(e=yc&&e[yc]||e["@@iterator"],typeof e=="function"?e:null)}var ve=Object.assign,ki;function Yr(e){if(ki===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);ki=t&&t[1]||""}return`
`+ki+e}var Ci=!1;function Si(e,t){if(!e||Ci)return"";Ci=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var n=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){n=d}e.call(t.prototype)}else{try{throw Error()}catch(d){n=d}e()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var a=d.stack.split(`
`),i=n.stack.split(`
`),o=a.length-1,l=i.length-1;1<=o&&0<=l&&a[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(a[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||a[o]!==i[l]){var c=`
`+a[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{Ci=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Yr(e):""}function xx(e){switch(e.tag){case 5:return Yr(e.type);case 16:return Yr("Lazy");case 13:return Yr("Suspense");case 19:return Yr("SuspenseList");case 0:case 2:case 15:return e=Si(e.type,!1),e;case 11:return e=Si(e.type.render,!1),e;case 1:return e=Si(e.type,!0),e;default:return""}}function co(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ir:return"Fragment";case ar:return"Portal";case io:return"Profiler";case yl:return"StrictMode";case oo:return"Suspense";case lo:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case iu:return(e.displayName||"Context")+".Consumer";case au:return(e._context.displayName||"Context")+".Provider";case vl:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case bl:return t=e.displayName||null,t!==null?t:co(e.type)||"Memo";case as:t=e._payload,e=e._init;try{return co(e(t))}catch{}}return null}function fx(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return co(t);case 8:return t===yl?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function _s(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function lu(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function gx(e){var t=lu(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Gn(e){e._valueTracker||(e._valueTracker=gx(e))}function cu(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=lu(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Sa(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function uo(e,t){var r=t.checked;return ve({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function vc(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=_s(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function du(e,t){t=t.checked,t!=null&&pl(e,"checked",t,!1)}function mo(e,t){du(e,t);var r=_s(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?ho(e,t.type,r):t.hasOwnProperty("defaultValue")&&ho(e,t.type,_s(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function bc(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function ho(e,t,r){(t!=="number"||Sa(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Qr=Array.isArray;function pr(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+_s(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function xo(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(B(91));return ve({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function jc(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(B(92));if(Qr(r)){if(1<r.length)throw Error(B(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:_s(r)}}function uu(e,t){var r=_s(t.value),n=_s(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Nc(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function mu(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function fo(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?mu(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Yn,hu=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Yn=Yn||document.createElement("div"),Yn.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Yn.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function fn(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Zr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},px=["Webkit","ms","Moz","O"];Object.keys(Zr).forEach(function(e){px.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Zr[t]=Zr[e]})});function xu(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Zr.hasOwnProperty(e)&&Zr[e]?(""+t).trim():t+"px"}function fu(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=xu(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var yx=ve({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function go(e,t){if(t){if(yx[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(B(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(B(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(B(61))}if(t.style!=null&&typeof t.style!="object")throw Error(B(62))}}function po(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yo=null;function jl(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var vo=null,yr=null,vr=null;function wc(e){if(e=zn(e)){if(typeof vo!="function")throw Error(B(280));var t=e.stateNode;t&&(t=ni(t),vo(e.stateNode,e.type,t))}}function gu(e){yr?vr?vr.push(e):vr=[e]:yr=e}function pu(){if(yr){var e=yr,t=vr;if(vr=yr=null,wc(e),t)for(e=0;e<t.length;e++)wc(t[e])}}function yu(e,t){return e(t)}function vu(){}var Ei=!1;function bu(e,t,r){if(Ei)return e(t,r);Ei=!0;try{return yu(e,t,r)}finally{Ei=!1,(yr!==null||vr!==null)&&(vu(),pu())}}function gn(e,t){var r=e.stateNode;if(r===null)return null;var n=ni(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(B(231,t,typeof r));return r}var bo=!1;if(Qt)try{var Fr={};Object.defineProperty(Fr,"passive",{get:function(){bo=!0}}),window.addEventListener("test",Fr,Fr),window.removeEventListener("test",Fr,Fr)}catch{bo=!1}function vx(e,t,r,n,a,i,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(r,d)}catch(u){this.onError(u)}}var en=!1,Ea=null,Ta=!1,jo=null,bx={onError:function(e){en=!0,Ea=e}};function jx(e,t,r,n,a,i,o,l,c){en=!1,Ea=null,vx.apply(bx,arguments)}function Nx(e,t,r,n,a,i,o,l,c){if(jx.apply(this,arguments),en){if(en){var d=Ea;en=!1,Ea=null}else throw Error(B(198));Ta||(Ta=!0,jo=d)}}function Qs(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function ju(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function _c(e){if(Qs(e)!==e)throw Error(B(188))}function wx(e){var t=e.alternate;if(!t){if(t=Qs(e),t===null)throw Error(B(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return _c(a),e;if(i===n)return _c(a),t;i=i.sibling}throw Error(B(188))}if(r.return!==n.return)r=a,n=i;else{for(var o=!1,l=a.child;l;){if(l===r){o=!0,r=a,n=i;break}if(l===n){o=!0,n=a,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,n=a;break}if(l===n){o=!0,n=i,r=a;break}l=l.sibling}if(!o)throw Error(B(189))}}if(r.alternate!==n)throw Error(B(190))}if(r.tag!==3)throw Error(B(188));return r.stateNode.current===r?e:t}function Nu(e){return e=wx(e),e!==null?wu(e):null}function wu(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=wu(e);if(t!==null)return t;e=e.sibling}return null}var _u=it.unstable_scheduleCallback,kc=it.unstable_cancelCallback,_x=it.unstable_shouldYield,kx=it.unstable_requestPaint,Ne=it.unstable_now,Cx=it.unstable_getCurrentPriorityLevel,Nl=it.unstable_ImmediatePriority,ku=it.unstable_UserBlockingPriority,Pa=it.unstable_NormalPriority,Sx=it.unstable_LowPriority,Cu=it.unstable_IdlePriority,ei=null,Rt=null;function Ex(e){if(Rt&&typeof Rt.onCommitFiberRoot=="function")try{Rt.onCommitFiberRoot(ei,e,void 0,(e.current.flags&128)===128)}catch{}}var Ct=Math.clz32?Math.clz32:Dx,Tx=Math.log,Px=Math.LN2;function Dx(e){return e>>>=0,e===0?32:31-(Tx(e)/Px|0)|0}var Qn=64,Kn=4194304;function Kr(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Da(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~a;l!==0?n=Kr(l):(i&=o,i!==0&&(n=Kr(i)))}else o=r&~a,o!==0?n=Kr(o):i!==0&&(n=Kr(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Ct(t),a=1<<r,n|=e[r],t&=~a;return n}function Ax(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $x(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-Ct(i),l=1<<o,c=a[o];c===-1?(!(l&r)||l&n)&&(a[o]=Ax(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function No(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Su(){var e=Qn;return Qn<<=1,!(Qn&4194240)&&(Qn=64),e}function Ti(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Ln(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ct(t),e[t]=r}function Mx(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Ct(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function wl(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Ct(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var de=0;function Eu(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Tu,_l,Pu,Du,Au,wo=!1,Jn=[],xs=null,fs=null,gs=null,pn=new Map,yn=new Map,ls=[],Rx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Cc(e,t){switch(e){case"focusin":case"focusout":xs=null;break;case"dragenter":case"dragleave":fs=null;break;case"mouseover":case"mouseout":gs=null;break;case"pointerover":case"pointerout":pn.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":yn.delete(t.pointerId)}}function zr(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=zn(t),t!==null&&_l(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function Ox(e,t,r,n,a){switch(t){case"focusin":return xs=zr(xs,e,t,r,n,a),!0;case"dragenter":return fs=zr(fs,e,t,r,n,a),!0;case"mouseover":return gs=zr(gs,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return pn.set(i,zr(pn.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,yn.set(i,zr(yn.get(i)||null,e,t,r,n,a)),!0}return!1}function $u(e){var t=Os(e.target);if(t!==null){var r=Qs(t);if(r!==null){if(t=r.tag,t===13){if(t=ju(r),t!==null){e.blockedOn=t,Au(e.priority,function(){Pu(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ga(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=_o(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);yo=n,r.target.dispatchEvent(n),yo=null}else return t=zn(r),t!==null&&_l(t),e.blockedOn=r,!1;t.shift()}return!0}function Sc(e,t,r){ga(e)&&r.delete(t)}function Ix(){wo=!1,xs!==null&&ga(xs)&&(xs=null),fs!==null&&ga(fs)&&(fs=null),gs!==null&&ga(gs)&&(gs=null),pn.forEach(Sc),yn.forEach(Sc)}function Vr(e,t){e.blockedOn===t&&(e.blockedOn=null,wo||(wo=!0,it.unstable_scheduleCallback(it.unstable_NormalPriority,Ix)))}function vn(e){function t(a){return Vr(a,e)}if(0<Jn.length){Vr(Jn[0],e);for(var r=1;r<Jn.length;r++){var n=Jn[r];n.blockedOn===e&&(n.blockedOn=null)}}for(xs!==null&&Vr(xs,e),fs!==null&&Vr(fs,e),gs!==null&&Vr(gs,e),pn.forEach(t),yn.forEach(t),r=0;r<ls.length;r++)n=ls[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<ls.length&&(r=ls[0],r.blockedOn===null);)$u(r),r.blockedOn===null&&ls.shift()}var br=es.ReactCurrentBatchConfig,Aa=!0;function Lx(e,t,r,n){var a=de,i=br.transition;br.transition=null;try{de=1,kl(e,t,r,n)}finally{de=a,br.transition=i}}function Fx(e,t,r,n){var a=de,i=br.transition;br.transition=null;try{de=4,kl(e,t,r,n)}finally{de=a,br.transition=i}}function kl(e,t,r,n){if(Aa){var a=_o(e,t,r,n);if(a===null)Fi(e,t,n,$a,r),Cc(e,n);else if(Ox(a,e,t,r,n))n.stopPropagation();else if(Cc(e,n),t&4&&-1<Rx.indexOf(e)){for(;a!==null;){var i=zn(a);if(i!==null&&Tu(i),i=_o(e,t,r,n),i===null&&Fi(e,t,n,$a,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else Fi(e,t,n,null,r)}}var $a=null;function _o(e,t,r,n){if($a=null,e=jl(n),e=Os(e),e!==null)if(t=Qs(e),t===null)e=null;else if(r=t.tag,r===13){if(e=ju(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return $a=e,null}function Mu(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Cx()){case Nl:return 1;case ku:return 4;case Pa:case Sx:return 16;case Cu:return 536870912;default:return 16}default:return 16}}var us=null,Cl=null,pa=null;function Ru(){if(pa)return pa;var e,t=Cl,r=t.length,n,a="value"in us?us.value:us.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===a[i-n];n++);return pa=a.slice(e,1<n?1-n:void 0)}function ya(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Xn(){return!0}function Ec(){return!1}function ct(e){function t(r,n,a,i,o){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Xn:Ec,this.isPropagationStopped=Ec,this}return ve(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Xn)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Xn)},persist:function(){},isPersistent:Xn}),t}var Mr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Sl=ct(Mr),Fn=ve({},Mr,{view:0,detail:0}),zx=ct(Fn),Pi,Di,Ur,ti=ve({},Fn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:El,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ur&&(Ur&&e.type==="mousemove"?(Pi=e.screenX-Ur.screenX,Di=e.screenY-Ur.screenY):Di=Pi=0,Ur=e),Pi)},movementY:function(e){return"movementY"in e?e.movementY:Di}}),Tc=ct(ti),Vx=ve({},ti,{dataTransfer:0}),Ux=ct(Vx),Bx=ve({},Fn,{relatedTarget:0}),Ai=ct(Bx),qx=ve({},Mr,{animationName:0,elapsedTime:0,pseudoElement:0}),Wx=ct(qx),Hx=ve({},Mr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Gx=ct(Hx),Yx=ve({},Mr,{data:0}),Pc=ct(Yx),Qx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Kx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Jx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Xx(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Jx[e])?!!t[e]:!1}function El(){return Xx}var Zx=ve({},Fn,{key:function(e){if(e.key){var t=Qx[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ya(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Kx[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:El,charCode:function(e){return e.type==="keypress"?ya(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ya(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),e0=ct(Zx),t0=ve({},ti,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Dc=ct(t0),s0=ve({},Fn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:El}),r0=ct(s0),n0=ve({},Mr,{propertyName:0,elapsedTime:0,pseudoElement:0}),a0=ct(n0),i0=ve({},ti,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),o0=ct(i0),l0=[9,13,27,32],Tl=Qt&&"CompositionEvent"in window,tn=null;Qt&&"documentMode"in document&&(tn=document.documentMode);var c0=Qt&&"TextEvent"in window&&!tn,Ou=Qt&&(!Tl||tn&&8<tn&&11>=tn),Ac=" ",$c=!1;function Iu(e,t){switch(e){case"keyup":return l0.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Lu(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var or=!1;function d0(e,t){switch(e){case"compositionend":return Lu(t);case"keypress":return t.which!==32?null:($c=!0,Ac);case"textInput":return e=t.data,e===Ac&&$c?null:e;default:return null}}function u0(e,t){if(or)return e==="compositionend"||!Tl&&Iu(e,t)?(e=Ru(),pa=Cl=us=null,or=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ou&&t.locale!=="ko"?null:t.data;default:return null}}var m0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!m0[e.type]:t==="textarea"}function Fu(e,t,r,n){gu(n),t=Ma(t,"onChange"),0<t.length&&(r=new Sl("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var sn=null,bn=null;function h0(e){Ku(e,0)}function si(e){var t=dr(e);if(cu(t))return e}function x0(e,t){if(e==="change")return t}var zu=!1;if(Qt){var $i;if(Qt){var Mi="oninput"in document;if(!Mi){var Rc=document.createElement("div");Rc.setAttribute("oninput","return;"),Mi=typeof Rc.oninput=="function"}$i=Mi}else $i=!1;zu=$i&&(!document.documentMode||9<document.documentMode)}function Oc(){sn&&(sn.detachEvent("onpropertychange",Vu),bn=sn=null)}function Vu(e){if(e.propertyName==="value"&&si(bn)){var t=[];Fu(t,bn,e,jl(e)),bu(h0,t)}}function f0(e,t,r){e==="focusin"?(Oc(),sn=t,bn=r,sn.attachEvent("onpropertychange",Vu)):e==="focusout"&&Oc()}function g0(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return si(bn)}function p0(e,t){if(e==="click")return si(t)}function y0(e,t){if(e==="input"||e==="change")return si(t)}function v0(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Et=typeof Object.is=="function"?Object.is:v0;function jn(e,t){if(Et(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!ao.call(t,a)||!Et(e[a],t[a]))return!1}return!0}function Ic(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Lc(e,t){var r=Ic(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Ic(r)}}function Uu(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Uu(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Bu(){for(var e=window,t=Sa();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Sa(e.document)}return t}function Pl(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function b0(e){var t=Bu(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Uu(r.ownerDocument.documentElement,r)){if(n!==null&&Pl(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=Lc(r,i);var o=Lc(r,n);a&&o&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var j0=Qt&&"documentMode"in document&&11>=document.documentMode,lr=null,ko=null,rn=null,Co=!1;function Fc(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Co||lr==null||lr!==Sa(n)||(n=lr,"selectionStart"in n&&Pl(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),rn&&jn(rn,n)||(rn=n,n=Ma(ko,"onSelect"),0<n.length&&(t=new Sl("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=lr)))}function Zn(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var cr={animationend:Zn("Animation","AnimationEnd"),animationiteration:Zn("Animation","AnimationIteration"),animationstart:Zn("Animation","AnimationStart"),transitionend:Zn("Transition","TransitionEnd")},Ri={},qu={};Qt&&(qu=document.createElement("div").style,"AnimationEvent"in window||(delete cr.animationend.animation,delete cr.animationiteration.animation,delete cr.animationstart.animation),"TransitionEvent"in window||delete cr.transitionend.transition);function ri(e){if(Ri[e])return Ri[e];if(!cr[e])return e;var t=cr[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in qu)return Ri[e]=t[r];return e}var Wu=ri("animationend"),Hu=ri("animationiteration"),Gu=ri("animationstart"),Yu=ri("transitionend"),Qu=new Map,zc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Cs(e,t){Qu.set(e,t),Ys(t,[e])}for(var Oi=0;Oi<zc.length;Oi++){var Ii=zc[Oi],N0=Ii.toLowerCase(),w0=Ii[0].toUpperCase()+Ii.slice(1);Cs(N0,"on"+w0)}Cs(Wu,"onAnimationEnd");Cs(Hu,"onAnimationIteration");Cs(Gu,"onAnimationStart");Cs("dblclick","onDoubleClick");Cs("focusin","onFocus");Cs("focusout","onBlur");Cs(Yu,"onTransitionEnd");kr("onMouseEnter",["mouseout","mouseover"]);kr("onMouseLeave",["mouseout","mouseover"]);kr("onPointerEnter",["pointerout","pointerover"]);kr("onPointerLeave",["pointerout","pointerover"]);Ys("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ys("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ys("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ys("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ys("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ys("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Jr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_0=new Set("cancel close invalid load scroll toggle".split(" ").concat(Jr));function Vc(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,Nx(n,t,void 0,e),e.currentTarget=null}function Ku(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&a.isPropagationStopped())break e;Vc(a,l,d),i=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&a.isPropagationStopped())break e;Vc(a,l,d),i=c}}}if(Ta)throw e=jo,Ta=!1,jo=null,e}function he(e,t){var r=t[Do];r===void 0&&(r=t[Do]=new Set);var n=e+"__bubble";r.has(n)||(Ju(t,e,2,!1),r.add(n))}function Li(e,t,r){var n=0;t&&(n|=4),Ju(r,e,n,t)}var ea="_reactListening"+Math.random().toString(36).slice(2);function Nn(e){if(!e[ea]){e[ea]=!0,nu.forEach(function(r){r!=="selectionchange"&&(_0.has(r)||Li(r,!1,e),Li(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ea]||(t[ea]=!0,Li("selectionchange",!1,t))}}function Ju(e,t,r,n){switch(Mu(t)){case 1:var a=Lx;break;case 4:a=Fx;break;default:a=kl}r=a.bind(null,t,r,e),a=void 0,!bo||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Fi(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;o=o.return}for(;l!==null;){if(o=Os(l),o===null)return;if(c=o.tag,c===5||c===6){n=i=o;continue e}l=l.parentNode}}n=n.return}bu(function(){var d=i,u=jl(r),m=[];e:{var h=Qu.get(e);if(h!==void 0){var g=Sl,b=e;switch(e){case"keypress":if(ya(r)===0)break e;case"keydown":case"keyup":g=e0;break;case"focusin":b="focus",g=Ai;break;case"focusout":b="blur",g=Ai;break;case"beforeblur":case"afterblur":g=Ai;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=Tc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=Ux;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=r0;break;case Wu:case Hu:case Gu:g=Wx;break;case Yu:g=a0;break;case"scroll":g=zx;break;case"wheel":g=o0;break;case"copy":case"cut":case"paste":g=Gx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=Dc}var y=(t&4)!==0,k=!y&&e==="scroll",x=y?h!==null?h+"Capture":null:h;y=[];for(var f=d,p;f!==null;){p=f;var S=p.stateNode;if(p.tag===5&&S!==null&&(p=S,x!==null&&(S=gn(f,x),S!=null&&y.push(wn(f,S,p)))),k)break;f=f.return}0<y.length&&(h=new g(h,b,null,r,u),m.push({event:h,listeners:y}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",g=e==="mouseout"||e==="pointerout",h&&r!==yo&&(b=r.relatedTarget||r.fromElement)&&(Os(b)||b[Kt]))break e;if((g||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,g?(b=r.relatedTarget||r.toElement,g=d,b=b?Os(b):null,b!==null&&(k=Qs(b),b!==k||b.tag!==5&&b.tag!==6)&&(b=null)):(g=null,b=d),g!==b)){if(y=Tc,S="onMouseLeave",x="onMouseEnter",f="mouse",(e==="pointerout"||e==="pointerover")&&(y=Dc,S="onPointerLeave",x="onPointerEnter",f="pointer"),k=g==null?h:dr(g),p=b==null?h:dr(b),h=new y(S,f+"leave",g,r,u),h.target=k,h.relatedTarget=p,S=null,Os(u)===d&&(y=new y(x,f+"enter",b,r,u),y.target=p,y.relatedTarget=k,S=y),k=S,g&&b)t:{for(y=g,x=b,f=0,p=y;p;p=Zs(p))f++;for(p=0,S=x;S;S=Zs(S))p++;for(;0<f-p;)y=Zs(y),f--;for(;0<p-f;)x=Zs(x),p--;for(;f--;){if(y===x||x!==null&&y===x.alternate)break t;y=Zs(y),x=Zs(x)}y=null}else y=null;g!==null&&Uc(m,h,g,y,!1),b!==null&&k!==null&&Uc(m,k,b,y,!0)}}e:{if(h=d?dr(d):window,g=h.nodeName&&h.nodeName.toLowerCase(),g==="select"||g==="input"&&h.type==="file")var C=x0;else if(Mc(h))if(zu)C=y0;else{C=g0;var v=f0}else(g=h.nodeName)&&g.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(C=p0);if(C&&(C=C(e,d))){Fu(m,C,r,u);break e}v&&v(e,h,d),e==="focusout"&&(v=h._wrapperState)&&v.controlled&&h.type==="number"&&ho(h,"number",h.value)}switch(v=d?dr(d):window,e){case"focusin":(Mc(v)||v.contentEditable==="true")&&(lr=v,ko=d,rn=null);break;case"focusout":rn=ko=lr=null;break;case"mousedown":Co=!0;break;case"contextmenu":case"mouseup":case"dragend":Co=!1,Fc(m,r,u);break;case"selectionchange":if(j0)break;case"keydown":case"keyup":Fc(m,r,u)}var j;if(Tl)e:{switch(e){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else or?Iu(e,r)&&(A="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(A="onCompositionStart");A&&(Ou&&r.locale!=="ko"&&(or||A!=="onCompositionStart"?A==="onCompositionEnd"&&or&&(j=Ru()):(us=u,Cl="value"in us?us.value:us.textContent,or=!0)),v=Ma(d,A),0<v.length&&(A=new Pc(A,e,null,r,u),m.push({event:A,listeners:v}),j?A.data=j:(j=Lu(r),j!==null&&(A.data=j)))),(j=c0?d0(e,r):u0(e,r))&&(d=Ma(d,"onBeforeInput"),0<d.length&&(u=new Pc("onBeforeInput","beforeinput",null,r,u),m.push({event:u,listeners:d}),u.data=j))}Ku(m,t)})}function wn(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Ma(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=gn(e,r),i!=null&&n.unshift(wn(e,i,a)),i=gn(e,t),i!=null&&n.push(wn(e,i,a))),e=e.return}return n}function Zs(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Uc(e,t,r,n,a){for(var i=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&d!==null&&(l=d,a?(c=gn(r,i),c!=null&&o.unshift(wn(r,c,l))):a||(c=gn(r,i),c!=null&&o.push(wn(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var k0=/\r\n?/g,C0=/\u0000|\uFFFD/g;function Bc(e){return(typeof e=="string"?e:""+e).replace(k0,`
`).replace(C0,"")}function ta(e,t,r){if(t=Bc(t),Bc(e)!==t&&r)throw Error(B(425))}function Ra(){}var So=null,Eo=null;function To(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Po=typeof setTimeout=="function"?setTimeout:void 0,S0=typeof clearTimeout=="function"?clearTimeout:void 0,qc=typeof Promise=="function"?Promise:void 0,E0=typeof queueMicrotask=="function"?queueMicrotask:typeof qc<"u"?function(e){return qc.resolve(null).then(e).catch(T0)}:Po;function T0(e){setTimeout(function(){throw e})}function zi(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),vn(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);vn(t)}function ps(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Wc(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Rr=Math.random().toString(36).slice(2),$t="__reactFiber$"+Rr,_n="__reactProps$"+Rr,Kt="__reactContainer$"+Rr,Do="__reactEvents$"+Rr,P0="__reactListeners$"+Rr,D0="__reactHandles$"+Rr;function Os(e){var t=e[$t];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Kt]||r[$t]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Wc(e);e!==null;){if(r=e[$t])return r;e=Wc(e)}return t}e=r,r=e.parentNode}return null}function zn(e){return e=e[$t]||e[Kt],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function dr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(B(33))}function ni(e){return e[_n]||null}var Ao=[],ur=-1;function Ss(e){return{current:e}}function xe(e){0>ur||(e.current=Ao[ur],Ao[ur]=null,ur--)}function me(e,t){ur++,Ao[ur]=e.current,e.current=t}var ks={},Ue=Ss(ks),Ze=Ss(!1),Bs=ks;function Cr(e,t){var r=e.type.contextTypes;if(!r)return ks;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function et(e){return e=e.childContextTypes,e!=null}function Oa(){xe(Ze),xe(Ue)}function Hc(e,t,r){if(Ue.current!==ks)throw Error(B(168));me(Ue,t),me(Ze,r)}function Xu(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(B(108,fx(e)||"Unknown",a));return ve({},r,n)}function Ia(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ks,Bs=Ue.current,me(Ue,e),me(Ze,Ze.current),!0}function Gc(e,t,r){var n=e.stateNode;if(!n)throw Error(B(169));r?(e=Xu(e,t,Bs),n.__reactInternalMemoizedMergedChildContext=e,xe(Ze),xe(Ue),me(Ue,e)):xe(Ze),me(Ze,r)}var Ut=null,ai=!1,Vi=!1;function Zu(e){Ut===null?Ut=[e]:Ut.push(e)}function A0(e){ai=!0,Zu(e)}function Es(){if(!Vi&&Ut!==null){Vi=!0;var e=0,t=de;try{var r=Ut;for(de=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Ut=null,ai=!1}catch(a){throw Ut!==null&&(Ut=Ut.slice(e+1)),_u(Nl,Es),a}finally{de=t,Vi=!1}}return null}var mr=[],hr=0,La=null,Fa=0,ut=[],mt=0,qs=null,qt=1,Wt="";function As(e,t){mr[hr++]=Fa,mr[hr++]=La,La=e,Fa=t}function em(e,t,r){ut[mt++]=qt,ut[mt++]=Wt,ut[mt++]=qs,qs=e;var n=qt;e=Wt;var a=32-Ct(n)-1;n&=~(1<<a),r+=1;var i=32-Ct(t)+a;if(30<i){var o=a-a%5;i=(n&(1<<o)-1).toString(32),n>>=o,a-=o,qt=1<<32-Ct(t)+a|r<<a|n,Wt=i+e}else qt=1<<i|r<<a|n,Wt=e}function Dl(e){e.return!==null&&(As(e,1),em(e,1,0))}function Al(e){for(;e===La;)La=mr[--hr],mr[hr]=null,Fa=mr[--hr],mr[hr]=null;for(;e===qs;)qs=ut[--mt],ut[mt]=null,Wt=ut[--mt],ut[mt]=null,qt=ut[--mt],ut[mt]=null}var at=null,nt=null,fe=!1,kt=null;function tm(e,t){var r=xt(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Yc(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,at=e,nt=ps(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,at=e,nt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=qs!==null?{id:qt,overflow:Wt}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=xt(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,at=e,nt=null,!0):!1;default:return!1}}function $o(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Mo(e){if(fe){var t=nt;if(t){var r=t;if(!Yc(e,t)){if($o(e))throw Error(B(418));t=ps(r.nextSibling);var n=at;t&&Yc(e,t)?tm(n,r):(e.flags=e.flags&-4097|2,fe=!1,at=e)}}else{if($o(e))throw Error(B(418));e.flags=e.flags&-4097|2,fe=!1,at=e}}}function Qc(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;at=e}function sa(e){if(e!==at)return!1;if(!fe)return Qc(e),fe=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!To(e.type,e.memoizedProps)),t&&(t=nt)){if($o(e))throw sm(),Error(B(418));for(;t;)tm(e,t),t=ps(t.nextSibling)}if(Qc(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(B(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){nt=ps(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}nt=null}}else nt=at?ps(e.stateNode.nextSibling):null;return!0}function sm(){for(var e=nt;e;)e=ps(e.nextSibling)}function Sr(){nt=at=null,fe=!1}function $l(e){kt===null?kt=[e]:kt.push(e)}var $0=es.ReactCurrentBatchConfig;function Br(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(B(309));var n=r.stateNode}if(!n)throw Error(B(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=a.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(B(284));if(!r._owner)throw Error(B(290,e))}return e}function ra(e,t){throw e=Object.prototype.toString.call(t),Error(B(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Kc(e){var t=e._init;return t(e._payload)}function rm(e){function t(x,f){if(e){var p=x.deletions;p===null?(x.deletions=[f],x.flags|=16):p.push(f)}}function r(x,f){if(!e)return null;for(;f!==null;)t(x,f),f=f.sibling;return null}function n(x,f){for(x=new Map;f!==null;)f.key!==null?x.set(f.key,f):x.set(f.index,f),f=f.sibling;return x}function a(x,f){return x=js(x,f),x.index=0,x.sibling=null,x}function i(x,f,p){return x.index=p,e?(p=x.alternate,p!==null?(p=p.index,p<f?(x.flags|=2,f):p):(x.flags|=2,f)):(x.flags|=1048576,f)}function o(x){return e&&x.alternate===null&&(x.flags|=2),x}function l(x,f,p,S){return f===null||f.tag!==6?(f=Yi(p,x.mode,S),f.return=x,f):(f=a(f,p),f.return=x,f)}function c(x,f,p,S){var C=p.type;return C===ir?u(x,f,p.props.children,S,p.key):f!==null&&(f.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===as&&Kc(C)===f.type)?(S=a(f,p.props),S.ref=Br(x,f,p),S.return=x,S):(S=ka(p.type,p.key,p.props,null,x.mode,S),S.ref=Br(x,f,p),S.return=x,S)}function d(x,f,p,S){return f===null||f.tag!==4||f.stateNode.containerInfo!==p.containerInfo||f.stateNode.implementation!==p.implementation?(f=Qi(p,x.mode,S),f.return=x,f):(f=a(f,p.children||[]),f.return=x,f)}function u(x,f,p,S,C){return f===null||f.tag!==7?(f=Vs(p,x.mode,S,C),f.return=x,f):(f=a(f,p),f.return=x,f)}function m(x,f,p){if(typeof f=="string"&&f!==""||typeof f=="number")return f=Yi(""+f,x.mode,p),f.return=x,f;if(typeof f=="object"&&f!==null){switch(f.$$typeof){case Hn:return p=ka(f.type,f.key,f.props,null,x.mode,p),p.ref=Br(x,null,f),p.return=x,p;case ar:return f=Qi(f,x.mode,p),f.return=x,f;case as:var S=f._init;return m(x,S(f._payload),p)}if(Qr(f)||Lr(f))return f=Vs(f,x.mode,p,null),f.return=x,f;ra(x,f)}return null}function h(x,f,p,S){var C=f!==null?f.key:null;if(typeof p=="string"&&p!==""||typeof p=="number")return C!==null?null:l(x,f,""+p,S);if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Hn:return p.key===C?c(x,f,p,S):null;case ar:return p.key===C?d(x,f,p,S):null;case as:return C=p._init,h(x,f,C(p._payload),S)}if(Qr(p)||Lr(p))return C!==null?null:u(x,f,p,S,null);ra(x,p)}return null}function g(x,f,p,S,C){if(typeof S=="string"&&S!==""||typeof S=="number")return x=x.get(p)||null,l(f,x,""+S,C);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Hn:return x=x.get(S.key===null?p:S.key)||null,c(f,x,S,C);case ar:return x=x.get(S.key===null?p:S.key)||null,d(f,x,S,C);case as:var v=S._init;return g(x,f,p,v(S._payload),C)}if(Qr(S)||Lr(S))return x=x.get(p)||null,u(f,x,S,C,null);ra(f,S)}return null}function b(x,f,p,S){for(var C=null,v=null,j=f,A=f=0,L=null;j!==null&&A<p.length;A++){j.index>A?(L=j,j=null):L=j.sibling;var E=h(x,j,p[A],S);if(E===null){j===null&&(j=L);break}e&&j&&E.alternate===null&&t(x,j),f=i(E,f,A),v===null?C=E:v.sibling=E,v=E,j=L}if(A===p.length)return r(x,j),fe&&As(x,A),C;if(j===null){for(;A<p.length;A++)j=m(x,p[A],S),j!==null&&(f=i(j,f,A),v===null?C=j:v.sibling=j,v=j);return fe&&As(x,A),C}for(j=n(x,j);A<p.length;A++)L=g(j,x,A,p[A],S),L!==null&&(e&&L.alternate!==null&&j.delete(L.key===null?A:L.key),f=i(L,f,A),v===null?C=L:v.sibling=L,v=L);return e&&j.forEach(function(w){return t(x,w)}),fe&&As(x,A),C}function y(x,f,p,S){var C=Lr(p);if(typeof C!="function")throw Error(B(150));if(p=C.call(p),p==null)throw Error(B(151));for(var v=C=null,j=f,A=f=0,L=null,E=p.next();j!==null&&!E.done;A++,E=p.next()){j.index>A?(L=j,j=null):L=j.sibling;var w=h(x,j,E.value,S);if(w===null){j===null&&(j=L);break}e&&j&&w.alternate===null&&t(x,j),f=i(w,f,A),v===null?C=w:v.sibling=w,v=w,j=L}if(E.done)return r(x,j),fe&&As(x,A),C;if(j===null){for(;!E.done;A++,E=p.next())E=m(x,E.value,S),E!==null&&(f=i(E,f,A),v===null?C=E:v.sibling=E,v=E);return fe&&As(x,A),C}for(j=n(x,j);!E.done;A++,E=p.next())E=g(j,x,A,E.value,S),E!==null&&(e&&E.alternate!==null&&j.delete(E.key===null?A:E.key),f=i(E,f,A),v===null?C=E:v.sibling=E,v=E);return e&&j.forEach(function(O){return t(x,O)}),fe&&As(x,A),C}function k(x,f,p,S){if(typeof p=="object"&&p!==null&&p.type===ir&&p.key===null&&(p=p.props.children),typeof p=="object"&&p!==null){switch(p.$$typeof){case Hn:e:{for(var C=p.key,v=f;v!==null;){if(v.key===C){if(C=p.type,C===ir){if(v.tag===7){r(x,v.sibling),f=a(v,p.props.children),f.return=x,x=f;break e}}else if(v.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===as&&Kc(C)===v.type){r(x,v.sibling),f=a(v,p.props),f.ref=Br(x,v,p),f.return=x,x=f;break e}r(x,v);break}else t(x,v);v=v.sibling}p.type===ir?(f=Vs(p.props.children,x.mode,S,p.key),f.return=x,x=f):(S=ka(p.type,p.key,p.props,null,x.mode,S),S.ref=Br(x,f,p),S.return=x,x=S)}return o(x);case ar:e:{for(v=p.key;f!==null;){if(f.key===v)if(f.tag===4&&f.stateNode.containerInfo===p.containerInfo&&f.stateNode.implementation===p.implementation){r(x,f.sibling),f=a(f,p.children||[]),f.return=x,x=f;break e}else{r(x,f);break}else t(x,f);f=f.sibling}f=Qi(p,x.mode,S),f.return=x,x=f}return o(x);case as:return v=p._init,k(x,f,v(p._payload),S)}if(Qr(p))return b(x,f,p,S);if(Lr(p))return y(x,f,p,S);ra(x,p)}return typeof p=="string"&&p!==""||typeof p=="number"?(p=""+p,f!==null&&f.tag===6?(r(x,f.sibling),f=a(f,p),f.return=x,x=f):(r(x,f),f=Yi(p,x.mode,S),f.return=x,x=f),o(x)):r(x,f)}return k}var Er=rm(!0),nm=rm(!1),za=Ss(null),Va=null,xr=null,Ml=null;function Rl(){Ml=xr=Va=null}function Ol(e){var t=za.current;xe(za),e._currentValue=t}function Ro(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function jr(e,t){Va=e,Ml=xr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Je=!0),e.firstContext=null)}function yt(e){var t=e._currentValue;if(Ml!==e)if(e={context:e,memoizedValue:t,next:null},xr===null){if(Va===null)throw Error(B(308));xr=e,Va.dependencies={lanes:0,firstContext:e}}else xr=xr.next=e;return t}var Is=null;function Il(e){Is===null?Is=[e]:Is.push(e)}function am(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,Il(t)):(r.next=a.next,a.next=r),t.interleaved=r,Jt(e,n)}function Jt(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var is=!1;function Ll(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function im(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Gt(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ys(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,oe&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Jt(e,r)}return a=n.interleaved,a===null?(t.next=t,Il(n)):(t.next=a.next,a.next=t),n.interleaved=t,Jt(e,r)}function va(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,wl(e,r)}}function Jc(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Ua(e,t,r,n){var a=e.updateQueue;is=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var u=e.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==o&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(i!==null){var m=a.baseState;o=0,u=d=c=null,l=i;do{var h=l.lane,g=l.eventTime;if((n&h)===h){u!==null&&(u=u.next={eventTime:g,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var b=e,y=l;switch(h=t,g=r,y.tag){case 1:if(b=y.payload,typeof b=="function"){m=b.call(g,m,h);break e}m=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=y.payload,h=typeof b=="function"?b.call(g,m,h):b,h==null)break e;m=ve({},m,h);break e;case 2:is=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=a.effects,h===null?a.effects=[l]:h.push(l))}else g={eventTime:g,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=g,c=m):u=u.next=g,o|=h;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;h=l,l=h.next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}while(!0);if(u===null&&(c=m),a.baseState=c,a.firstBaseUpdate=d,a.lastBaseUpdate=u,t=a.shared.interleaved,t!==null){a=t;do o|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);Hs|=o,e.lanes=o,e.memoizedState=m}}function Xc(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(B(191,a));a.call(n)}}}var Vn={},Ot=Ss(Vn),kn=Ss(Vn),Cn=Ss(Vn);function Ls(e){if(e===Vn)throw Error(B(174));return e}function Fl(e,t){switch(me(Cn,t),me(kn,e),me(Ot,Vn),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:fo(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=fo(t,e)}xe(Ot),me(Ot,t)}function Tr(){xe(Ot),xe(kn),xe(Cn)}function om(e){Ls(Cn.current);var t=Ls(Ot.current),r=fo(t,e.type);t!==r&&(me(kn,e),me(Ot,r))}function zl(e){kn.current===e&&(xe(Ot),xe(kn))}var pe=Ss(0);function Ba(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ui=[];function Vl(){for(var e=0;e<Ui.length;e++)Ui[e]._workInProgressVersionPrimary=null;Ui.length=0}var ba=es.ReactCurrentDispatcher,Bi=es.ReactCurrentBatchConfig,Ws=0,ye=null,ke=null,Ee=null,qa=!1,nn=!1,Sn=0,M0=0;function Oe(){throw Error(B(321))}function Ul(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Et(e[r],t[r]))return!1;return!0}function Bl(e,t,r,n,a,i){if(Ws=i,ye=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ba.current=e===null||e.memoizedState===null?L0:F0,e=r(n,a),nn){i=0;do{if(nn=!1,Sn=0,25<=i)throw Error(B(301));i+=1,Ee=ke=null,t.updateQueue=null,ba.current=z0,e=r(n,a)}while(nn)}if(ba.current=Wa,t=ke!==null&&ke.next!==null,Ws=0,Ee=ke=ye=null,qa=!1,t)throw Error(B(300));return e}function ql(){var e=Sn!==0;return Sn=0,e}function Dt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ee===null?ye.memoizedState=Ee=e:Ee=Ee.next=e,Ee}function vt(){if(ke===null){var e=ye.alternate;e=e!==null?e.memoizedState:null}else e=ke.next;var t=Ee===null?ye.memoizedState:Ee.next;if(t!==null)Ee=t,ke=e;else{if(e===null)throw Error(B(310));ke=e,e={memoizedState:ke.memoizedState,baseState:ke.baseState,baseQueue:ke.baseQueue,queue:ke.queue,next:null},Ee===null?ye.memoizedState=Ee=e:Ee=Ee.next=e}return Ee}function En(e,t){return typeof t=="function"?t(e):t}function qi(e){var t=vt(),r=t.queue;if(r===null)throw Error(B(311));r.lastRenderedReducer=e;var n=ke,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var o=a.next;a.next=i.next,i.next=o}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var l=o=null,c=null,d=i;do{var u=d.lane;if((Ws&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:e(n,d.action);else{var m={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=m,o=n):c=c.next=m,ye.lanes|=u,Hs|=u}d=d.next}while(d!==null&&d!==i);c===null?o=n:c.next=l,Et(n,t.memoizedState)||(Je=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,ye.lanes|=i,Hs|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Wi(e){var t=vt(),r=t.queue;if(r===null)throw Error(B(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var o=a=a.next;do i=e(i,o.action),o=o.next;while(o!==a);Et(i,t.memoizedState)||(Je=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function lm(){}function cm(e,t){var r=ye,n=vt(),a=t(),i=!Et(n.memoizedState,a);if(i&&(n.memoizedState=a,Je=!0),n=n.queue,Wl(mm.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||Ee!==null&&Ee.memoizedState.tag&1){if(r.flags|=2048,Tn(9,um.bind(null,r,n,a,t),void 0,null),Te===null)throw Error(B(349));Ws&30||dm(r,t,a)}return a}function dm(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=ye.updateQueue,t===null?(t={lastEffect:null,stores:null},ye.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function um(e,t,r,n){t.value=r,t.getSnapshot=n,hm(t)&&xm(e)}function mm(e,t,r){return r(function(){hm(t)&&xm(e)})}function hm(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Et(e,r)}catch{return!0}}function xm(e){var t=Jt(e,1);t!==null&&St(t,e,1,-1)}function Zc(e){var t=Dt();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:En,lastRenderedState:e},t.queue=e,e=e.dispatch=I0.bind(null,ye,e),[t.memoizedState,e]}function Tn(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=ye.updateQueue,t===null?(t={lastEffect:null,stores:null},ye.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function fm(){return vt().memoizedState}function ja(e,t,r,n){var a=Dt();ye.flags|=e,a.memoizedState=Tn(1|t,r,void 0,n===void 0?null:n)}function ii(e,t,r,n){var a=vt();n=n===void 0?null:n;var i=void 0;if(ke!==null){var o=ke.memoizedState;if(i=o.destroy,n!==null&&Ul(n,o.deps)){a.memoizedState=Tn(t,r,i,n);return}}ye.flags|=e,a.memoizedState=Tn(1|t,r,i,n)}function ed(e,t){return ja(8390656,8,e,t)}function Wl(e,t){return ii(2048,8,e,t)}function gm(e,t){return ii(4,2,e,t)}function pm(e,t){return ii(4,4,e,t)}function ym(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function vm(e,t,r){return r=r!=null?r.concat([e]):null,ii(4,4,ym.bind(null,t,e),r)}function Hl(){}function bm(e,t){var r=vt();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Ul(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function jm(e,t){var r=vt();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Ul(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Nm(e,t,r){return Ws&21?(Et(r,t)||(r=Su(),ye.lanes|=r,Hs|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Je=!0),e.memoizedState=r)}function R0(e,t){var r=de;de=r!==0&&4>r?r:4,e(!0);var n=Bi.transition;Bi.transition={};try{e(!1),t()}finally{de=r,Bi.transition=n}}function wm(){return vt().memoizedState}function O0(e,t,r){var n=bs(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},_m(e))km(t,r);else if(r=am(e,t,r,n),r!==null){var a=We();St(r,e,n,a),Cm(r,t,n)}}function I0(e,t,r){var n=bs(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(_m(e))km(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,r);if(a.hasEagerState=!0,a.eagerState=l,Et(l,o)){var c=t.interleaved;c===null?(a.next=a,Il(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch{}finally{}r=am(e,t,a,n),r!==null&&(a=We(),St(r,e,n,a),Cm(r,t,n))}}function _m(e){var t=e.alternate;return e===ye||t!==null&&t===ye}function km(e,t){nn=qa=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Cm(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,wl(e,r)}}var Wa={readContext:yt,useCallback:Oe,useContext:Oe,useEffect:Oe,useImperativeHandle:Oe,useInsertionEffect:Oe,useLayoutEffect:Oe,useMemo:Oe,useReducer:Oe,useRef:Oe,useState:Oe,useDebugValue:Oe,useDeferredValue:Oe,useTransition:Oe,useMutableSource:Oe,useSyncExternalStore:Oe,useId:Oe,unstable_isNewReconciler:!1},L0={readContext:yt,useCallback:function(e,t){return Dt().memoizedState=[e,t===void 0?null:t],e},useContext:yt,useEffect:ed,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,ja(4194308,4,ym.bind(null,t,e),r)},useLayoutEffect:function(e,t){return ja(4194308,4,e,t)},useInsertionEffect:function(e,t){return ja(4,2,e,t)},useMemo:function(e,t){var r=Dt();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Dt();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=O0.bind(null,ye,e),[n.memoizedState,e]},useRef:function(e){var t=Dt();return e={current:e},t.memoizedState=e},useState:Zc,useDebugValue:Hl,useDeferredValue:function(e){return Dt().memoizedState=e},useTransition:function(){var e=Zc(!1),t=e[0];return e=R0.bind(null,e[1]),Dt().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=ye,a=Dt();if(fe){if(r===void 0)throw Error(B(407));r=r()}else{if(r=t(),Te===null)throw Error(B(349));Ws&30||dm(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,ed(mm.bind(null,n,i,e),[e]),n.flags|=2048,Tn(9,um.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=Dt(),t=Te.identifierPrefix;if(fe){var r=Wt,n=qt;r=(n&~(1<<32-Ct(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Sn++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=M0++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},F0={readContext:yt,useCallback:bm,useContext:yt,useEffect:Wl,useImperativeHandle:vm,useInsertionEffect:gm,useLayoutEffect:pm,useMemo:jm,useReducer:qi,useRef:fm,useState:function(){return qi(En)},useDebugValue:Hl,useDeferredValue:function(e){var t=vt();return Nm(t,ke.memoizedState,e)},useTransition:function(){var e=qi(En)[0],t=vt().memoizedState;return[e,t]},useMutableSource:lm,useSyncExternalStore:cm,useId:wm,unstable_isNewReconciler:!1},z0={readContext:yt,useCallback:bm,useContext:yt,useEffect:Wl,useImperativeHandle:vm,useInsertionEffect:gm,useLayoutEffect:pm,useMemo:jm,useReducer:Wi,useRef:fm,useState:function(){return Wi(En)},useDebugValue:Hl,useDeferredValue:function(e){var t=vt();return ke===null?t.memoizedState=e:Nm(t,ke.memoizedState,e)},useTransition:function(){var e=Wi(En)[0],t=vt().memoizedState;return[e,t]},useMutableSource:lm,useSyncExternalStore:cm,useId:wm,unstable_isNewReconciler:!1};function Nt(e,t){if(e&&e.defaultProps){t=ve({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Oo(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:ve({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var oi={isMounted:function(e){return(e=e._reactInternals)?Qs(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=We(),a=bs(e),i=Gt(n,a);i.payload=t,r!=null&&(i.callback=r),t=ys(e,i,a),t!==null&&(St(t,e,a,n),va(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=We(),a=bs(e),i=Gt(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=ys(e,i,a),t!==null&&(St(t,e,a,n),va(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=We(),n=bs(e),a=Gt(r,n);a.tag=2,t!=null&&(a.callback=t),t=ys(e,a,n),t!==null&&(St(t,e,n,r),va(t,e,n))}};function td(e,t,r,n,a,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,o):t.prototype&&t.prototype.isPureReactComponent?!jn(r,n)||!jn(a,i):!0}function Sm(e,t,r){var n=!1,a=ks,i=t.contextType;return typeof i=="object"&&i!==null?i=yt(i):(a=et(t)?Bs:Ue.current,n=t.contextTypes,i=(n=n!=null)?Cr(e,a):ks),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=oi,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function sd(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&oi.enqueueReplaceState(t,t.state,null)}function Io(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},Ll(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=yt(i):(i=et(t)?Bs:Ue.current,a.context=Cr(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Oo(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&oi.enqueueReplaceState(a,a.state,null),Ua(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Pr(e,t){try{var r="",n=t;do r+=xx(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function Hi(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Lo(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var V0=typeof WeakMap=="function"?WeakMap:Map;function Em(e,t,r){r=Gt(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Ga||(Ga=!0,Yo=n),Lo(e,t)},r}function Tm(e,t,r){r=Gt(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){Lo(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){Lo(e,t),typeof n!="function"&&(vs===null?vs=new Set([this]):vs.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function rd(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new V0;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=tf.bind(null,e,t,r),t.then(e,e))}function nd(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function ad(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Gt(-1,1),t.tag=2,ys(r,t,1))),r.lanes|=1),e)}var U0=es.ReactCurrentOwner,Je=!1;function qe(e,t,r,n){t.child=e===null?nm(t,null,r,n):Er(t,e.child,r,n)}function id(e,t,r,n,a){r=r.render;var i=t.ref;return jr(t,a),n=Bl(e,t,r,n,i,a),r=ql(),e!==null&&!Je?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Xt(e,t,a)):(fe&&r&&Dl(t),t.flags|=1,qe(e,t,n,a),t.child)}function od(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!ec(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,Pm(e,t,i,n,a)):(e=ka(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:jn,r(o,n)&&e.ref===t.ref)return Xt(e,t,a)}return t.flags|=1,e=js(i,n),e.ref=t.ref,e.return=t,t.child=e}function Pm(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(jn(i,n)&&e.ref===t.ref)if(Je=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(Je=!0);else return t.lanes=e.lanes,Xt(e,t,a)}return Fo(e,t,r,n,a)}function Dm(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},me(gr,rt),rt|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,me(gr,rt),rt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,me(gr,rt),rt|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,me(gr,rt),rt|=n;return qe(e,t,a,r),t.child}function Am(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Fo(e,t,r,n,a){var i=et(r)?Bs:Ue.current;return i=Cr(t,i),jr(t,a),r=Bl(e,t,r,n,i,a),n=ql(),e!==null&&!Je?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Xt(e,t,a)):(fe&&n&&Dl(t),t.flags|=1,qe(e,t,r,a),t.child)}function ld(e,t,r,n,a){if(et(r)){var i=!0;Ia(t)}else i=!1;if(jr(t,a),t.stateNode===null)Na(e,t),Sm(t,r,n),Io(t,r,n,a),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,d=r.contextType;typeof d=="object"&&d!==null?d=yt(d):(d=et(r)?Bs:Ue.current,d=Cr(t,d));var u=r.getDerivedStateFromProps,m=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==d)&&sd(t,o,n,d),is=!1;var h=t.memoizedState;o.state=h,Ua(t,n,o,a),c=t.memoizedState,l!==n||h!==c||Ze.current||is?(typeof u=="function"&&(Oo(t,r,u,n),c=t.memoizedState),(l=is||td(t,r,l,n,h,c,d))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=d,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,im(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:Nt(t.type,l),o.props=d,m=t.pendingProps,h=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=yt(c):(c=et(r)?Bs:Ue.current,c=Cr(t,c));var g=r.getDerivedStateFromProps;(u=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==m||h!==c)&&sd(t,o,n,c),is=!1,h=t.memoizedState,o.state=h,Ua(t,n,o,a);var b=t.memoizedState;l!==m||h!==b||Ze.current||is?(typeof g=="function"&&(Oo(t,r,g,n),b=t.memoizedState),(d=is||td(t,r,d,n,h,b,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,b,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,b,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=b),o.props=n,o.state=b,o.context=c,n=d):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return zo(e,t,r,n,i,a)}function zo(e,t,r,n,a,i){Am(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return a&&Gc(t,r,!1),Xt(e,t,i);n=t.stateNode,U0.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=Er(t,e.child,null,i),t.child=Er(t,null,l,i)):qe(e,t,l,i),t.memoizedState=n.state,a&&Gc(t,r,!0),t.child}function $m(e){var t=e.stateNode;t.pendingContext?Hc(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Hc(e,t.context,!1),Fl(e,t.containerInfo)}function cd(e,t,r,n,a){return Sr(),$l(a),t.flags|=256,qe(e,t,r,n),t.child}var Vo={dehydrated:null,treeContext:null,retryLane:0};function Uo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Mm(e,t,r){var n=t.pendingProps,a=pe.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(a&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),me(pe,a&1),e===null)return Mo(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,i?(n=t.mode,i=t.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=di(o,n,0,null),e=Vs(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Uo(r),t.memoizedState=Vo,e):Gl(t,o));if(a=e.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return B0(e,t,o,n,l,a,r);if(i){i=n.fallback,o=t.mode,a=e.child,l=a.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=js(a,c),n.subtreeFlags=a.subtreeFlags&14680064),l!==null?i=js(l,i):(i=Vs(i,o,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,o=e.child.memoizedState,o=o===null?Uo(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~r,t.memoizedState=Vo,n}return i=e.child,e=i.sibling,n=js(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Gl(e,t){return t=di({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function na(e,t,r,n){return n!==null&&$l(n),Er(t,e.child,null,r),e=Gl(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function B0(e,t,r,n,a,i,o){if(r)return t.flags&256?(t.flags&=-257,n=Hi(Error(B(422))),na(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=di({mode:"visible",children:n.children},a,0,null),i=Vs(i,a,o,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&Er(t,e.child,null,o),t.child.memoizedState=Uo(o),t.memoizedState=Vo,i);if(!(t.mode&1))return na(e,t,o,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(B(419)),n=Hi(i,n,void 0),na(e,t,o,n)}if(l=(o&e.childLanes)!==0,Je||l){if(n=Te,n!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|o)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,Jt(e,a),St(n,e,a,-1))}return Zl(),n=Hi(Error(B(421))),na(e,t,o,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=sf.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,nt=ps(a.nextSibling),at=t,fe=!0,kt=null,e!==null&&(ut[mt++]=qt,ut[mt++]=Wt,ut[mt++]=qs,qt=e.id,Wt=e.overflow,qs=t),t=Gl(t,n.children),t.flags|=4096,t)}function dd(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Ro(e.return,t,r)}function Gi(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function Rm(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(qe(e,t,n.children,r),n=pe.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&dd(e,r,t);else if(e.tag===19)dd(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(me(pe,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&Ba(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),Gi(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Ba(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}Gi(t,!0,r,null,i);break;case"together":Gi(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Na(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Xt(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Hs|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(B(153));if(t.child!==null){for(e=t.child,r=js(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=js(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function q0(e,t,r){switch(t.tag){case 3:$m(t),Sr();break;case 5:om(t);break;case 1:et(t.type)&&Ia(t);break;case 4:Fl(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;me(za,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(me(pe,pe.current&1),t.flags|=128,null):r&t.child.childLanes?Mm(e,t,r):(me(pe,pe.current&1),e=Xt(e,t,r),e!==null?e.sibling:null);me(pe,pe.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Rm(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),me(pe,pe.current),n)break;return null;case 22:case 23:return t.lanes=0,Dm(e,t,r)}return Xt(e,t,r)}var Om,Bo,Im,Lm;Om=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Bo=function(){};Im=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Ls(Ot.current);var i=null;switch(r){case"input":a=uo(e,a),n=uo(e,n),i=[];break;case"select":a=ve({},a,{value:void 0}),n=ve({},n,{value:void 0}),i=[];break;case"textarea":a=xo(e,a),n=xo(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Ra)}go(r,n);var o;r=null;for(d in a)if(!n.hasOwnProperty(d)&&a.hasOwnProperty(d)&&a[d]!=null)if(d==="style"){var l=a[d];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(xn.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in n){var c=n[d];if(l=a!=null?a[d]:void 0,n.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(i||(i=[]),i.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(xn.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&he("scroll",e),i||l===c||(i=[])):(i=i||[]).push(d,c))}r&&(i=i||[]).push("style",r);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};Lm=function(e,t,r,n){r!==n&&(t.flags|=4)};function qr(e,t){if(!fe)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ie(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function W0(e,t,r){var n=t.pendingProps;switch(Al(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ie(t),null;case 1:return et(t.type)&&Oa(),Ie(t),null;case 3:return n=t.stateNode,Tr(),xe(Ze),xe(Ue),Vl(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(sa(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,kt!==null&&(Jo(kt),kt=null))),Bo(e,t),Ie(t),null;case 5:zl(t);var a=Ls(Cn.current);if(r=t.type,e!==null&&t.stateNode!=null)Im(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(B(166));return Ie(t),null}if(e=Ls(Ot.current),sa(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[$t]=t,n[_n]=i,e=(t.mode&1)!==0,r){case"dialog":he("cancel",n),he("close",n);break;case"iframe":case"object":case"embed":he("load",n);break;case"video":case"audio":for(a=0;a<Jr.length;a++)he(Jr[a],n);break;case"source":he("error",n);break;case"img":case"image":case"link":he("error",n),he("load",n);break;case"details":he("toggle",n);break;case"input":vc(n,i),he("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},he("invalid",n);break;case"textarea":jc(n,i),he("invalid",n)}go(r,i),a=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&ta(n.textContent,l,e),a=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&ta(n.textContent,l,e),a=["children",""+l]):xn.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&he("scroll",n)}switch(r){case"input":Gn(n),bc(n,i,!0);break;case"textarea":Gn(n),Nc(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Ra)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=mu(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[$t]=t,e[_n]=n,Om(e,t,!1,!1),t.stateNode=e;e:{switch(o=po(r,n),r){case"dialog":he("cancel",e),he("close",e),a=n;break;case"iframe":case"object":case"embed":he("load",e),a=n;break;case"video":case"audio":for(a=0;a<Jr.length;a++)he(Jr[a],e);a=n;break;case"source":he("error",e),a=n;break;case"img":case"image":case"link":he("error",e),he("load",e),a=n;break;case"details":he("toggle",e),a=n;break;case"input":vc(e,n),a=uo(e,n),he("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=ve({},n,{value:void 0}),he("invalid",e);break;case"textarea":jc(e,n),a=xo(e,n),he("invalid",e);break;default:a=n}go(r,a),l=a;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?fu(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&hu(e,c)):i==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&fn(e,c):typeof c=="number"&&fn(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(xn.hasOwnProperty(i)?c!=null&&i==="onScroll"&&he("scroll",e):c!=null&&pl(e,i,c,o))}switch(r){case"input":Gn(e),bc(e,n,!1);break;case"textarea":Gn(e),Nc(e);break;case"option":n.value!=null&&e.setAttribute("value",""+_s(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?pr(e,!!n.multiple,i,!1):n.defaultValue!=null&&pr(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Ra)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ie(t),null;case 6:if(e&&t.stateNode!=null)Lm(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(B(166));if(r=Ls(Cn.current),Ls(Ot.current),sa(t)){if(n=t.stateNode,r=t.memoizedProps,n[$t]=t,(i=n.nodeValue!==r)&&(e=at,e!==null))switch(e.tag){case 3:ta(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ta(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[$t]=t,t.stateNode=n}return Ie(t),null;case 13:if(xe(pe),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(fe&&nt!==null&&t.mode&1&&!(t.flags&128))sm(),Sr(),t.flags|=98560,i=!1;else if(i=sa(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(B(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(B(317));i[$t]=t}else Sr(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ie(t),i=!1}else kt!==null&&(Jo(kt),kt=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||pe.current&1?Ce===0&&(Ce=3):Zl())),t.updateQueue!==null&&(t.flags|=4),Ie(t),null);case 4:return Tr(),Bo(e,t),e===null&&Nn(t.stateNode.containerInfo),Ie(t),null;case 10:return Ol(t.type._context),Ie(t),null;case 17:return et(t.type)&&Oa(),Ie(t),null;case 19:if(xe(pe),i=t.memoizedState,i===null)return Ie(t),null;if(n=(t.flags&128)!==0,o=i.rendering,o===null)if(n)qr(i,!1);else{if(Ce!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Ba(e),o!==null){for(t.flags|=128,qr(i,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return me(pe,pe.current&1|2),t.child}e=e.sibling}i.tail!==null&&Ne()>Dr&&(t.flags|=128,n=!0,qr(i,!1),t.lanes=4194304)}else{if(!n)if(e=Ba(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),qr(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!fe)return Ie(t),null}else 2*Ne()-i.renderingStartTime>Dr&&r!==1073741824&&(t.flags|=128,n=!0,qr(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(r=i.last,r!==null?r.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Ne(),t.sibling=null,r=pe.current,me(pe,n?r&1|2:r&1),t):(Ie(t),null);case 22:case 23:return Xl(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?rt&1073741824&&(Ie(t),t.subtreeFlags&6&&(t.flags|=8192)):Ie(t),null;case 24:return null;case 25:return null}throw Error(B(156,t.tag))}function H0(e,t){switch(Al(t),t.tag){case 1:return et(t.type)&&Oa(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Tr(),xe(Ze),xe(Ue),Vl(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return zl(t),null;case 13:if(xe(pe),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(B(340));Sr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return xe(pe),null;case 4:return Tr(),null;case 10:return Ol(t.type._context),null;case 22:case 23:return Xl(),null;case 24:return null;default:return null}}var aa=!1,Fe=!1,G0=typeof WeakSet=="function"?WeakSet:Set,H=null;function fr(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){be(e,t,n)}else r.current=null}function qo(e,t,r){try{r()}catch(n){be(e,t,n)}}var ud=!1;function Y0(e,t){if(So=Aa,e=Bu(),Pl(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,d=0,u=0,m=e,h=null;t:for(;;){for(var g;m!==r||a!==0&&m.nodeType!==3||(l=o+a),m!==i||n!==0&&m.nodeType!==3||(c=o+n),m.nodeType===3&&(o+=m.nodeValue.length),(g=m.firstChild)!==null;)h=m,m=g;for(;;){if(m===e)break t;if(h===r&&++d===a&&(l=o),h===i&&++u===n&&(c=o),(g=m.nextSibling)!==null)break;m=h,h=m.parentNode}m=g}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Eo={focusedElem:e,selectionRange:r},Aa=!1,H=t;H!==null;)if(t=H,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,H=e;else for(;H!==null;){t=H;try{var b=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var y=b.memoizedProps,k=b.memoizedState,x=t.stateNode,f=x.getSnapshotBeforeUpdate(t.elementType===t.type?y:Nt(t.type,y),k);x.__reactInternalSnapshotBeforeUpdate=f}break;case 3:var p=t.stateNode.containerInfo;p.nodeType===1?p.textContent="":p.nodeType===9&&p.documentElement&&p.removeChild(p.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(B(163))}}catch(S){be(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,H=e;break}H=t.return}return b=ud,ud=!1,b}function an(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&qo(t,r,i)}a=a.next}while(a!==n)}}function li(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Wo(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Fm(e){var t=e.alternate;t!==null&&(e.alternate=null,Fm(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[$t],delete t[_n],delete t[Do],delete t[P0],delete t[D0])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function zm(e){return e.tag===5||e.tag===3||e.tag===4}function md(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||zm(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Ho(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Ra));else if(n!==4&&(e=e.child,e!==null))for(Ho(e,t,r),e=e.sibling;e!==null;)Ho(e,t,r),e=e.sibling}function Go(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Go(e,t,r),e=e.sibling;e!==null;)Go(e,t,r),e=e.sibling}var Ae=null,wt=!1;function rs(e,t,r){for(r=r.child;r!==null;)Vm(e,t,r),r=r.sibling}function Vm(e,t,r){if(Rt&&typeof Rt.onCommitFiberUnmount=="function")try{Rt.onCommitFiberUnmount(ei,r)}catch{}switch(r.tag){case 5:Fe||fr(r,t);case 6:var n=Ae,a=wt;Ae=null,rs(e,t,r),Ae=n,wt=a,Ae!==null&&(wt?(e=Ae,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Ae.removeChild(r.stateNode));break;case 18:Ae!==null&&(wt?(e=Ae,r=r.stateNode,e.nodeType===8?zi(e.parentNode,r):e.nodeType===1&&zi(e,r),vn(e)):zi(Ae,r.stateNode));break;case 4:n=Ae,a=wt,Ae=r.stateNode.containerInfo,wt=!0,rs(e,t,r),Ae=n,wt=a;break;case 0:case 11:case 14:case 15:if(!Fe&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&qo(r,t,o),a=a.next}while(a!==n)}rs(e,t,r);break;case 1:if(!Fe&&(fr(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){be(r,t,l)}rs(e,t,r);break;case 21:rs(e,t,r);break;case 22:r.mode&1?(Fe=(n=Fe)||r.memoizedState!==null,rs(e,t,r),Fe=n):rs(e,t,r);break;default:rs(e,t,r)}}function hd(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new G0),t.forEach(function(n){var a=rf.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function bt(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:Ae=l.stateNode,wt=!1;break e;case 3:Ae=l.stateNode.containerInfo,wt=!0;break e;case 4:Ae=l.stateNode.containerInfo,wt=!0;break e}l=l.return}if(Ae===null)throw Error(B(160));Vm(i,o,a),Ae=null,wt=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(d){be(a,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Um(t,e),t=t.sibling}function Um(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(bt(t,e),Pt(e),n&4){try{an(3,e,e.return),li(3,e)}catch(y){be(e,e.return,y)}try{an(5,e,e.return)}catch(y){be(e,e.return,y)}}break;case 1:bt(t,e),Pt(e),n&512&&r!==null&&fr(r,r.return);break;case 5:if(bt(t,e),Pt(e),n&512&&r!==null&&fr(r,r.return),e.flags&32){var a=e.stateNode;try{fn(a,"")}catch(y){be(e,e.return,y)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,o=r!==null?r.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&du(a,i),po(l,o);var d=po(l,i);for(o=0;o<c.length;o+=2){var u=c[o],m=c[o+1];u==="style"?fu(a,m):u==="dangerouslySetInnerHTML"?hu(a,m):u==="children"?fn(a,m):pl(a,u,m,d)}switch(l){case"input":mo(a,i);break;case"textarea":uu(a,i);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var g=i.value;g!=null?pr(a,!!i.multiple,g,!1):h!==!!i.multiple&&(i.defaultValue!=null?pr(a,!!i.multiple,i.defaultValue,!0):pr(a,!!i.multiple,i.multiple?[]:"",!1))}a[_n]=i}catch(y){be(e,e.return,y)}}break;case 6:if(bt(t,e),Pt(e),n&4){if(e.stateNode===null)throw Error(B(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(y){be(e,e.return,y)}}break;case 3:if(bt(t,e),Pt(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{vn(t.containerInfo)}catch(y){be(e,e.return,y)}break;case 4:bt(t,e),Pt(e);break;case 13:bt(t,e),Pt(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(Kl=Ne())),n&4&&hd(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(Fe=(d=Fe)||u,bt(t,e),Fe=d):bt(t,e),Pt(e),n&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!u&&e.mode&1)for(H=e,u=e.child;u!==null;){for(m=H=u;H!==null;){switch(h=H,g=h.child,h.tag){case 0:case 11:case 14:case 15:an(4,h,h.return);break;case 1:fr(h,h.return);var b=h.stateNode;if(typeof b.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,b.props=t.memoizedProps,b.state=t.memoizedState,b.componentWillUnmount()}catch(y){be(n,r,y)}}break;case 5:fr(h,h.return);break;case 22:if(h.memoizedState!==null){fd(m);continue}}g!==null?(g.return=h,H=g):fd(m)}u=u.sibling}e:for(u=null,m=e;;){if(m.tag===5){if(u===null){u=m;try{a=m.stateNode,d?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=m.stateNode,c=m.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=xu("display",o))}catch(y){be(e,e.return,y)}}}else if(m.tag===6){if(u===null)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(y){be(e,e.return,y)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===e)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;m.sibling===null;){if(m.return===null||m.return===e)break e;u===m&&(u=null),m=m.return}u===m&&(u=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:bt(t,e),Pt(e),n&4&&hd(e);break;case 21:break;default:bt(t,e),Pt(e)}}function Pt(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(zm(r)){var n=r;break e}r=r.return}throw Error(B(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(fn(a,""),n.flags&=-33);var i=md(e);Go(e,i,a);break;case 3:case 4:var o=n.stateNode.containerInfo,l=md(e);Ho(e,l,o);break;default:throw Error(B(161))}}catch(c){be(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Q0(e,t,r){H=e,Bm(e)}function Bm(e,t,r){for(var n=(e.mode&1)!==0;H!==null;){var a=H,i=a.child;if(a.tag===22&&n){var o=a.memoizedState!==null||aa;if(!o){var l=a.alternate,c=l!==null&&l.memoizedState!==null||Fe;l=aa;var d=Fe;if(aa=o,(Fe=c)&&!d)for(H=a;H!==null;)o=H,c=o.child,o.tag===22&&o.memoizedState!==null?gd(a):c!==null?(c.return=o,H=c):gd(a);for(;i!==null;)H=i,Bm(i),i=i.sibling;H=a,aa=l,Fe=d}xd(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,H=i):xd(e)}}function xd(e){for(;H!==null;){var t=H;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Fe||li(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Fe)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Nt(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Xc(t,i,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Xc(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var m=u.dehydrated;m!==null&&vn(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(B(163))}Fe||t.flags&512&&Wo(t)}catch(h){be(t,t.return,h)}}if(t===e){H=null;break}if(r=t.sibling,r!==null){r.return=t.return,H=r;break}H=t.return}}function fd(e){for(;H!==null;){var t=H;if(t===e){H=null;break}var r=t.sibling;if(r!==null){r.return=t.return,H=r;break}H=t.return}}function gd(e){for(;H!==null;){var t=H;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{li(4,t)}catch(c){be(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(c){be(t,a,c)}}var i=t.return;try{Wo(t)}catch(c){be(t,i,c)}break;case 5:var o=t.return;try{Wo(t)}catch(c){be(t,o,c)}}}catch(c){be(t,t.return,c)}if(t===e){H=null;break}var l=t.sibling;if(l!==null){l.return=t.return,H=l;break}H=t.return}}var K0=Math.ceil,Ha=es.ReactCurrentDispatcher,Yl=es.ReactCurrentOwner,gt=es.ReactCurrentBatchConfig,oe=0,Te=null,_e=null,Me=0,rt=0,gr=Ss(0),Ce=0,Pn=null,Hs=0,ci=0,Ql=0,on=null,Qe=null,Kl=0,Dr=1/0,zt=null,Ga=!1,Yo=null,vs=null,ia=!1,ms=null,Ya=0,ln=0,Qo=null,wa=-1,_a=0;function We(){return oe&6?Ne():wa!==-1?wa:wa=Ne()}function bs(e){return e.mode&1?oe&2&&Me!==0?Me&-Me:$0.transition!==null?(_a===0&&(_a=Su()),_a):(e=de,e!==0||(e=window.event,e=e===void 0?16:Mu(e.type)),e):1}function St(e,t,r,n){if(50<ln)throw ln=0,Qo=null,Error(B(185));Ln(e,r,n),(!(oe&2)||e!==Te)&&(e===Te&&(!(oe&2)&&(ci|=r),Ce===4&&cs(e,Me)),tt(e,n),r===1&&oe===0&&!(t.mode&1)&&(Dr=Ne()+500,ai&&Es()))}function tt(e,t){var r=e.callbackNode;$x(e,t);var n=Da(e,e===Te?Me:0);if(n===0)r!==null&&kc(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&kc(r),t===1)e.tag===0?A0(pd.bind(null,e)):Zu(pd.bind(null,e)),E0(function(){!(oe&6)&&Es()}),r=null;else{switch(Eu(n)){case 1:r=Nl;break;case 4:r=ku;break;case 16:r=Pa;break;case 536870912:r=Cu;break;default:r=Pa}r=Jm(r,qm.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function qm(e,t){if(wa=-1,_a=0,oe&6)throw Error(B(327));var r=e.callbackNode;if(Nr()&&e.callbackNode!==r)return null;var n=Da(e,e===Te?Me:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Qa(e,n);else{t=n;var a=oe;oe|=2;var i=Hm();(Te!==e||Me!==t)&&(zt=null,Dr=Ne()+500,zs(e,t));do try{Z0();break}catch(l){Wm(e,l)}while(!0);Rl(),Ha.current=i,oe=a,_e!==null?t=0:(Te=null,Me=0,t=Ce)}if(t!==0){if(t===2&&(a=No(e),a!==0&&(n=a,t=Ko(e,a))),t===1)throw r=Pn,zs(e,0),cs(e,n),tt(e,Ne()),r;if(t===6)cs(e,n);else{if(a=e.current.alternate,!(n&30)&&!J0(a)&&(t=Qa(e,n),t===2&&(i=No(e),i!==0&&(n=i,t=Ko(e,i))),t===1))throw r=Pn,zs(e,0),cs(e,n),tt(e,Ne()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(B(345));case 2:$s(e,Qe,zt);break;case 3:if(cs(e,n),(n&130023424)===n&&(t=Kl+500-Ne(),10<t)){if(Da(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){We(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Po($s.bind(null,e,Qe,zt),t);break}$s(e,Qe,zt);break;case 4:if(cs(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var o=31-Ct(n);i=1<<o,o=t[o],o>a&&(a=o),n&=~i}if(n=a,n=Ne()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*K0(n/1960))-n,10<n){e.timeoutHandle=Po($s.bind(null,e,Qe,zt),n);break}$s(e,Qe,zt);break;case 5:$s(e,Qe,zt);break;default:throw Error(B(329))}}}return tt(e,Ne()),e.callbackNode===r?qm.bind(null,e):null}function Ko(e,t){var r=on;return e.current.memoizedState.isDehydrated&&(zs(e,t).flags|=256),e=Qa(e,t),e!==2&&(t=Qe,Qe=r,t!==null&&Jo(t)),e}function Jo(e){Qe===null?Qe=e:Qe.push.apply(Qe,e)}function J0(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!Et(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function cs(e,t){for(t&=~Ql,t&=~ci,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Ct(t),n=1<<r;e[r]=-1,t&=~n}}function pd(e){if(oe&6)throw Error(B(327));Nr();var t=Da(e,0);if(!(t&1))return tt(e,Ne()),null;var r=Qa(e,t);if(e.tag!==0&&r===2){var n=No(e);n!==0&&(t=n,r=Ko(e,n))}if(r===1)throw r=Pn,zs(e,0),cs(e,t),tt(e,Ne()),r;if(r===6)throw Error(B(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,$s(e,Qe,zt),tt(e,Ne()),null}function Jl(e,t){var r=oe;oe|=1;try{return e(t)}finally{oe=r,oe===0&&(Dr=Ne()+500,ai&&Es())}}function Gs(e){ms!==null&&ms.tag===0&&!(oe&6)&&Nr();var t=oe;oe|=1;var r=gt.transition,n=de;try{if(gt.transition=null,de=1,e)return e()}finally{de=n,gt.transition=r,oe=t,!(oe&6)&&Es()}}function Xl(){rt=gr.current,xe(gr)}function zs(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,S0(r)),_e!==null)for(r=_e.return;r!==null;){var n=r;switch(Al(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Oa();break;case 3:Tr(),xe(Ze),xe(Ue),Vl();break;case 5:zl(n);break;case 4:Tr();break;case 13:xe(pe);break;case 19:xe(pe);break;case 10:Ol(n.type._context);break;case 22:case 23:Xl()}r=r.return}if(Te=e,_e=e=js(e.current,null),Me=rt=t,Ce=0,Pn=null,Ql=ci=Hs=0,Qe=on=null,Is!==null){for(t=0;t<Is.length;t++)if(r=Is[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=a,n.next=o}r.pending=n}Is=null}return e}function Wm(e,t){do{var r=_e;try{if(Rl(),ba.current=Wa,qa){for(var n=ye.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}qa=!1}if(Ws=0,Ee=ke=ye=null,nn=!1,Sn=0,Yl.current=null,r===null||r.return===null){Ce=1,Pn=t,_e=null;break}e:{var i=e,o=r.return,l=r,c=t;if(t=Me,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,m=u.tag;if(!(u.mode&1)&&(m===0||m===11||m===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var g=nd(o);if(g!==null){g.flags&=-257,ad(g,o,l,i,t),g.mode&1&&rd(i,d,t),t=g,c=d;var b=t.updateQueue;if(b===null){var y=new Set;y.add(c),t.updateQueue=y}else b.add(c);break e}else{if(!(t&1)){rd(i,d,t),Zl();break e}c=Error(B(426))}}else if(fe&&l.mode&1){var k=nd(o);if(k!==null){!(k.flags&65536)&&(k.flags|=256),ad(k,o,l,i,t),$l(Pr(c,l));break e}}i=c=Pr(c,l),Ce!==4&&(Ce=2),on===null?on=[i]:on.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var x=Em(i,c,t);Jc(i,x);break e;case 1:l=c;var f=i.type,p=i.stateNode;if(!(i.flags&128)&&(typeof f.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(vs===null||!vs.has(p)))){i.flags|=65536,t&=-t,i.lanes|=t;var S=Tm(i,l,t);Jc(i,S);break e}}i=i.return}while(i!==null)}Ym(r)}catch(C){t=C,_e===r&&r!==null&&(_e=r=r.return);continue}break}while(!0)}function Hm(){var e=Ha.current;return Ha.current=Wa,e===null?Wa:e}function Zl(){(Ce===0||Ce===3||Ce===2)&&(Ce=4),Te===null||!(Hs&268435455)&&!(ci&268435455)||cs(Te,Me)}function Qa(e,t){var r=oe;oe|=2;var n=Hm();(Te!==e||Me!==t)&&(zt=null,zs(e,t));do try{X0();break}catch(a){Wm(e,a)}while(!0);if(Rl(),oe=r,Ha.current=n,_e!==null)throw Error(B(261));return Te=null,Me=0,Ce}function X0(){for(;_e!==null;)Gm(_e)}function Z0(){for(;_e!==null&&!_x();)Gm(_e)}function Gm(e){var t=Km(e.alternate,e,rt);e.memoizedProps=e.pendingProps,t===null?Ym(e):_e=t,Yl.current=null}function Ym(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=H0(r,t),r!==null){r.flags&=32767,_e=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ce=6,_e=null;return}}else if(r=W0(r,t,rt),r!==null){_e=r;return}if(t=t.sibling,t!==null){_e=t;return}_e=t=e}while(t!==null);Ce===0&&(Ce=5)}function $s(e,t,r){var n=de,a=gt.transition;try{gt.transition=null,de=1,ef(e,t,r,n)}finally{gt.transition=a,de=n}return null}function ef(e,t,r,n){do Nr();while(ms!==null);if(oe&6)throw Error(B(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(B(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(Mx(e,i),e===Te&&(_e=Te=null,Me=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||ia||(ia=!0,Jm(Pa,function(){return Nr(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=gt.transition,gt.transition=null;var o=de;de=1;var l=oe;oe|=4,Yl.current=null,Y0(e,r),Um(r,e),b0(Eo),Aa=!!So,Eo=So=null,e.current=r,Q0(r),kx(),oe=l,de=o,gt.transition=i}else e.current=r;if(ia&&(ia=!1,ms=e,Ya=a),i=e.pendingLanes,i===0&&(vs=null),Ex(r.stateNode),tt(e,Ne()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Ga)throw Ga=!1,e=Yo,Yo=null,e;return Ya&1&&e.tag!==0&&Nr(),i=e.pendingLanes,i&1?e===Qo?ln++:(ln=0,Qo=e):ln=0,Es(),null}function Nr(){if(ms!==null){var e=Eu(Ya),t=gt.transition,r=de;try{if(gt.transition=null,de=16>e?16:e,ms===null)var n=!1;else{if(e=ms,ms=null,Ya=0,oe&6)throw Error(B(331));var a=oe;for(oe|=4,H=e.current;H!==null;){var i=H,o=i.child;if(H.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(H=d;H!==null;){var u=H;switch(u.tag){case 0:case 11:case 15:an(8,u,i)}var m=u.child;if(m!==null)m.return=u,H=m;else for(;H!==null;){u=H;var h=u.sibling,g=u.return;if(Fm(u),u===d){H=null;break}if(h!==null){h.return=g,H=h;break}H=g}}}var b=i.alternate;if(b!==null){var y=b.child;if(y!==null){b.child=null;do{var k=y.sibling;y.sibling=null,y=k}while(y!==null)}}H=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,H=o;else e:for(;H!==null;){if(i=H,i.flags&2048)switch(i.tag){case 0:case 11:case 15:an(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,H=x;break e}H=i.return}}var f=e.current;for(H=f;H!==null;){o=H;var p=o.child;if(o.subtreeFlags&2064&&p!==null)p.return=o,H=p;else e:for(o=f;H!==null;){if(l=H,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:li(9,l)}}catch(C){be(l,l.return,C)}if(l===o){H=null;break e}var S=l.sibling;if(S!==null){S.return=l.return,H=S;break e}H=l.return}}if(oe=a,Es(),Rt&&typeof Rt.onPostCommitFiberRoot=="function")try{Rt.onPostCommitFiberRoot(ei,e)}catch{}n=!0}return n}finally{de=r,gt.transition=t}}return!1}function yd(e,t,r){t=Pr(r,t),t=Em(e,t,1),e=ys(e,t,1),t=We(),e!==null&&(Ln(e,1,t),tt(e,t))}function be(e,t,r){if(e.tag===3)yd(e,e,r);else for(;t!==null;){if(t.tag===3){yd(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(vs===null||!vs.has(n))){e=Pr(r,e),e=Tm(t,e,1),t=ys(t,e,1),e=We(),t!==null&&(Ln(t,1,e),tt(t,e));break}}t=t.return}}function tf(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=We(),e.pingedLanes|=e.suspendedLanes&r,Te===e&&(Me&r)===r&&(Ce===4||Ce===3&&(Me&130023424)===Me&&500>Ne()-Kl?zs(e,0):Ql|=r),tt(e,t)}function Qm(e,t){t===0&&(e.mode&1?(t=Kn,Kn<<=1,!(Kn&130023424)&&(Kn=4194304)):t=1);var r=We();e=Jt(e,t),e!==null&&(Ln(e,t,r),tt(e,r))}function sf(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Qm(e,r)}function rf(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(B(314))}n!==null&&n.delete(t),Qm(e,r)}var Km;Km=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ze.current)Je=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Je=!1,q0(e,t,r);Je=!!(e.flags&131072)}else Je=!1,fe&&t.flags&1048576&&em(t,Fa,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Na(e,t),e=t.pendingProps;var a=Cr(t,Ue.current);jr(t,r),a=Bl(null,t,n,e,a,r);var i=ql();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,et(n)?(i=!0,Ia(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Ll(t),a.updater=oi,t.stateNode=a,a._reactInternals=t,Io(t,n,e,r),t=zo(null,t,n,!0,i,r)):(t.tag=0,fe&&i&&Dl(t),qe(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Na(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=af(n),e=Nt(n,e),a){case 0:t=Fo(null,t,n,e,r);break e;case 1:t=ld(null,t,n,e,r);break e;case 11:t=id(null,t,n,e,r);break e;case 14:t=od(null,t,n,Nt(n.type,e),r);break e}throw Error(B(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Nt(n,a),Fo(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Nt(n,a),ld(e,t,n,a,r);case 3:e:{if($m(t),e===null)throw Error(B(387));n=t.pendingProps,i=t.memoizedState,a=i.element,im(e,t),Ua(t,n,null,r);var o=t.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=Pr(Error(B(423)),t),t=cd(e,t,n,r,a);break e}else if(n!==a){a=Pr(Error(B(424)),t),t=cd(e,t,n,r,a);break e}else for(nt=ps(t.stateNode.containerInfo.firstChild),at=t,fe=!0,kt=null,r=nm(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Sr(),n===a){t=Xt(e,t,r);break e}qe(e,t,n,r)}t=t.child}return t;case 5:return om(t),e===null&&Mo(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,o=a.children,To(n,a)?o=null:i!==null&&To(n,i)&&(t.flags|=32),Am(e,t),qe(e,t,o,r),t.child;case 6:return e===null&&Mo(t),null;case 13:return Mm(e,t,r);case 4:return Fl(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Er(t,null,n,r):qe(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Nt(n,a),id(e,t,n,a,r);case 7:return qe(e,t,t.pendingProps,r),t.child;case 8:return qe(e,t,t.pendingProps.children,r),t.child;case 12:return qe(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,o=a.value,me(za,n._currentValue),n._currentValue=o,i!==null)if(Et(i.value,o)){if(i.children===a.children&&!Ze.current){t=Xt(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=Gt(-1,r&-r),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),Ro(i.return,r,t),l.lanes|=r;break}c=c.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(B(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),Ro(o,r,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}qe(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,jr(t,r),a=yt(a),n=n(a),t.flags|=1,qe(e,t,n,r),t.child;case 14:return n=t.type,a=Nt(n,t.pendingProps),a=Nt(n.type,a),od(e,t,n,a,r);case 15:return Pm(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Nt(n,a),Na(e,t),t.tag=1,et(n)?(e=!0,Ia(t)):e=!1,jr(t,r),Sm(t,n,a),Io(t,n,a,r),zo(null,t,n,!0,e,r);case 19:return Rm(e,t,r);case 22:return Dm(e,t,r)}throw Error(B(156,t.tag))};function Jm(e,t){return _u(e,t)}function nf(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xt(e,t,r,n){return new nf(e,t,r,n)}function ec(e){return e=e.prototype,!(!e||!e.isReactComponent)}function af(e){if(typeof e=="function")return ec(e)?1:0;if(e!=null){if(e=e.$$typeof,e===vl)return 11;if(e===bl)return 14}return 2}function js(e,t){var r=e.alternate;return r===null?(r=xt(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function ka(e,t,r,n,a,i){var o=2;if(n=e,typeof e=="function")ec(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case ir:return Vs(r.children,a,i,t);case yl:o=8,a|=8;break;case io:return e=xt(12,r,t,a|2),e.elementType=io,e.lanes=i,e;case oo:return e=xt(13,r,t,a),e.elementType=oo,e.lanes=i,e;case lo:return e=xt(19,r,t,a),e.elementType=lo,e.lanes=i,e;case ou:return di(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case au:o=10;break e;case iu:o=9;break e;case vl:o=11;break e;case bl:o=14;break e;case as:o=16,n=null;break e}throw Error(B(130,e==null?e:typeof e,""))}return t=xt(o,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function Vs(e,t,r,n){return e=xt(7,e,n,t),e.lanes=r,e}function di(e,t,r,n){return e=xt(22,e,n,t),e.elementType=ou,e.lanes=r,e.stateNode={isHidden:!1},e}function Yi(e,t,r){return e=xt(6,e,null,t),e.lanes=r,e}function Qi(e,t,r){return t=xt(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function of(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ti(0),this.expirationTimes=Ti(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ti(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function tc(e,t,r,n,a,i,o,l,c){return e=new of(e,t,r,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=xt(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ll(i),e}function lf(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ar,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Xm(e){if(!e)return ks;e=e._reactInternals;e:{if(Qs(e)!==e||e.tag!==1)throw Error(B(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(et(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(B(171))}if(e.tag===1){var r=e.type;if(et(r))return Xu(e,r,t)}return t}function Zm(e,t,r,n,a,i,o,l,c){return e=tc(r,n,!0,e,a,i,o,l,c),e.context=Xm(null),r=e.current,n=We(),a=bs(r),i=Gt(n,a),i.callback=t??null,ys(r,i,a),e.current.lanes=a,Ln(e,a,n),tt(e,n),e}function ui(e,t,r,n){var a=t.current,i=We(),o=bs(a);return r=Xm(r),t.context===null?t.context=r:t.pendingContext=r,t=Gt(i,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=ys(a,t,o),e!==null&&(St(e,a,o,i),va(e,a,o)),o}function Ka(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function vd(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function sc(e,t){vd(e,t),(e=e.alternate)&&vd(e,t)}function cf(){return null}var eh=typeof reportError=="function"?reportError:function(e){console.error(e)};function rc(e){this._internalRoot=e}mi.prototype.render=rc.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(B(409));ui(e,t,null,null)};mi.prototype.unmount=rc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Gs(function(){ui(null,e,null,null)}),t[Kt]=null}};function mi(e){this._internalRoot=e}mi.prototype.unstable_scheduleHydration=function(e){if(e){var t=Du();e={blockedOn:null,target:e,priority:t};for(var r=0;r<ls.length&&t!==0&&t<ls[r].priority;r++);ls.splice(r,0,e),r===0&&$u(e)}};function nc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function hi(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function bd(){}function df(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var d=Ka(o);i.call(d)}}var o=Zm(t,n,e,0,null,!1,!1,"",bd);return e._reactRootContainer=o,e[Kt]=o.current,Nn(e.nodeType===8?e.parentNode:e),Gs(),o}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var l=n;n=function(){var d=Ka(c);l.call(d)}}var c=tc(e,0,!1,null,null,!1,!1,"",bd);return e._reactRootContainer=c,e[Kt]=c.current,Nn(e.nodeType===8?e.parentNode:e),Gs(function(){ui(t,c,r,n)}),c}function xi(e,t,r,n,a){var i=r._reactRootContainer;if(i){var o=i;if(typeof a=="function"){var l=a;a=function(){var c=Ka(o);l.call(c)}}ui(t,o,e,a)}else o=df(r,t,e,a,n);return Ka(o)}Tu=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Kr(t.pendingLanes);r!==0&&(wl(t,r|1),tt(t,Ne()),!(oe&6)&&(Dr=Ne()+500,Es()))}break;case 13:Gs(function(){var n=Jt(e,1);if(n!==null){var a=We();St(n,e,1,a)}}),sc(e,1)}};_l=function(e){if(e.tag===13){var t=Jt(e,134217728);if(t!==null){var r=We();St(t,e,134217728,r)}sc(e,134217728)}};Pu=function(e){if(e.tag===13){var t=bs(e),r=Jt(e,t);if(r!==null){var n=We();St(r,e,t,n)}sc(e,t)}};Du=function(){return de};Au=function(e,t){var r=de;try{return de=e,t()}finally{de=r}};vo=function(e,t,r){switch(t){case"input":if(mo(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=ni(n);if(!a)throw Error(B(90));cu(n),mo(n,a)}}}break;case"textarea":uu(e,r);break;case"select":t=r.value,t!=null&&pr(e,!!r.multiple,t,!1)}};yu=Jl;vu=Gs;var uf={usingClientEntryPoint:!1,Events:[zn,dr,ni,gu,pu,Jl]},Wr={findFiberByHostInstance:Os,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},mf={bundleType:Wr.bundleType,version:Wr.version,rendererPackageName:Wr.rendererPackageName,rendererConfig:Wr.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:es.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Nu(e),e===null?null:e.stateNode},findFiberByHostInstance:Wr.findFiberByHostInstance||cf,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var oa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!oa.isDisabled&&oa.supportsFiber)try{ei=oa.inject(mf),Rt=oa}catch{}}lt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=uf;lt.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nc(t))throw Error(B(200));return lf(e,t,null,r)};lt.createRoot=function(e,t){if(!nc(e))throw Error(B(299));var r=!1,n="",a=eh;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=tc(e,1,!1,null,null,r,!1,n,a),e[Kt]=t.current,Nn(e.nodeType===8?e.parentNode:e),new rc(t)};lt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(B(188)):(e=Object.keys(e).join(","),Error(B(268,e)));return e=Nu(t),e=e===null?null:e.stateNode,e};lt.flushSync=function(e){return Gs(e)};lt.hydrate=function(e,t,r){if(!hi(t))throw Error(B(200));return xi(null,e,t,!0,r)};lt.hydrateRoot=function(e,t,r){if(!nc(e))throw Error(B(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",o=eh;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=Zm(t,null,e,1,r??null,a,!1,i,o),e[Kt]=t.current,Nn(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new mi(t)};lt.render=function(e,t,r){if(!hi(t))throw Error(B(200));return xi(null,e,t,!1,r)};lt.unmountComponentAtNode=function(e){if(!hi(e))throw Error(B(40));return e._reactRootContainer?(Gs(function(){xi(null,null,e,!1,function(){e._reactRootContainer=null,e[Kt]=null})}),!0):!1};lt.unstable_batchedUpdates=Jl;lt.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!hi(r))throw Error(B(200));if(e==null||e._reactInternals===void 0)throw Error(B(38));return xi(e,t,r,!1,n)};lt.version="18.3.1-next-f1338f8080-20240426";function th(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(th)}catch(e){console.error(e)}}th(),tu.exports=lt;var hf=tu.exports,sh,jd=hf;sh=jd.createRoot,jd.hydrateRoot;/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var xf={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ff=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),K=(e,t)=>{const r=M.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:l="",children:c,...d},u)=>M.createElement("svg",{ref:u,...xf,width:a,height:a,stroke:n,strokeWidth:o?Number(i)*24/Number(a):i,className:["lucide",`lucide-${ff(e)}`,l].join(" "),...d},[...t.map(([m,h])=>M.createElement(m,h)),...Array.isArray(c)?c:[c]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dn=K("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gf=K("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pf=K("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=K("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rh=K("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nh=K("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yf=K("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vf=K("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=K("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=K("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nd=K("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ac=K("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xo=K("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wd=K("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=K("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=K("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bf=K("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jf=K("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=K("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nf=K("Expand",[["path",{d:"m21 21-6-6m6 6v-4.8m0 4.8h-4.8",key:"1c15vz"}],["path",{d:"M3 16.2V21m0 0h4.8M3 21l6-6",key:"1fsnz2"}],["path",{d:"M21 7.8V3m0 0h-4.8M21 3l-6 6",key:"hawz9i"}],["path",{d:"M3 7.8V3m0 0h4.8M3 3l6 6",key:"u9ee12"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wf=K("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _f=K("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const An=K("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ah=K("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kf=K("Fuel",[["line",{x1:"3",x2:"15",y1:"22",y2:"22",key:"xegly4"}],["line",{x1:"4",x2:"14",y1:"9",y2:"9",key:"xcnuvu"}],["path",{d:"M14 22V4a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v18",key:"16j0yd"}],["path",{d:"M14 13h2a2 2 0 0 1 2 2v2a2 2 0 0 0 2 2h0a2 2 0 0 0 2-2V9.83a2 2 0 0 0-.59-1.42L18 5",key:"8ur5zv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cf=K("Handshake",[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zo=K("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sf=K("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=K("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ef=K("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tf=K("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pf=K("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const el=K("PiggyBank",[["path",{d:"M19 5c-1.5 0-2.8 1.4-3 2-3.5-1.5-11-.3-11 5 0 1.8 0 3 2 4.5V20h4v-2h3v2h4v-4c1-.5 1.7-1 2-2h2v-4h-2c0-1-.5-1.5-1-2h0V5z",key:"uf6l00"}],["path",{d:"M2 9v1c0 1.1.9 2 2 2h1",key:"nm575m"}],["path",{d:"M16 11h0",key:"k2aug8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=K("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Df=K("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=K("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _d=K("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ih=K("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tl=K("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=K("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=K("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=K("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=K("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Af=K("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=K("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=K("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $f=K("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=K("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=K("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=K("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),oh=M.createContext(void 0),Mf=({children:e})=>{const[t,r]=M.useState("commercial"),n=t==="administrative",a=t==="commercial",i=l=>n?!0:a?l==="proposals"||l==="budgets":!1,o=l=>!0;return s.jsx(oh.Provider,{value:{version:t,setVersion:r,isAdministrative:n,isCommercial:a,canEdit:i,canView:o},children:e})},Js=()=>{const e=M.useContext(oh);if(e===void 0)throw new Error("useSystemVersion must be used within a SystemVersionProvider");return e},Rf=()=>{const{version:e,setVersion:t}=Js(),[r,n]=M.useState(!1),[a,i]=M.useState(""),[o,l]=M.useState(!1),[c,d]=M.useState(""),u="22595084",m=y=>{y==="administrative"?n(!0):t(y)},h=y=>{y.preventDefault(),a===u?(t("administrative"),n(!1),i(""),d(""),alert("✅ Acesso administrativo concedido!")):(d("Senha incorreta. Tente novamente."),i(""))},g=()=>{n(!1),i(""),d("")},b=y=>{switch(y){case"commercial":return{icon:Ks,title:"Comercial",description:"Acesso livre • Edição apenas em Propostas",color:"text-blue-600",bgColor:"bg-blue-50",borderColor:"border-blue-200"};case"administrative":return{icon:tl,title:"Administrativa",description:"Requer senha • Edição completa do sistema",color:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200"}}};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"p-4 border-t border-gray-200",children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"Versão do Sistema"}),s.jsx("div",{className:"space-y-2",children:["commercial","administrative"].map(y=>{const k=b(y),x=k.icon,f=e===y;return s.jsx("button",{onClick:()=>m(y),className:`w-full text-left p-3 rounded-lg border transition-all ${f?`${k.bgColor} ${k.borderColor} border-2`:"bg-white border-gray-200 hover:bg-gray-50"}`,children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(x,{className:`w-4 h-4 ${f?k.color:"text-gray-500"}`}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:`text-sm font-medium ${f?k.color:"text-gray-900"}`,children:[k.title,f&&s.jsx("span",{className:"ml-2 text-xs",children:"(Ativa)"})]}),s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:k.description})]})]})},y)})})]}),s.jsx("div",{className:`mt-3 p-2 rounded-lg text-center text-xs font-medium ${e==="administrative"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:e==="administrative"?"🔒 Modo Administrativo":"👤 Modo Comercial"})]}),r&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:s.jsx(Ef,{className:"w-5 h-5 text-red-600"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Acesso Administrativo"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Digite a senha para continuar"})]})]}),s.jsx("button",{onClick:g,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(ne,{className:"w-5 h-5 text-gray-500"})})]}),s.jsxs("form",{onSubmit:h,className:"p-6",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Senha Administrativa"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:o?"text":"password",value:a,onChange:y=>{i(y.target.value),d("")},className:`w-full px-3 py-2 pr-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 ${c?"border-red-300":"border-gray-300"}`,placeholder:"Digite a senha...",autoFocus:!0,required:!0}),s.jsx("button",{type:"button",onClick:()=>l(!o),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:o?s.jsx(wf,{className:"w-4 h-4"}):s.jsx(_f,{className:"w-4 h-4"})})]}),c&&s.jsx("p",{className:"text-red-600 text-sm mt-1",children:c})]}),s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:s.jsxs("div",{className:"flex items-start space-x-2",children:[s.jsx(tl,{className:"w-4 h-4 text-yellow-600 mt-0.5"}),s.jsxs("div",{className:"text-sm text-yellow-800",children:[s.jsx("p",{className:"font-medium",children:"Modo Administrativo permite:"}),s.jsxs("ul",{className:"mt-1 space-y-1 text-xs",children:[s.jsx("li",{children:"• Editar todas as configurações do sistema"}),s.jsx("li",{children:"• Gerenciar funcionários e usuários"}),s.jsx("li",{children:"• Modificar metas e comissões"}),s.jsx("li",{children:"• Acesso completo a todas as funcionalidades"})]})]})]})}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{type:"submit",className:"flex-1 bg-red-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-red-700 transition-colors",children:"Acessar"}),s.jsx("button",{type:"button",onClick:g,className:"flex-1 border border-gray-300 text-gray-700 py-2 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Cancelar"})]})]})]})})]})},lh=M.createContext(void 0),Of=({children:e})=>{const t=new Date().getFullYear(),[r,n]=M.useState(t),a=Array.from({length:7},(i,o)=>t-3+o);return s.jsx(lh.Provider,{value:{selectedYear:r,setSelectedYear:n,availableYears:a},children:e})},Tt=()=>{const e=M.useContext(lh);if(e===void 0)throw new Error("useYear must be used within a YearProvider");return e},If=[{id:"dashboard",label:"Dashboard",icon:Sf},{id:"proposals",label:"Propostas",icon:An},{id:"commissions",label:"Comissões",icon:De},{id:"challenges",label:"Desafios e Prêmios",icon:ft},{id:"weekly-performance",label:"Performance Semanal",icon:ot},{id:"bonus-fund",label:"Fundo de Bonificação",icon:el},{id:"employee-of-month",label:"Destaque do Mês",icon:At},{id:"budgets",label:"Orçamentos",icon:Us},{id:"settings",label:"Configurações",icon:ih}],Lf=({activeTab:e,setActiveTab:t})=>{const{selectedYear:r,setSelectedYear:n,availableYears:a}=Tt(),[i,o]=je.useState(!1);return je.useEffect(()=>{const l=()=>{const d=localStorage.getItem("newChallengeCreatedAt");if(!d){o(!1);return}const u=new Date(d);(new Date().getTime()-u.getTime())/(1e3*60*60)>=24?(localStorage.removeItem("newChallengeCreatedAt"),o(!1)):o(!0)};l();const c=setInterval(l,6e4);return()=>clearInterval(c)},[]),s.jsxs("div",{className:"w-full h-full bg-white border-r border-gray-200 min-h-screen flex flex-col shadow-lg md:shadow-none",children:[s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-green-500 to-blue-600 rounded-lg flex items-center justify-center",children:s.jsx(De,{className:"w-5 h-5 text-white"})}),s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Grupo WWS"})]}),s.jsxs("div",{className:"mt-4",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsx(vf,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Ano:"})]}),s.jsx("select",{value:r,onChange:l=>n(Number(l.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:a.map(l=>s.jsx("option",{value:l,children:l},l))}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ano fiscal para metas e relatórios"})]})]}),s.jsx("nav",{className:"flex-1 px-4",children:s.jsx("ul",{className:"space-y-2",children:If.map(l=>{const c=l.icon,d=l.id==="challenges"&&i;return s.jsx("li",{children:s.jsxs("button",{onClick:()=>t(l.id),className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg text-left transition-colors ${e===l.id?"bg-blue-50 text-blue-600 border-r-2 border-blue-600":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,children:[s.jsx(c,{className:"w-5 h-5"}),s.jsxs("div",{className:"flex items-center space-x-2 flex-1",children:[s.jsx("span",{className:"font-medium",children:l.label}),d&&s.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-bold text-white bg-gradient-to-r from-red-500 to-pink-500 animate-pulse",children:"NOVO!"})]})]})},l.id)})})}),s.jsx(Rf,{})]})},Ff="modulepreload",zf=function(e){return"/"+e},kd={},Un=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(r.map(c=>{if(c=zf(c),c in kd)return;kd[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":Ff,d||(m.as="script"),m.crossOrigin="",m.href=c,l&&m.setAttribute("nonce",l),document.head.appendChild(m),d)return new Promise((h,g)=>{m.addEventListener("load",h),m.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})},Vf=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Un(async()=>{const{default:n}=await Promise.resolve().then(()=>Or);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class ic extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class Uf extends ic{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Cd extends ic{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Sd extends ic{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var sl;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(sl||(sl={}));var Bf=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(n.next(u))}catch(m){o(m)}}function c(u){try{d(n.throw(u))}catch(m){o(m)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class qf{constructor(t,{headers:r={},customFetch:n,region:a=sl.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=Vf(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return Bf(this,void 0,void 0,function*(){try{const{headers:a,method:i,body:o}=r;let l={},{region:c}=r;c||(c=this.region);const d=new URL(`${this.url}/${t}`);c&&c!=="any"&&(l["x-region"]=c,d.searchParams.set("forceFunctionRegion",c));let u;o&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(l["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(l["Content-Type"]="application/json",u=JSON.stringify(o)));const m=yield this.fetch(d.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),a),body:u}).catch(y=>{throw new Uf(y)}),h=m.headers.get("x-relay-error");if(h&&h==="true")throw new Cd(m);if(!m.ok)throw new Sd(m);let g=((n=m.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),b;return g==="application/json"?b=yield m.json():g==="application/octet-stream"?b=yield m.blob():g==="text/event-stream"?b=m:g==="multipart/form-data"?b=yield m.formData():b=yield m.text(),{data:b,error:null,response:m}}catch(a){return{data:null,error:a,response:a instanceof Sd||a instanceof Cd?a.context:void 0}}})}}var Ke={},oc={},fi={},Bn={},gi={},pi={},Wf=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Ar=Wf();const Hf=Ar.fetch,ch=Ar.fetch.bind(Ar),dh=Ar.Headers,Gf=Ar.Request,Yf=Ar.Response,Or=Object.freeze(Object.defineProperty({__proto__:null,Headers:dh,Request:Gf,Response:Yf,default:ch,fetch:Hf},Symbol.toStringTag,{value:"Module"})),Qf=zh(Or);var yi={};Object.defineProperty(yi,"__esModule",{value:!0});let Kf=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};yi.default=Kf;var uh=pt&&pt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(pi,"__esModule",{value:!0});const Jf=uh(Qf),Xf=uh(yi);let Zf=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=Jf.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,l,c;let d=null,u=null,m=null,h=i.status,g=i.statusText;if(i.ok){if(this.method!=="HEAD"){const x=await i.text();x===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=x:u=JSON.parse(x))}const y=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),k=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");y&&k&&k.length>1&&(m=parseInt(k[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(d={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,m=null,h=406,g="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const y=await i.text();try{d=JSON.parse(y),Array.isArray(d)&&i.status===404&&(u=[],d=null,h=200,g="OK")}catch{i.status===404&&y===""?(h=204,g="No Content"):d={message:y}}if(d&&this.isMaybeSingle&&(!((c=d==null?void 0:d.details)===null||c===void 0)&&c.includes("0 rows"))&&(d=null,h=200,g="OK"),d&&this.shouldThrowOnError)throw new Xf.default(d)}return{error:d,data:u,count:m,status:h,statusText:g}});return this.shouldThrowOnError||(a=a.catch(i=>{var o,l,c;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}};pi.default=Zf;var eg=pt&&pt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(gi,"__esModule",{value:!0});const tg=eg(pi);let sg=class extends tg.default{select(t){let r=!1;const n=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:a,referencedTable:i=a}={}){const o=i?`${i}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:a=n}={}){const i=typeof a>"u"?"offset":`${a}.offset`,o=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(o,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:a=!1,wal:i=!1,format:o="text"}={}){var l;const c=[t?"analyze":null,r?"verbose":null,n?"settings":null,a?"buffers":null,i?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${d}"; options=${c};`,o==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};gi.default=sg;var rg=pt&&pt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Bn,"__esModule",{value:!0});const ng=rg(gi);let ag=class extends ng.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:a}={}){let i="";a==="plain"?i="pl":a==="phrase"?i="ph":a==="websearch"&&(i="w");const o=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${i}fts${o}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const a=n?`${n}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};Bn.default=ag;var ig=pt&&pt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(fi,"__esModule",{value:!0});const Hr=ig(Bn);let og=class{constructor(t,{headers:r={},schema:n,fetch:a}){this.url=t,this.headers=r,this.schema=n,this.fetch=a}select(t,{head:r=!1,count:n}={}){const a=r?"HEAD":"GET";let i=!1;const o=(t??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),n&&(this.headers.Prefer=`count=${n}`),new Hr.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const a="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),n||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(t)){const o=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new Hr.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:a,defaultToNull:i=!0}={}){const o="POST",l=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&l.push(this.headers.Prefer),a&&l.push(`count=${a}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(t)){const c=t.reduce((d,u)=>d.concat(Object.keys(u)),[]);if(c.length>0){const d=[...new Set(c)].map(u=>`"${u}"`);this.url.searchParams.set("columns",d.join(","))}}return new Hr.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),r&&a.push(`count=${r}`),this.headers.Prefer=a.join(","),new Hr.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new Hr.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};fi.default=og;var vi={},bi={};Object.defineProperty(bi,"__esModule",{value:!0});bi.version=void 0;bi.version="0.0.0-automated";Object.defineProperty(vi,"__esModule",{value:!0});vi.DEFAULT_HEADERS=void 0;const lg=bi;vi.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${lg.version}`};var mh=pt&&pt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(oc,"__esModule",{value:!0});const cg=mh(fi),dg=mh(Bn),ug=vi;let mg=class hh{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=Object.assign(Object.assign({},ug.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=a}from(t){const r=new URL(`${this.url}/${t}`);return new cg.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new hh(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:i}={}){let o;const l=new URL(`${this.url}/rpc/${t}`);let c;n||a?(o=n?"HEAD":"GET",Object.entries(r).filter(([u,m])=>m!==void 0).map(([u,m])=>[u,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([u,m])=>{l.searchParams.append(u,m)})):(o="POST",c=r);const d=Object.assign({},this.headers);return i&&(d.Prefer=`count=${i}`),new dg.default({method:o,url:l,headers:d,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};oc.default=mg;var Ir=pt&&pt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ke,"__esModule",{value:!0});Ke.PostgrestError=Ke.PostgrestBuilder=Ke.PostgrestTransformBuilder=Ke.PostgrestFilterBuilder=Ke.PostgrestQueryBuilder=Ke.PostgrestClient=void 0;const xh=Ir(oc);Ke.PostgrestClient=xh.default;const fh=Ir(fi);Ke.PostgrestQueryBuilder=fh.default;const gh=Ir(Bn);Ke.PostgrestFilterBuilder=gh.default;const ph=Ir(gi);Ke.PostgrestTransformBuilder=ph.default;const yh=Ir(pi);Ke.PostgrestBuilder=yh.default;const vh=Ir(yi);Ke.PostgrestError=vh.default;var hg=Ke.default={PostgrestClient:xh.default,PostgrestQueryBuilder:fh.default,PostgrestFilterBuilder:gh.default,PostgrestTransformBuilder:ph.default,PostgrestBuilder:yh.default,PostgrestError:vh.default};const{PostgrestClient:xg,PostgrestQueryBuilder:Zy,PostgrestFilterBuilder:ev,PostgrestTransformBuilder:tv,PostgrestBuilder:sv,PostgrestError:rv}=hg;function fg(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const gg=fg(),pg="2.11.15",yg=`realtime-js/${pg}`,vg="1.0.0",bh=1e4,bg=1e3;var cn;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(cn||(cn={}));var Le;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Le||(Le={}));var _t;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(_t||(_t={}));var rl;(function(e){e.websocket="websocket"})(rl||(rl={}));var Rs;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Rs||(Rs={}));class jg{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),i=r.getUint8(2);let o=this.HEADER_LENGTH+2;const l=n.decode(t.slice(o,o+a));o=o+a;const c=n.decode(t.slice(o,o+i));o=o+i;const d=JSON.parse(n.decode(t.slice(o,t.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class jh{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ue;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(ue||(ue={}));const Ed=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((i,o)=>(i[o]=Ng(o,e,t,a),i),{})},Ng=(e,t,r,n)=>{const a=t.find(l=>l.name===e),i=a==null?void 0:a.type,o=r[e];return i&&!n.includes(i)?Nh(i,o):nl(o)},Nh=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return Cg(t,r)}switch(e){case ue.bool:return wg(t);case ue.float4:case ue.float8:case ue.int2:case ue.int4:case ue.int8:case ue.numeric:case ue.oid:return _g(t);case ue.json:case ue.jsonb:return kg(t);case ue.timestamp:return Sg(t);case ue.abstime:case ue.date:case ue.daterange:case ue.int4range:case ue.int8range:case ue.money:case ue.reltime:case ue.text:case ue.time:case ue.timestamptz:case ue.timetz:case ue.tsrange:case ue.tstzrange:return nl(t);default:return nl(t)}},nl=e=>e,wg=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},_g=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},kg=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Cg=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const o=e.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>Nh(t,l))}return e},Sg=e=>typeof e=="string"?e.replace(" ","T"):e,wh=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class Ki{constructor(t,r,n={},a=bh){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Td;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Td||(Td={}));class dn{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=dn.syncState(this.state,a,i,o),this.pendingDiffs.forEach(c=>{this.state=dn.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=dn.syncDiff(this.state,a,i,o),l())}),this.onJoin((a,i,o)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:o})}),this.onLeave((a,i,o)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const i=this.cloneDeep(t),o=this.transformState(r),l={},c={};return this.map(i,(d,u)=>{o[d]||(c[d]=u)}),this.map(o,(d,u)=>{const m=i[d];if(m){const h=u.map(k=>k.presence_ref),g=m.map(k=>k.presence_ref),b=u.filter(k=>g.indexOf(k.presence_ref)<0),y=m.filter(k=>h.indexOf(k.presence_ref)<0);b.length>0&&(l[d]=b),y.length>0&&(c[d]=y)}else l[d]=u}),this.syncDiff(i,{joins:l,leaves:c},n,a)}static syncDiff(t,r,n,a){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(i,(l,c)=>{var d;const u=(d=t[l])!==null&&d!==void 0?d:[];if(t[l]=this.cloneDeep(c),u.length>0){const m=t[l].map(g=>g.presence_ref),h=u.filter(g=>m.indexOf(g.presence_ref)<0);t[l].unshift(...h)}n(l,u,c)}),this.map(o,(l,c)=>{let d=t[l];if(!d)return;const u=c.map(m=>m.presence_ref);d=d.filter(m=>u.indexOf(m.presence_ref)<0),t[l]=d,a(l,d,c),d.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Pd;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Pd||(Pd={}));var Dd;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Dd||(Dd={}));var Vt;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Vt||(Vt={}));class lc{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Le.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Ki(this,_t.join,this.params,this.timeout),this.rejoinTimer=new jh(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Le.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Le.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Le.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Le.errored,this.rejoinTimer.scheduleTimeout())}),this._on(_t.reply,{},(a,i)=>{this._trigger(this._replyEventName(i),a)}),this.presence=new dn(this),this.broadcastEndpointURL=wh(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Le.closed){const{config:{broadcast:i,presence:o,private:l}}=this.params;this._onError(u=>t==null?void 0:t(Vt.CHANNEL_ERROR,u)),this._onClose(()=>t==null?void 0:t(Vt.CLOSED));const c={},d={broadcast:i,presence:o,postgres_changes:(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(u=>u.filter))!==null&&a!==void 0?a:[],private:l};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:d},c)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:u})=>{var m;if(this.socket.setAuth(),u===void 0){t==null||t(Vt.SUBSCRIBED);return}else{const h=this.bindings.postgres_changes,g=(m=h==null?void 0:h.length)!==null&&m!==void 0?m:0,b=[];for(let y=0;y<g;y++){const k=h[y],{filter:{event:x,schema:f,table:p,filter:S}}=k,C=u&&u[y];if(C&&C.event===x&&C.schema===f&&C.table===p&&C.filter===S)b.push(Object.assign(Object.assign({},k),{id:C.id}));else{this.unsubscribe(),this.state=Le.errored,t==null||t(Vt.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=b,t&&t(Vt.SUBSCRIBED);return}}).receive("error",u=>{this.state=Le.errored,t==null||t(Vt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Vt.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:o}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=d.body)===null||a===void 0?void 0:a.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,c;const d=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),d.receive("ok",()=>i("ok")),d.receive("error",()=>i("error")),d.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Le.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(_t.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new Ki(this,_t.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(t,r,n){const a=new AbortController,i=setTimeout(()=>a.abort(),n),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(i),o}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Ki(this,t,r,n);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,i;const o=t.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=_t;if(n&&[l,c,d,u].indexOf(o)>=0&&n!==this._joinRef())return;let h=this._onMessage(o,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(g=>{var b,y,k;return((b=g.filter)===null||b===void 0?void 0:b.event)==="*"||((k=(y=g.filter)===null||y===void 0?void 0:y.event)===null||k===void 0?void 0:k.toLocaleLowerCase())===o}).map(g=>g.callback(h,n)):(i=this.bindings[o])===null||i===void 0||i.filter(g=>{var b,y,k,x,f,p;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in g){const S=g.id,C=(b=g.filter)===null||b===void 0?void 0:b.event;return S&&((y=r.ids)===null||y===void 0?void 0:y.includes(S))&&(C==="*"||(C==null?void 0:C.toLocaleLowerCase())===((k=r.data)===null||k===void 0?void 0:k.type.toLocaleLowerCase()))}else{const S=(f=(x=g==null?void 0:g.filter)===null||x===void 0?void 0:x.event)===null||f===void 0?void 0:f.toLocaleLowerCase();return S==="*"||S===((p=r==null?void 0:r.event)===null||p===void 0?void 0:p.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===o}).map(g=>{if(typeof h=="object"&&"ids"in h){const b=h.data,{schema:y,table:k,commit_timestamp:x,type:f,errors:p}=b;h=Object.assign(Object.assign({},{schema:y,table:k,commit_timestamp:x,eventType:f,new:{},old:{},errors:p}),this._getPayloadRecords(b))}g.callback(h,n)})}_isClosed(){return this.state===Le.closed}_isJoined(){return this.state===Le.joined}_isJoining(){return this.state===Le.joining}_isLeaving(){return this.state===Le.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),i={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&lc.isEqual(a.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(_t.close,{},t)}_onError(t){this._on(_t.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Le.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Ed(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Ed(t.columns,t.old_record)),r}}const Ad=()=>{},Eg=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Tg{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=bh,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ad,this.ref=0,this.logger=Ad,this.conn=null,this.sendBuffer=[],this.serializer=new jg,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...l)=>Un(async()=>{const{default:c}=await Promise.resolve().then(()=>Or);return{default:c}},void 0).then(({default:c})=>c(...l)):o=fetch,(...l)=>o(...l)},this.endPoint=`${t}/${rl.websocket}`,this.httpEndpoint=wh(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),(r!=null&&r.logLevel||r!=null&&r.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const a=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(i,o)=>o(JSON.stringify(i)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new jh(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=gg),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:vg}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case cn.connecting:return Rs.Connecting;case cn.open:return Rs.Open;case cn.closing:return Rs.Closing;default:return Rs.Closed}}isConnected(){return this.connectionState()===Rs.Open}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(i=>i.topic===n);if(a)return a;{const i=new lc(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:n,payload:a,ref:i}=t,o=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${i})`,a),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:yg};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(_t.access_token,{access_token:r})}))}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(t=this.conn)===null||t===void 0||t.close(bg,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:a,payload:i,ref:o}=r;n==="phoenix"&&a==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${n} ${a} ${o&&"("+o+")"||""}`,i),Array.from(this.channels).filter(l=>l._isMember(n)).forEach(l=>l._trigger(a,i,o)),this.stateChangeCallbacks.message.forEach(l=>l(r))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(t=>t())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",`${t}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(_t.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([Eg],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class cc extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Se(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class Pg extends cc{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class al extends cc{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var Dg=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(n.next(u))}catch(m){o(m)}}function c(u){try{d(n.throw(u))}catch(m){o(m)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const _h=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Un(async()=>{const{default:n}=await Promise.resolve().then(()=>Or);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},Ag=()=>Dg(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Un(()=>Promise.resolve().then(()=>Or),void 0)).Response:Response}),il=e=>{if(Array.isArray(e))return e.map(r=>il(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[a]=il(n)}),t};var Xs=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(n.next(u))}catch(m){o(m)}}function c(u){try{d(n.throw(u))}catch(m){o(m)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const Ji=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),$g=(e,t,r)=>Xs(void 0,void 0,void 0,function*(){const n=yield Ag();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{t(new Pg(Ji(a),e.status||500))}).catch(a=>{t(new al(Ji(a),a))}):t(new al(Ji(e),e))}),Mg=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(a.body=JSON.stringify(n)),Object.assign(Object.assign({},a),r))};function qn(e,t,r,n,a,i){return Xs(this,void 0,void 0,function*(){return new Promise((o,l)=>{e(r,Mg(t,n,a,i)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>$g(c,l,n))})})}function Ja(e,t,r,n){return Xs(this,void 0,void 0,function*(){return qn(e,"GET",t,r,n)})}function os(e,t,r,n,a){return Xs(this,void 0,void 0,function*(){return qn(e,"POST",t,n,a,r)})}function Rg(e,t,r,n,a){return Xs(this,void 0,void 0,function*(){return qn(e,"PUT",t,n,a,r)})}function Og(e,t,r,n){return Xs(this,void 0,void 0,function*(){return qn(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function kh(e,t,r,n,a){return Xs(this,void 0,void 0,function*(){return qn(e,"DELETE",t,n,a,r)})}var Ye=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(n.next(u))}catch(m){o(m)}}function c(u){try{d(n.throw(u))}catch(m){o(m)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const Ig={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},$d={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Lg{constructor(t,r={},n,a){this.url=t,this.headers=r,this.bucketId=n,this.fetch=_h(a)}uploadOrUpdate(t,r,n,a){return Ye(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},$d),a);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=n,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),a!=null&&a.headers&&(l=Object.assign(Object.assign({},l),a.headers));const d=this._removeEmptyFolders(r),u=this._getFinalPath(d),m=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:t,body:i,headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{})),h=yield m.json();return m.ok?{data:{path:d,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(i){if(Se(i))return{data:null,error:i};throw i}})}upload(t,r,n){return Ye(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return Ye(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",r);try{let c;const d=Object.assign({upsert:$d.upsert},a),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",d.cacheControl)):(c=n,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const m=yield this.fetch(l.toString(),{method:"PUT",body:c,headers:u}),h=yield m.json();return m.ok?{data:{path:i,fullPath:h.Key},error:null}:{data:null,error:h}}catch(c){if(Se(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return Ye(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const i=yield os(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),o=new URL(this.url+i.url),l=o.searchParams.get("token");if(!l)throw new cc("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:l},error:null}}catch(n){if(Se(n))return{data:null,error:n};throw n}})}update(t,r,n){return Ye(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Ye(this,void 0,void 0,function*(){try{return{data:yield os(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(Se(a))return{data:null,error:a};throw a}})}copy(t,r,n){return Ye(this,void 0,void 0,function*(){try{return{data:{path:(yield os(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(Se(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return Ye(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),i=yield os(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(a){if(Se(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return Ye(this,void 0,void 0,function*(){try{const a=yield os(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(a){if(Se(a))return{data:null,error:a};throw a}})}download(t,r){return Ye(this,void 0,void 0,function*(){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=i?`?${i}`:"";try{const l=this._getFinalPath(t);return{data:yield(yield Ja(this.fetch,`${this.url}/${a}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(Se(l))return{data:null,error:l};throw l}})}info(t){return Ye(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield Ja(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:il(n),error:null}}catch(n){if(Se(n))return{data:null,error:n};throw n}})}exists(t){return Ye(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield Og(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Se(n)&&n instanceof al){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&a.push(i);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&a.push(c);let d=a.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${d}`)}}}remove(t){return Ye(this,void 0,void 0,function*(){try{return{data:yield kh(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(Se(r))return{data:null,error:r};throw r}})}list(t,r,n){return Ye(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},Ig),r),{prefix:t||""});return{data:yield os(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(Se(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const Fg="2.7.1",zg={"X-Client-Info":`storage-js/${Fg}`};var er=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(n.next(u))}catch(m){o(m)}}function c(u){try{d(n.throw(u))}catch(m){o(m)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class Vg{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},zg),r),this.fetch=_h(n)}listBuckets(){return er(this,void 0,void 0,function*(){try{return{data:yield Ja(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Se(t))return{data:null,error:t};throw t}})}getBucket(t){return er(this,void 0,void 0,function*(){try{return{data:yield Ja(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(Se(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return er(this,void 0,void 0,function*(){try{return{data:yield os(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Se(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return er(this,void 0,void 0,function*(){try{return{data:yield Rg(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Se(n))return{data:null,error:n};throw n}})}emptyBucket(t){return er(this,void 0,void 0,function*(){try{return{data:yield os(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Se(r))return{data:null,error:r};throw r}})}deleteBucket(t){return er(this,void 0,void 0,function*(){try{return{data:yield kh(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(Se(r))return{data:null,error:r};throw r}})}}class Ug extends Vg{constructor(t,r={},n){super(t,r,n)}from(t){return new Lg(this.url,this.headers,t,this.fetch)}}const Bg="2.50.5";let Xr="";typeof Deno<"u"?Xr="deno":typeof document<"u"?Xr="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Xr="react-native":Xr="node";const qg={"X-Client-Info":`supabase-js-${Xr}/${Bg}`},Wg={headers:qg},Hg={schema:"public"},Gg={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Yg={};var Qg=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(n.next(u))}catch(m){o(m)}}function c(u){try{d(n.throw(u))}catch(m){o(m)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};const Kg=e=>{let t;return e?t=e:typeof fetch>"u"?t=ch:t=fetch,(...r)=>t(...r)},Jg=()=>typeof Headers>"u"?dh:Headers,Xg=(e,t,r)=>{const n=Kg(r),a=Jg();return(i,o)=>Qg(void 0,void 0,void 0,function*(){var l;const c=(l=yield t())!==null&&l!==void 0?l:e;let d=new a(o==null?void 0:o.headers);return d.has("apikey")||d.set("apikey",e),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),n(i,Object.assign(Object.assign({},o),{headers:d}))})};var Zg=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(n.next(u))}catch(m){o(m)}}function c(u){try{d(n.throw(u))}catch(m){o(m)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};function ep(e){return e.endsWith("/")?e:e+"/"}function tp(e,t){var r,n;const{db:a,auth:i,realtime:o,global:l}=e,{db:c,auth:d,realtime:u,global:m}=t,h={db:Object.assign(Object.assign({},c),a),auth:Object.assign(Object.assign({},d),i),realtime:Object.assign(Object.assign({},u),o),global:Object.assign(Object.assign(Object.assign({},m),l),{headers:Object.assign(Object.assign({},(r=m==null?void 0:m.headers)!==null&&r!==void 0?r:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>Zg(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}const Ch="2.70.0",nr=30*1e3,ol=3,Xi=ol*nr,sp="http://localhost:9999",rp="supabase.auth.token",np={"X-Client-Info":`gotrue-js/${Ch}`},ll="X-Supabase-Api-Version",Sh={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},ap=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,ip=6e5;class dc extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Z(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class op extends dc{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function lp(e){return Z(e)&&e.name==="AuthApiError"}class Eh extends dc{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Ts extends dc{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class ns extends Ts{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function cp(e){return Z(e)&&e.name==="AuthSessionMissingError"}class la extends Ts{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ca extends Ts{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class da extends Ts{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function dp(e){return Z(e)&&e.name==="AuthImplicitGrantRedirectError"}class Md extends Ts{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class cl extends Ts{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Zi(e){return Z(e)&&e.name==="AuthRetryableFetchError"}class Rd extends Ts{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class un extends Ts{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Xa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Od=` 	
\r=`.split(""),up=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Od.length;t+=1)e[Od[t].charCodeAt(0)]=-2;for(let t=0;t<Xa.length;t+=1)e[Xa[t].charCodeAt(0)]=t;return e})();function Id(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Xa[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Xa[n]),t.queuedBits-=6}}function Th(e,t,r){const n=up[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Ld(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=o=>{xp(o,n,r)};for(let o=0;o<e.length;o+=1)Th(e.charCodeAt(o),a,i);return t.join("")}function mp(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function hp(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}mp(n,t)}}function xp(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function fp(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)Th(e.charCodeAt(a),r,n);return new Uint8Array(t)}function gp(e){const t=[];return hp(e,r=>t.push(r)),new Uint8Array(t)}function pp(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>Id(a,r,n)),Id(null,r,n),t.join("")}function yp(e){return Math.round(Date.now()/1e3)+e}function vp(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const jt=()=>typeof window<"u"&&typeof document<"u",Ds={tested:!1,writable:!1},mn=()=>{if(!jt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ds.tested)return Ds.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Ds.tested=!0,Ds.writable=!0}catch{Ds.tested=!0,Ds.writable=!1}return Ds.writable};function bp(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,i)=>{t[i]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const Ph=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Un(async()=>{const{default:n}=await Promise.resolve().then(()=>Or);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},jp=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Dh=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},ua=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},ma=async(e,t)=>{await e.removeItem(t)};class ji{constructor(){this.promise=new ji.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}ji.promiseConstructor=Promise;function eo(e){const t=e.split(".");if(t.length!==3)throw new un("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!ap.test(t[n]))throw new un("JWT not in base64url format");return{header:JSON.parse(Ld(t[0])),payload:JSON.parse(Ld(t[1])),signature:fp(t[2]),raw:{header:t[0],payload:t[1]}}}async function Np(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function wp(e,t){return new Promise((n,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await e(i);if(!t(i,null,o)){n(o);return}}catch(o){if(!t(i,o)){a(o);return}}})()})}function _p(e){return("0"+e.toString(16)).substr(-2)}function kp(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let i=0;i<56;i++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,_p).join("")}async function Cp(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function Sp(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await Cp(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function tr(e,t,r=!1){const n=kp();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await Dh(e,`${t}-code-verifier`,a);const i=await Sp(n);return[i,n===i?"plain":"s256"]}const Ep=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Tp(e){const t=e.headers.get(ll);if(!t||!t.match(Ep))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Pp(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function Dp(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Ap=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function sr(e){if(!Ap.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var $p=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const Ms=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Mp=[502,503,504];async function Fd(e){var t;if(!jp(e))throw new cl(Ms(e),0);if(Mp.includes(e.status))throw new cl(Ms(e),e.status);let r;try{r=await e.json()}catch(i){throw new Eh(Ms(i),i)}let n;const a=Tp(e);if(a&&a.getTime()>=Sh["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Rd(Ms(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new ns}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new Rd(Ms(r),e.status,r.weak_password.reasons);throw new op(Ms(r),e.status||500,n)}const Rp=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function re(e,t,r,n){var a;const i=Object.assign({},n==null?void 0:n.headers);i[ll]||(i[ll]=Sh["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const o=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await Op(e,t,r+l,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function Op(e,t,r,n,a,i){const o=Rp(t,n,a,i);let l;try{l=await e(r,Object.assign({},o))}catch(c){throw console.error(c),new cl(Ms(c),0)}if(l.ok||await Fd(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(c){await Fd(c)}}function Ft(e){var t;let r=null;zp(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=yp(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function zd(e){const t=Ft(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function ds(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function Ip(e){return{data:e,error:null}}function Lp(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i}=e,o=$p(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function Fp(e){return e}function zp(e){return e.access_token&&e.refresh_token&&e.expires_in}const to=["global","local","others"];var Vp=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class Up{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=Ph(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=to[0]){if(to.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${to.join(", ")}`);try{return await re(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Z(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await re(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:ds})}catch(n){if(Z(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=Vp(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await re(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:Lp,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Z(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await re(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:ds})}catch(r){if(Z(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,i,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await re(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:Fp});if(u.error)throw u.error;const m=await u.json(),h=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,g=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return g.length>0&&(g.forEach(b=>{const y=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),k=JSON.parse(b.split(";")[1].split("=")[1]);d[`${k}Page`]=y}),d.total=parseInt(h)),{data:Object.assign(Object.assign({},m),d),error:null}}catch(d){if(Z(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){sr(t);try{return await re(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:ds})}catch(r){if(Z(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){sr(t);try{return await re(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:ds})}catch(n){if(Z(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){sr(t);try{return await re(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:ds})}catch(n){if(Z(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){sr(t.userId);try{const{data:r,error:n}=await re(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(Z(r))return{data:null,error:r};throw r}}async _deleteFactor(t){sr(t.userId),sr(t.id);try{return{data:await re(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Z(r))return{data:null,error:r};throw r}}}const Bp={getItem:e=>mn()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{mn()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{mn()&&globalThis.localStorage.removeItem(e)}};function Vd(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function qp(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const rr={debug:!!(globalThis&&mn()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Ah extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Wp extends Ah{}async function Hp(e,t,r){rr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),rr.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){rr.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{rr.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw rr.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Wp(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(rr.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}qp();const Gp={url:sp,storageKey:rp,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:np,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Ud(e,t,r){return await r()}class $n{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=$n.nextInstanceID,$n.nextInstanceID+=1,this.instanceID>0&&jt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},Gp),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new Up({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=Ph(a.fetch),this.lock=a.lock||Ud,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:jt()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=Hp:this.lock=Ud,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?a.storage?this.storage=a.storage:mn()?this.storage=Bp:(this.memoryStorage={},this.storage=Vd(this.memoryStorage)):(this.memoryStorage={},this.storage=Vd(this.memoryStorage)),jt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Ch}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=bp(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),jt()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),dp(i)){const c=(t=i.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:l}=a;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Z(r)?{error:r}:{error:new Eh("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const i=await re(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:Ft}),{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(Z(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var r,n,a;try{let i;if("email"in t){const{email:u,password:m,options:h}=t;let g=null,b=null;this.flowType==="pkce"&&([g,b]=await tr(this.storage,this.storageKey)),i=await re(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:u,password:m,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:g,code_challenge_method:b},xform:Ft})}else if("phone"in t){const{phone:u,password:m,options:h}=t;i=await re(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:m,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(a=h==null?void 0:h.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Ft})}else throw new ca("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(Z(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:o,options:l}=t;r=await re(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:zd})}else if("phone"in t){const{phone:i,password:o,options:l}=t;r=await re(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:zd})}else throw new ca("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new la}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(Z(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,a,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,a,i,o,l,c,d,u,m,h,g;let b,y;if("message"in t)b=t.message,y=t.signature;else{const{chain:k,wallet:x,statement:f,options:p}=t;let S;if(jt())if(typeof x=="object")S=x;else{const v=window;if("solana"in v&&typeof v.solana=="object"&&("signIn"in v.solana&&typeof v.solana.signIn=="function"||"signMessage"in v.solana&&typeof v.solana.signMessage=="function"))S=v.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(p!=null&&p.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=x}const C=new URL((r=p==null?void 0:p.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in S&&S.signIn){const v=await S.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},p==null?void 0:p.signInWithSolana),{version:"1",domain:C.host,uri:C.href}),f?{statement:f}:null));let j;if(Array.isArray(v)&&v[0]&&typeof v[0]=="object")j=v[0];else if(v&&typeof v=="object"&&"signedMessage"in v&&"signature"in v)j=v;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in j&&"signature"in j&&(typeof j.signedMessage=="string"||j.signedMessage instanceof Uint8Array)&&j.signature instanceof Uint8Array)b=typeof j.signedMessage=="string"?j.signedMessage:new TextDecoder().decode(j.signedMessage),y=j.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in S)||typeof S.signMessage!="function"||!("publicKey"in S)||typeof S!="object"||!S.publicKey||!("toBase58"in S.publicKey)||typeof S.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${C.host} wants you to sign in with your Solana account:`,S.publicKey.toBase58(),...f?["",f,""]:[""],"Version: 1",`URI: ${C.href}`,`Issued At: ${(a=(n=p==null?void 0:p.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=p==null?void 0:p.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${p.signInWithSolana.notBefore}`]:[],...!((o=p==null?void 0:p.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${p.signInWithSolana.expirationTime}`]:[],...!((l=p==null?void 0:p.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${p.signInWithSolana.chainId}`]:[],...!((c=p==null?void 0:p.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${p.signInWithSolana.nonce}`]:[],...!((d=p==null?void 0:p.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${p.signInWithSolana.requestId}`]:[],...!((m=(u=p==null?void 0:p.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||m===void 0)&&m.length?["Resources",...p.signInWithSolana.resources.map(j=>`- ${j}`)]:[]].join(`
`);const v=await S.signMessage(new TextEncoder().encode(b),"utf8");if(!v||!(v instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");y=v}}try{const{data:k,error:x}=await re(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:pp(y)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(g=t.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:Ft});if(x)throw x;return!k||!k.session||!k.user?{data:{user:null,session:null},error:new la}:(k.session&&(await this._saveSession(k.session),await this._notifyAllSubscribers("SIGNED_IN",k.session)),{data:Object.assign({},k),error:x})}catch(k){if(Z(k))return{data:{user:null,session:null},error:k};throw k}}async _exchangeCodeForSession(t){const r=await ua(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:i,error:o}=await re(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Ft});if(await ma(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new la}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:o})}catch(i){if(Z(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:i,nonce:o}=t,l=await re(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Ft}),{data:c,error:d}=l;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new la}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(r){if(Z(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,a,i,o;try{if("email"in t){const{email:l,options:c}=t;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await tr(this.storage,this.storageKey));const{error:m}=await re(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:m}}if("phone"in t){const{phone:l,options:c}=t,{data:d,error:u}=await re(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(a=c==null?void 0:c.data)!==null&&a!==void 0?a:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u}}throw new ca("You must provide either an email or phone number.")}catch(l){if(Z(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(t){var r,n;try{let a,i;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:l}=await re(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:Ft});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(a){if(Z(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,n,a;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await tr(this.storage,this.storageKey)),await re(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:Ip})}catch(i){if(Z(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new ns;const{error:a}=await re(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(Z(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:i}=t,{error:o}=await re(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in t){const{phone:n,type:a,options:i}=t,{data:o,error:l}=await re(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new ca("You must provide either an email or phone number and a type")}catch(r){if(Z(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await ua(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Xi:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let o=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,d,u)=>(!o&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,u))})}return{data:{session:t},error:null}}const{session:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await re(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:ds}):await this._useSession(async r=>{var n,a,i;const{data:o,error:l}=r;if(l)throw l;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ns}:await re(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:ds})})}catch(r){if(Z(r))return cp(r)&&(await this._removeSession(),await ma(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:i}=n;if(i)throw i;if(!a.session)throw new ns;const o=a.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await tr(this.storage,this.storageKey));const{data:d,error:u}=await re(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:ds});if(u)throw u;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(n){if(Z(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new ns;const r=Date.now()/1e3;let n=r,a=!0,i=null;const{payload:o}=eo(t.access_token);if(o.exp&&(n=o.exp,a=n<=r),a){const{session:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;i={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(Z(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:o,error:l}=r;if(l)throw l;t=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new ns;const{session:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Z(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!jt())throw new da("No browser detected.");if(t.error||t.error_description||t.error_code)throw new da(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Md("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new da("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Md("No code detected.");const{data:f,error:p}=await this._exchangeCodeForSession(t.code);if(p)throw p;const S=new URL(window.location.href);return S.searchParams.delete("code"),window.history.replaceState(window.history.state,"",S.toString()),{data:{session:f.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:i,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=t;if(!i||!l||!o||!d)throw new da("No session defined in URL");const u=Math.round(Date.now()/1e3),m=parseInt(l);let h=u+m;c&&(h=parseInt(c));const g=h-u;g*1e3<=nr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${m}s`);const b=h-m;u-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,h,u):u-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,h,u);const{data:y,error:k}=await this._getUser(i);if(k)throw k;const x={provider_token:n,provider_refresh_token:a,access_token:i,expires_in:m,expires_at:h,refresh_token:o,token_type:d,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:t.type},error:null}}catch(n){if(Z(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await ua(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return{error:i};const o=(n=a.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:l}=await this.admin.signOut(o,t);if(l&&!(lp(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return t!=="others"&&(await this._removeSession(),await ma(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=vp(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:i},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await tr(this.storage,this.storageKey,!0));try{return await re(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(Z(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Z(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:a}=await this._useSession(async i=>{var o,l,c,d,u;const{data:m,error:h}=i;if(h)throw h;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await re(this.fetch,"GET",g,{headers:this.headers,jwt:(u=(d=m.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return jt()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Z(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:o}=r;if(o)throw o;return await re(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Z(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await wp(async a=>(a>0&&await Np(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await re(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Ft})),(a,i)=>{const o=200*Math.pow(2,a);return i&&Zi(i)&&Date.now()+o-n<nr})}catch(n){if(this._debug(r,"error",n),Z(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),jt()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await ua(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const a=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Xi;if(this._debug(r,`session has${a?"":" not"} expired with margin of ${Xi}s`),a){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),Zi(i)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new ns;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new ji;const{data:i,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!i.session)throw new ns;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(a,"error",i),Z(i)){const o={session:null,error:i};return Zi(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await Dh(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await ma(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&jt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),nr);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/nr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${nr}ms, refresh threshold is ${ol} ticks`),a<=ol&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Ah)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!jt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,o]=await tr(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});a.push(l.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);a.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;return i?{data:null,error:i}:await re(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Z(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:o}=r;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:c,error:d}=await re(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return d?{data:null,error:d}:(t.factorType==="totp"&&(!((a=c==null?void 0:c.totp)===null||a===void 0)&&a.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if(Z(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return{data:null,error:i};const{data:o,error:l}=await re(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(r){if(Z(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;return i?{data:null,error:i}:await re(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Z(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],a=n.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=n.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:n,totp:a,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:a},error:i}=t;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=eo(a.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(m=>m.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const u=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n||(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+ip>Date.now()))return n;const{data:a,error:i}=await re(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!a.keys||a.keys.length===0)throw new un("JWKS is empty");if(this.jwks=a,this.jwks_cached_at=Date.now(),n=a.keys.find(o=>o.kid===t),!n)throw new un("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:g,error:b}=await this.getSession();if(b||!g.session)return{data:null,error:b};n=g.session.access_token}const{header:a,payload:i,signature:o,raw:{header:l,payload:c}}=eo(n);if(Pp(i.exp),!a.kid||a.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:g}=await this.getUser(n);if(g)throw g;return{data:{claims:i,header:a,signature:o},error:null}}const d=Dp(a.alg),u=await this.fetchJwk(a.kid,r),m=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,m,o,gp(`${l}.${c}`)))throw new un("Invalid JWT signature");return{data:{claims:i,header:a,signature:o},error:null}}catch(n){if(Z(n))return{data:null,error:n};throw n}}}$n.nextInstanceID=0;const Yp=$n;class Qp extends Yp{constructor(t){super(t)}}var Kp=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(n.next(u))}catch(m){o(m)}}function c(u){try{d(n.throw(u))}catch(m){o(m)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(e,t||[])).next())})};class Jp{constructor(t,r,n){var a,i,o;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const l=ep(t),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const d=`sb-${c.hostname.split(".")[0]}-auth-token`,u={db:Hg,realtime:Yg,auth:Object.assign(Object.assign({},Gg),{storageKey:d}),global:Wg},m=tp(n??{},u);this.storageKey=(a=m.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=m.global.headers)!==null&&i!==void 0?i:{},m.accessToken?(this.accessToken=m.accessToken,this.auth=new Proxy({},{get:(h,g)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(g)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=m.auth)!==null&&o!==void 0?o:{},this.headers,m.global.fetch),this.fetch=Xg(r,this._getAccessToken.bind(this),m.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},m.realtime)),this.rest=new xg(new URL("rest/v1",c).href,{headers:this.headers,schema:m.db.schema,fetch:this.fetch}),m.accessToken||this._listenForAuthEvents()}get functions(){return new qf(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Ug(this.storageUrl.href,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return Kp(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,storageKey:i,flowType:o,lock:l,debug:c},d,u){const m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Qp({url:this.authUrl.href,headers:Object.assign(Object.assign({},m),d),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,flowType:o,lock:l,debug:c,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new Tg(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Xp=(e,t,r)=>new Jp(e,t,r),Mn="https://zqqwcjujsiqotlyogyoj.supabase.co",$h="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpxcXdjanVqc2lxb3RseW9neW9qIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTIyNDM2OTYsImV4cCI6MjA2NzgxOTY5Nn0.JvkTF9NNOQyUvz8pFjJpwUhB24J-GE7af-HBuSzxagg",Zp=!0,ey=e=>{try{return new URL(e),!0}catch{return!1}};if(!ey(Mn)){if(console.error("❌ [Supabase] Environment variables not configured properly!"),console.error("Please set valid VITE_SUPABASE_URL and VITE_SUPABASE_ANON_KEY in your .env file"),console.error("You can find these values in your Supabase project dashboard"),console.error("VITE_SUPABASE_URL must be a valid URL like: https://your-project-id.supabase.co"),console.error("Current values:",{url:Mn,anonKey:"(set)"}),typeof document<"u"){const e=document.createElement("div");e.innerHTML=`
      <div style="
        position: fixed; 
        top: 0; 
        left: 0; 
        width: 100%; 
        height: 100%; 
        background: #f3f4f6; 
        display: flex; 
        align-items: center; 
        justify-content: center; 
        z-index: 9999;
        font-family: system-ui, -apple-system, sans-serif;
      ">
        <div style="
          background: white; 
          padding: 2rem; 
          border-radius: 0.5rem; 
          box-shadow: 0 10px 25px rgba(0,0,0,0.1); 
          max-width: 500px; 
          text-align: center;
        ">
          <h2 style="color: #dc2626; margin-bottom: 1rem;">⚠️ Supabase Not Connected</h2>
          <p style="color: #374151; margin-bottom: 1rem;">
            Please configure valid Supabase credentials in the .env file:
          </p>
          <div style="
            background: #f9fafb; 
            padding: 1rem; 
            border-radius: 0.25rem; 
            font-family: monospace; 
            font-size: 0.875rem; 
            text-align: left; 
            margin-bottom: 1rem;
          ">
            VITE_SUPABASE_URL=https://your-project-id.supabase.co<br>
            VITE_SUPABASE_ANON_KEY=your_anon_key
          </div>
          <p style="color: #6b7280; font-size: 0.875rem;">
            Find these values in your Supabase project dashboard.<br>
            Make sure the URL starts with https:// and is complete.
          </p>
        </div>
      </div>
    `,document.body.appendChild(e)}throw new Error("Supabase environment variables not configured properly")}console.log("✅ [Supabase] Configured successfully");console.log("🔗 [Supabase] URL:",Mn);console.log("🔑 [Supabase] Anon Key: (hidden in production)"),console.log("🔍 [Diagnóstico] Environment check:",{hasSupabaseUrl:!!Mn,hasAnonKey:!!$h,urlFormat:"OK",production:Zp});const ie=Xp(Mn,$h),Fs=new Map,ty=6e4,Gr=new Map;function J(e,t){const[r,n]=M.useState([]),[a,i]=M.useState(!0),[o,l]=M.useState(null),c=M.useMemo(()=>`${e}-${JSON.stringify(t)}`,[e,JSON.stringify(t)]),d=async()=>{try{const m=Fs.get(c),h=Date.now();if(m&&h-m.timestamp<ty&&!m.loading){n(m.data),i(!1);return}if(Gr.has(c)){const x=Gr.get(c);if(x){const p=await await x,{data:S}=await p;n(S||[]),i(!1);return}}i(!0),l(null);const g=(async()=>{Fs.set(c,{data:[],timestamp:Date.now(),loading:!0});let x=ie.from(e).select((t==null?void 0:t.select)||"*");return t!=null&&t.filter&&Object.entries(t.filter).forEach(([f,p])=>{x=x.eq(f,p)}),t!=null&&t.orderBy&&(x=x.order(t.orderBy.column,{ascending:t.orderBy.ascending??!0})),x})();Gr.set(c,g);const b=await g,{data:y,error:k}=await b;if(k)throw k;Fs.set(c,{data:y||[],timestamp:Date.now(),loading:!1}),Gr.delete(c),n(y||[]),i(!1)}catch(m){l(m instanceof Error?m.message:"Erro desconhecido"),Fs.delete(c),Gr.delete(c),i(!1)}finally{i(!1)}},u=M.useCallback(d,[c]);return M.useEffect(()=>{u()},[c,u]),{data:r,loading:a,error:o,refetch:d}}function ht(e){e?Array.from(Fs.keys()).forEach(t=>{t.includes(e)&&Fs.delete(t)}):Fs.clear()}function Ns(e){const[t,r]=M.useState(!1),[n,a]=M.useState(null);return{insert:async l=>{try{r(!0),a(null),ht(e),console.log(`📝 [useSupabaseInsert] Inserindo dados na tabela ${e}:`,l);const{data:c,error:d}=await ie.from(e).insert(l).select().single();if(d)throw console.error(`❌ [useSupabaseInsert] Erro ao inserir em ${e}:`,d),new Error(d.message||"Erro ao inserir dados");return console.log(`✅ [useSupabaseInsert] Inserção bem-sucedida em ${e}:`,c),c}catch(c){console.error(`💥 [useSupabaseInsert] Operação de inserção falhou em ${e}:`,c);const d=c instanceof Error?c.message:"Erro desconhecido";throw a(d),c}finally{console.log(`🏁 [useSupabaseInsert] Finalizando inserção em ${e}`),r(!1)}},upsert:async(l,c)=>{try{r(!0),a(null),ht(e),console.log("Upserting data:",l,"conflict columns:",c);let d=ie.from(e).upsert(l);d=d.select().single();const{data:u,error:m}=await d;if(m)throw console.error("Supabase upsert error:",m),new Error(m.message||"Erro ao fazer upsert dos dados");return console.log("Upsert successful:",u),u}catch(d){console.error("Upsert operation failed:",d);const u=d instanceof Error?d.message:"Erro desconhecido";throw a(u),d}finally{r(!1)}},loading:t,error:n}}function Rn(e){const[t,r]=M.useState(!1),[n,a]=M.useState(null);return{update:async(o,l)=>{try{r(!0),a(null),ht(e),console.log("Updating data:",{id:o,data:l});const{data:c,error:d}=await ie.from(e).update(l).eq("id",o).select().single();if(d)throw console.error("Supabase update error:",d),new Error(d.message||"Erro ao atualizar dados");return console.log("Update successful:",c),c}catch(c){console.error("Update operation failed:",c);const d=c instanceof Error?c.message:"Erro desconhecido";throw a(d),c}finally{r(!1)}},loading:t,error:n}}function dl(e){const[t,r]=M.useState(!1),[n,a]=M.useState(null);return{deleteRecord:async o=>{try{r(!0),a(null),ht(e),console.log("Deleting record with id:",o);const{error:l}=await ie.from(e).delete().eq("id",o);if(l)throw console.error("Supabase delete error:",l),new Error(l.message||"Erro ao deletar dados");console.log("Delete successful")}catch(l){console.error("Delete operation failed:",l);const c=l instanceof Error?l.message:"Erro desconhecido";throw a(c),l}finally{r(!1)}},loading:t,error:n}}const D=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:2,maximumFractionDigits:2}).format(e),sy=()=>{const{selectedYear:e}=Tt(),[t,r]=je.useState(!1),[n,a]=je.useState(null),{data:i=[],loading:o}=J("proposals");if(o)return s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})});const c=(()=>{const k=["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],x=e;return k.map((f,p)=>{const S=i.filter(j=>{const A=new Date(j.created_at||new Date);return A.getMonth()===p&&A.getFullYear()===x}),C=S.reduce((j,A)=>j+Number(A.total_value||0),0),v=S.filter(j=>j.status==="Fechado").filter(j=>{const A=j.closingDate?new Date(j.closingDate):new Date(j.created_at||new Date);return A.getMonth()===p&&A.getFullYear()===x}).reduce((j,A)=>j+Number(A.total_value||0),0);return{month:f,proposals:C,closed:v}})})(),d=Math.max(...c.map(k=>Math.max(k.proposals,k.closed)),5e4),u=k=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0,maximumFractionDigits:0}).format(k),m=c.reduce((k,x)=>k+x.proposals,0),h=c.reduce((k,x)=>k+x.closed,0),g=m>0?h/m*100:0,b=({type:k,onClose:x})=>{const f=()=>{switch(k){case"total-global":return s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Composição do Valor Total Global"}),s.jsxs("div",{className:"space-y-2",children:[c.map((p,S)=>p.proposals===0?null:s.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[s.jsx("span",{className:"font-medium",children:p.month}),s.jsx("span",{className:"font-bold text-blue-600",children:u(p.proposals)})]},S)),s.jsx("div",{className:"border-t pt-3",children:s.jsxs("div",{className:"flex justify-between font-bold",children:[s.jsx("span",{children:"Total Global"}),s.jsx("span",{className:"text-blue-600",children:u(m)})]})})]})]});case"closed-global":return s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Composição do Valor Fechado Global"}),s.jsxs("div",{className:"space-y-2",children:[c.map((p,S)=>p.closed===0?null:s.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[s.jsx("span",{className:"font-medium",children:p.month}),s.jsx("span",{className:"font-bold text-green-600",children:u(p.closed)})]},S)),s.jsx("div",{className:"border-t pt-3",children:s.jsxs("div",{className:"flex justify-between font-bold",children:[s.jsx("span",{children:"Total Fechado"}),s.jsx("span",{className:"text-green-600",children:u(h)})]})})]})]});default:return null}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Detalhamento"}),s.jsx("button",{onClick:x,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(ne,{className:"w-5 h-5 text-gray-500"})})]}),s.jsx("div",{className:"p-6",children:f()})]})})},y=()=>t?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50 md:hidden",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full h-full max-w-full max-h-full overflow-hidden",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Performance Mensal de Vendas ",e]}),s.jsx("button",{onClick:()=>r(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(ne,{className:"w-5 h-5 text-gray-500"})})]}),s.jsxs("div",{className:"p-4 h-full overflow-y-auto",children:[s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"flex items-center justify-between space-x-2 text-sm mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded"}),s.jsx("span",{className:"text-gray-600",children:"Propostas Totais"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-3 h-3 bg-green-500 rounded"}),s.jsx("span",{className:"text-gray-600",children:"Fechados"})]})]}),s.jsx("div",{className:"flex items-end justify-between space-x-2 h-80 mb-6 ml-16",children:c.map((k,x)=>s.jsxs("div",{className:"flex-1 flex flex-col items-center space-y-1",children:[s.jsxs("div",{className:"relative w-full flex justify-center items-end h-64 min-w-[40px] pt-8",children:[k.closed>0&&k.proposals>0&&s.jsxs("div",{className:"absolute text-sm font-medium text-green-600 whitespace-nowrap z-30",style:{bottom:`${Math.max(5,d>0?k.proposals/d*100:0)+10}%`,left:"50%",transform:"translateX(-50%)"},children:[(k.closed/k.proposals*100).toFixed(1),"%"]}),s.jsx("div",{className:"relative group w-8 bg-blue-500 rounded-t hover:bg-blue-600 transition-colors cursor-pointer",style:{height:`${Math.max(5,d>0?k.proposals/d*100:0)}%`},children:s.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-20",children:["Propostas Totais: ",D(k.proposals)]})}),s.jsx("div",{className:"relative group w-6 -ml-7 bg-green-500 rounded-t hover:bg-green-600 transition-colors cursor-pointer z-10",style:{height:`${Math.max(3,d>0?k.closed/d*100:0)}%`},children:s.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-20",children:["Fechados: ",D(k.closed)]})})]}),s.jsx("span",{className:"text-sm text-gray-600 font-medium",children:k.month})]},x))}),s.jsxs("div",{className:"absolute left-0 top-12 h-64 flex flex-col justify-between text-sm text-gray-500 w-14 text-right pr-2",children:[s.jsx("span",{children:u(d)}),s.jsx("span",{children:u(d*.75)}),s.jsx("span",{children:u(d*.5)}),s.jsx("span",{children:u(d*.25)}),s.jsx("span",{children:u(0)})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4 pt-4 border-t border-gray-200",children:[s.jsxs("div",{className:"text-center",children:[s.jsxs("button",{onClick:()=>a("total-global"),className:"text-xl font-bold text-blue-600 hover:text-blue-700 transition-colors cursor-pointer flex items-center justify-center space-x-1",title:"Clique para ver detalhes",children:[u(m),s.jsx(Xe,{className:"w-4 h-4 ml-1"})]}),s.jsx("div",{className:"text-sm text-gray-600",children:"Valor Total Global"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("button",{onClick:()=>a("closed-global"),className:"text-xl font-bold text-green-600 hover:text-green-700 transition-colors cursor-pointer flex items-center justify-center space-x-1",title:"Clique para ver detalhes",children:[u(h),s.jsx(Xe,{className:"w-4 h-4 ml-1"})]}),s.jsx("div",{className:"text-sm text-gray-600",children:"Valor Fechado Global"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-xl font-bold text-purple-600",children:[g.toFixed(1),"%"]}),s.jsx("div",{className:"text-sm text-gray-600",children:"Taxa Conversão"})]})]})]})]})}):null;return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-3 md:p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-xs md:text-lg font-semibold text-gray-900",children:["Performance Mensal ",e]}),s.jsx("p",{className:"text-xs md:text-sm text-gray-600 hidden md:block",children:"Propostas Totais vs Contratos Fechados"})]}),s.jsxs("div",{className:"flex items-center space-x-1 md:space-x-4 text-xs md:text-sm",children:[s.jsx("button",{onClick:()=>r(!0),className:"md:hidden p-1 hover:bg-gray-100 rounded-lg transition-colors",title:"Expandir gráfico",children:s.jsx(Nf,{className:"w-3 h-3 text-gray-600"})}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("div",{className:"w-2 md:w-3 h-1.5 md:h-3 bg-blue-500 rounded"}),s.jsx("span",{className:"text-gray-600 hidden md:inline text-xs md:text-sm",children:"Propostas Totais"}),s.jsx("span",{className:"text-gray-600 md:hidden text-xs",children:"Prop"})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("div",{className:"w-2 md:w-3 h-1.5 md:h-3 bg-green-500 rounded"}),s.jsx("span",{className:"text-gray-600 text-xs md:text-sm",children:"Fech"})]})]})]}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"flex items-end justify-between space-x-1 h-32 md:h-64 mb-4 ml-2 md:ml-16",children:c.map((k,x)=>s.jsxs("div",{className:"flex-1 flex flex-col items-center space-y-1",children:[s.jsxs("div",{className:"relative w-full flex justify-center items-end h-24 md:h-48 min-w-[15px] md:min-w-[40px] pt-2 md:pt-8",children:[k.closed>0&&k.proposals>0&&s.jsxs("div",{className:"absolute text-xs md:text-xs font-medium text-green-600 whitespace-nowrap z-30 hidden md:block",style:{bottom:`${Math.max(5,d>0?k.proposals/d*100:0)+10}%`,left:"50%",transform:"translateX(-50%)"},children:[(k.closed/k.proposals*100).toFixed(1),"%"]}),s.jsx("div",{className:"relative group w-2 md:w-6 bg-blue-500 rounded-t hover:bg-blue-600 transition-colors cursor-pointer",style:{height:`${Math.max(5,d>0?k.proposals/d*100:0)}%`},children:s.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-20 hidden md:block",children:["Propostas Totais: ",D(k.proposals)]})}),s.jsx("div",{className:"relative group w-1.5 md:w-4 -ml-2 md:-ml-5 bg-green-500 rounded-t hover:bg-green-600 transition-colors cursor-pointer z-10",style:{height:`${Math.max(3,d>0?k.closed/d*100:0)}%`},children:s.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-20 hidden md:block",children:["Fechados: ",D(k.closed)]})})]}),s.jsx("span",{className:"text-xs md:text-xs text-gray-600 font-medium",children:k.month})]},x))}),s.jsxs("div",{className:"absolute left-0 top-0 h-24 md:h-48 flex-col justify-between text-xs md:text-xs text-gray-500 w-7 md:w-14 text-right pr-1 md:pr-2 hidden md:flex",children:[s.jsx("span",{children:u(d)}),s.jsx("span",{className:"hidden md:block",children:u(d*.75)}),s.jsx("span",{children:u(d*.5)}),s.jsx("span",{className:"hidden md:block",children:u(d*.25)}),s.jsx("span",{children:u(0)})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 md:gap-4 pt-4 border-t border-gray-200",children:[s.jsxs("div",{className:"text-center",children:[s.jsxs("button",{onClick:()=>a("total-global"),className:"text-xs md:text-2xl font-bold text-blue-600 hover:text-blue-700 transition-colors cursor-pointer flex items-center justify-center space-x-1",title:"Clique para ver detalhes",children:[u(m),s.jsx(Xe,{className:"w-2 md:w-4 h-2 md:h-4 ml-1"})]}),s.jsx("div",{className:"text-xs md:text-sm text-gray-600",children:"Valor Total Global"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("button",{onClick:()=>a("closed-global"),className:"text-xs md:text-2xl font-bold text-green-600 hover:text-green-700 transition-colors cursor-pointer flex items-center justify-center space-x-1",title:"Clique para ver detalhes",children:[u(h),s.jsx(Xe,{className:"w-2 md:w-4 h-2 md:h-4 ml-1"})]}),s.jsx("div",{className:"text-xs md:text-sm text-gray-600",children:"Valor Fechado Global"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-xs md:text-2xl font-bold text-purple-600",children:[g.toFixed(1),"%"]}),s.jsx("div",{className:"text-xs md:text-sm text-gray-600",children:"Taxa Conversão"})]})]})]}),s.jsx(y,{}),n&&s.jsx(b,{type:n,onClose:()=>a(null)})]})},ha=[{key:"Proposta",label:"Proposta",color:"border-blue-500",bgColor:"bg-blue-500",textColor:"text-white"},{key:"Negociação",label:"Negociação",color:"border-blue-400",bgColor:"bg-blue-400",textColor:"text-white"},{key:"Fechado",label:"Fechado",color:"border-green-500",bgColor:"bg-green-500",textColor:"text-white"},{key:"Perdido",label:"Perdido",color:"border-red-500",bgColor:"bg-red-500",textColor:"text-white"}],ry=()=>{const{selectedYear:e}=Tt(),{data:t=[],loading:r}=J("proposals");if(r)return s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 h-full flex items-center justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});const n=t.filter(h=>new Date(h.created_at).getFullYear()===e),a=n.length,i={Proposta:n.filter(h=>h.status==="Proposta"),Negociação:n.filter(h=>h.status==="Negociação"),Fechado:n.filter(h=>h.status==="Fechado"),Perdido:n.filter(h=>h.status==="Perdido")},o=a>0?(i.Fechado.length/a*100).toFixed(0):"0",c=(()=>{const h=i.Fechado.filter(b=>b.created_at&&b.closing_date);if(h.length===0)return"Calculando...";const g=h.reduce((b,y)=>{const k=new Date(y.created_at),f=new Date(y.closing_date).getTime()-k.getTime(),p=Math.ceil(f/(1e3*60*60*24));return b+p},0);return Math.round(g/h.length)})(),d=(h,g)=>h>0?(g/h*100).toFixed(0):"0",u=h=>{if(a===0)return 20;const g=h/a*100;return Math.max(20,g)},m=h=>a>0?(h/a*100).toFixed(0):"0";return s.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl shadow-sm border-2 border-blue-200 p-6 h-full flex flex-col",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[s.jsx(kf,{className:"w-6 h-6 text-blue-600"}),s.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Funil de Vendas"})]}),s.jsx("p",{className:"text-sm text-gray-600",children:e})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[s.jsxs("div",{className:"bg-white rounded-lg p-4 text-center border border-gray-200",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:a}),s.jsx("div",{className:"text-sm text-gray-600",children:"Propostas Totais"})]}),s.jsxs("div",{className:"bg-white rounded-lg p-4 text-center border border-gray-200",children:[s.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[o,"%"]}),s.jsx("div",{className:"text-sm text-gray-600",children:"Taxa Conversão"})]})]}),s.jsx("div",{className:"flex-1 space-y-4 mb-6",children:ha.map((h,g)=>{const y=i[h.key].length,k=m(y),x=u(y);let f="—",p=0;if(g<ha.length-1){const S=ha[g+1];p=i[S.key].length,f=d(y,p)}return s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:`${h.bgColor} rounded-lg text-center py-4 px-4 ${h.textColor} mx-auto transition-all duration-300 relative`,style:{width:`${x}%`,minWidth:"120px"},children:[s.jsx("div",{className:"font-semibold text-lg",children:h.label}),s.jsxs("div",{className:"text-sm opacity-90",children:[y," propostas (",k,"%)"]}),s.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-10",children:[y," de ",a," propostas"]})]}),g<ha.length-1&&s.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 px-4",children:[s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Af,{className:"w-3 h-3"}),s.jsxs("span",{children:[f,"% conversão"]})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Xe,{className:"w-3 h-3"}),s.jsx("span",{children:y>0?"Com dados":"Sem dados"})]})]})]},h.key)})}),s.jsxs("div",{className:"bg-white rounded-lg p-4 text-center border border-gray-200 mt-auto",children:[s.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[s.jsx(Lt,{className:"w-4 h-4 text-purple-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Tempo Médio Total"})]}),s.jsx("div",{className:"text-xl font-bold text-purple-600",children:typeof c=="number"?`${c} dias`:c}),s.jsx("div",{className:"text-xs text-gray-500",children:"Proposta → Fechado"})]})]})},Bt={async getMonthlyGoals(e){const r=`monthly_goals_${e||new Date().getFullYear()}`,{data:n,error:a}=await ie.from("system_configurations").select("config_data").eq("config_type",r).maybeSingle();return a?[]:(n==null?void 0:n.config_data)||[]},async getMonthlyGoal(e,t){const n=(await this.getMonthlyGoals(t)).find(a=>a.month===e);return(n==null?void 0:n.targetValue)||3e5},async getAnnualGoal(e){return(await this.getMonthlyGoals(e)).reduce((r,n)=>r+n.targetValue,0)},async updateMonthlyGoals(e,t){const n=`monthly_goals_${t||new Date().getFullYear()}`,{error:a}=await ie.from("system_configurations").upsert({config_type:n,config_data:e},{onConflict:"config_type"});if(a)throw a},async getCommissionTiers(){const{data:e,error:t}=await ie.from("system_configurations").select("config_data").eq("config_type","commission_tiers").maybeSingle();return t?[]:(e==null?void 0:e.config_data)||[]},async updateCommissionTiers(e){const{error:t}=await ie.from("system_configurations").upsert({config_type:"commission_tiers",config_data:e},{onConflict:"config_type"});if(t)throw t},async getWeeklyMetrics(){const{data:e,error:t}=await ie.from("system_configurations").select("config_data").eq("config_type","weekly_metrics").maybeSingle();return t?[]:(e==null?void 0:e.config_data)||[]},async updateWeeklyMetrics(e){const{error:t}=await ie.from("system_configurations").upsert({config_type:"weekly_metrics",config_data:e},{onConflict:"config_type"});if(t)throw t},async getOperationalCosts(){const e="operational_costs_multi_year",{data:t,error:r}=await ie.from("system_configurations").select("config_data").eq("config_type",e).maybeSingle();return r?[{id:"1",name:"Custo com funcionários",years:[2024,2025].map(n=>({year:n,months:Array.from({length:12},(a,i)=>({month:i+1,value:0}))}))},{id:"2",name:"Custo com marketing",years:[2024,2025].map(n=>({year:n,months:Array.from({length:12},(a,i)=>({month:i+1,value:0}))}))},{id:"3",name:"Custo com sistemas",years:[2024,2025].map(n=>({year:n,months:Array.from({length:12},(a,i)=>({month:i+1,value:0}))}))},{id:"4",name:"Custos extras",years:[2024,2025].map(n=>({year:n,months:Array.from({length:12},(a,i)=>({month:i+1,value:0}))}))}]:(t==null?void 0:t.config_data)||[]},async updateOperationalCosts(e){const t="operational_costs_multi_year",{error:r}=await ie.from("system_configurations").upsert({config_type:t,config_data:e},{onConflict:"config_type"});if(r)throw r;ht("system_configurations")}};function Mh(){const{selectedYear:e}=Tt(),[t,r]=M.useState([]),[n,a]=M.useState(!0),[i,o]=M.useState(null),l=async()=>{try{a(!0),o(null);const m=await Bt.getMonthlyGoals(e);if(m.length===0){const h=Array.from({length:12},(g,b)=>({month:b+1,monthName:new Date(2025,b,1).toLocaleDateString("pt-BR",{month:"long"}),targetValue:3e5}));await Bt.updateMonthlyGoals(h,e),r(h)}else r(m)}catch(m){o(m instanceof Error?m.message:"Erro ao carregar metas")}finally{a(!1)}};return M.useEffect(()=>{l()},[e]),M.useEffect(()=>{const m=h=>{console.log("🔄 Hook useMonthlyGoals detectou atualização das metas:",h.detail.goals),h.detail.year===e&&(r(h.detail.goals),a(!1),o(null))};return window.addEventListener("monthlyGoalsUpdated",m),()=>{window.removeEventListener("monthlyGoalsUpdated",m)}},[e]),{monthlyGoals:t,selectedYear:e,loading:n,error:i,updateGoals:async m=>{try{a(!0),await Bt.updateMonthlyGoals(m,e),r(m),window.dispatchEvent(new CustomEvent("monthlyGoalsUpdated",{detail:{goals:m,year:e}}))}catch(h){throw o(h instanceof Error?h.message:"Erro ao atualizar metas"),h}finally{a(!1)}},refetch:l,getMonthGoal:m=>{const h=t.find(g=>g.month===m);return(h==null?void 0:h.targetValue)??0},getAnnualGoal:()=>t.reduce((m,h)=>m+h.targetValue,0)}}const ny=()=>{const[e,t]=M.useState(!1),[r,n]=M.useState(null),{selectedYear:a}=Tt(),{data:i=[],loading:o}=J("proposals"),{monthlyGoals:l,getMonthGoal:c,getAnnualGoal:d,loading:u}=Mh(),m=d(),h=1,g=12,b=a;if(je.useEffect(()=>{const N=_=>{console.log("🔄 Metas atualizadas - forçando atualização do CommercialGoalCard"),window.location.reload()};return window.addEventListener("monthlyGoalsUpdated",N),()=>{window.removeEventListener("monthlyGoalsUpdated",N)}},[a]),o||u)return s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:s.jsx("div",{className:"flex items-center justify-center h-32",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})});const y=i.filter(N=>{if(N.status!=="Fechado"||!N.closing_date)return!1;const _=new Date(N.closing_date),T=_.getMonth()+1;return _.getFullYear()===b&&T>=h&&T<=g});(()=>{const N=[];let _={};for(let I=h;I<=g;I++)_[`${b}-${I}`]=c(I);return[...y].sort((I,P)=>new Date(I.closing_date).getTime()-new Date(P.closing_date).getTime()).forEach(I=>{const z=new Date(I.closing_date).getMonth()+1;let $=I.monthly_value*12,q=z;for(;$>0&&q<=g;){const Y=`${b}-${q}`,F=_[Y]||0;if(F>0){const G=Math.min($,F);N.push({id:I.id,client:I.client,monthlyValue:I.monthly_value,annualValue:G,signedMonth:z,signedYear:b,allocatedMonth:q,allocatedYear:b,closingDate:I.closing_date}),_[Y]-=G,$-=G}q++}}),N})();const f=(()=>{const N=[];let _=0;for(let T=h;T<=g;T++){const I=new Date(b,T-1,1).toLocaleDateString("pt-BR",{month:"long"}),P=c(T),z=y.filter(ee=>{const X=new Date(ee.closing_date);return X.getMonth()+1===T&&X.getFullYear()===b}),R=z.reduce((ee,X)=>ee+X.monthly_value*12,0),$=Math.max(0,P+_),q=_,Y=Math.max(0,$-R),F=Math.max(0,R-$);let G=0;P>0&&(F>0?G=-F:G=Y),_=G;const W={month:T,year:b,monthName:I,targetContracts:Math.ceil(P/(P>0?P/12:3e5)),targetRevenue:P,actualContracts:z.length,actualRevenue:R,surplus:F,deficit:Y,adjustedTarget:$,cumulativeDeficit:Math.max(0,_),adjustedTargetFromDeficit:$,effectiveTarget:$,inheritedCarryOver:q,carryOverToNext:G};N.push(W)}return N})(),p=y.reduce((N,_)=>N+_.monthly_value*12,0),S=y.length,C=Math.ceil(m/(m>0?m/12:3e5)),v=p/m*100,j=m-p,A=new Date().getMonth()+1;new Date().getFullYear();const L=[];f.forEach(N=>{N.month<A&&N.actualRevenue<N.targetRevenue&&L.push({type:"warning",message:`${N.monthName}: ${N.actualContracts} contratos fechados - Déficit de ${D(N.deficit)}`}),N.actualRevenue>N.targetRevenue&&L.push({type:"success",message:`${N.monthName}: Meta superada em ${D(N.surplus)}`})});const E=N=>N>=100?"bg-green-500":N>=75?"bg-blue-500":N>=50?"bg-yellow-500":"bg-red-500",w=N=>{const _=new Date,T=_.getMonth()+1,I=_.getFullYear();return b<I||b===I&&N<=T},O=N=>{const _=w(N.month),T=N.month<A&&N.actualRevenue<N.targetRevenue,I=N.actualRevenue>N.targetRevenue,P=N.targetRevenue<=0,z=()=>{n(N.month)};return s.jsxs("button",{onClick:z,className:`rounded-lg p-2 md:p-4 border transition-all ${P?"bg-gray-50 border-gray-200 opacity-50 cursor-not-allowed":_?I?"bg-green-50 border-green-200 hover:bg-green-100":T?"bg-yellow-50 border-yellow-200 hover:bg-yellow-100":"bg-white border-gray-200 hover:bg-gray-50":"bg-gray-100 border-gray-200 opacity-60 cursor-default"} text-left w-full disabled:cursor-not-allowed`,disabled:P,children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h4",{className:`font-medium text-xs md:text-sm ${P?"text-gray-400":_?"text-gray-900":"text-gray-400"}`,children:N.monthName}),_&&!P&&(I?s.jsx(wr,{className:"w-5 h-5 text-green-600"}):T?s.jsx(Dn,{className:"w-5 h-5 text-yellow-600"}):null)]}),s.jsxs("div",{className:`space-y-1 text-xs md:text-sm ${P?"text-gray-400":_?"text-gray-700":"text-gray-400"}`,children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:`text-sm md:text-lg font-bold ${P?"text-gray-400":_?N.actualRevenue>=N.effectiveTarget?"text-green-600":"text-red-600":"text-gray-500"}`,children:P?"Sem meta":s.jsxs(s.Fragment,{children:[D(N.effectiveTarget),s.jsxs("div",{className:"text-xs md:text-xs text-gray-500 font-normal mt-1 hidden md:block",children:["(",D(N.effectiveTarget/12),"/mês)"]})]})}),s.jsx("div",{className:"text-gray-500",children:"Meta Efetiva"})]}),_&&!P&&s.jsxs("div",{className:"text-center mt-2",children:[s.jsx("div",{className:"font-medium text-xs md:text-sm",children:D(N.actualRevenue)}),s.jsxs("div",{className:"text-gray-500 text-xs",children:[N.actualContracts," contrato",N.actualContracts!==1?"s":""]})]})]})]},N.month)},U=({monthData:N,onClose:_})=>{const T=w(N.month),I=N.targetRevenue>0,P=N.inheritedCarryOver||0;return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:[N.monthName," ",b]}),s.jsx("button",{onClick:_,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(ne,{className:"w-5 h-5 text-gray-500"})})]}),s.jsx("div",{className:"p-6 space-y-6",children:I?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:`border rounded-lg p-4 ${T?N.actualRevenue>=N.effectiveTarget?"bg-green-50 border-green-200":"bg-red-50 border-red-200":"bg-blue-50 border-blue-200"}`,children:s.jsxs("div",{className:"flex items-center space-x-3",children:[T&&I&&(N.actualRevenue>=N.effectiveTarget?s.jsx(wr,{className:"w-6 h-6 text-green-600"}):s.jsx(Dn,{className:"w-6 h-6 text-red-600"})),s.jsxs("div",{children:[s.jsx("h3",{className:`text-lg font-semibold ${T?N.actualRevenue>=N.effectiveTarget?"text-green-900":"text-red-900":"text-blue-900"}`,children:T?N.actualRevenue>=N.effectiveTarget?"Meta Atingida":"Meta Não Atingida":"Mês Futuro"}),s.jsx("p",{className:`text-sm ${T?N.actualRevenue>=N.effectiveTarget?"text-green-700":"text-red-700":"text-blue-700"}`,children:T?N.actualRevenue>=N.effectiveTarget?`Superou a meta efetiva em ${D(N.actualRevenue-N.effectiveTarget)}`:`Déficit de ${D(N.effectiveTarget-N.actualRevenue)}`:"Aguardando dados do mês"})]})]})}),s.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Meta Original"}),s.jsx("div",{className:"text-xl font-bold text-blue-600",children:D(N.targetRevenue)})]}),P!==0&&s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-600",children:P>0?"Déficit Herdado":"Superávit Herdado"}),s.jsxs("div",{className:`text-xl font-bold ${P>0?"text-red-600":"text-green-600"}`,children:[P>0?"+":"",D(Math.abs(P))]}),s.jsx("div",{className:"text-xs text-gray-500",children:"Do mês anterior"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Meta Efetiva"}),s.jsx("div",{className:`text-2xl font-bold ${N.effectiveTarget>N.targetRevenue?"text-red-600":N.effectiveTarget<N.targetRevenue?"text-green-600":"text-blue-600"}`,children:D(N.effectiveTarget)}),N.effectiveTarget!==N.targetRevenue&&s.jsx("div",{className:"text-xs text-gray-500",children:N.effectiveTarget>N.targetRevenue?`+${D(N.effectiveTarget-N.targetRevenue)}`:`-${D(N.targetRevenue-N.effectiveTarget)}`})]})]}),s.jsx("div",{className:"space-y-4",children:T&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Realizado"}),s.jsx("div",{className:`text-xl font-bold ${N.actualRevenue>=N.effectiveTarget?"text-green-600":"text-red-600"}`,children:D(N.actualRevenue)}),s.jsxs("div",{className:"text-xs text-gray-500",children:[N.actualContracts," contrato",N.actualContracts!==1?"s":""]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-600",children:N.actualRevenue>=N.effectiveTarget?"Superávit":"Déficit"}),s.jsx("div",{className:`text-xl font-bold ${N.actualRevenue>=N.effectiveTarget?"text-green-600":"text-red-600"}`,children:D(Math.abs(N.actualRevenue-N.effectiveTarget))})]})]})})]}),T&&I&&N.carryOverToNext!==0&&s.jsxs("div",{className:`p-4 rounded-lg border ${N.carryOverToNext>0?"bg-red-100 border-red-200":"bg-green-100 border-green-200"}`,children:[s.jsx("h4",{className:`font-medium ${N.carryOverToNext>0?"text-red-800":"text-green-800"} mb-2`,children:"Impacto no Próximo Mês"}),s.jsx("p",{className:`text-sm ${N.carryOverToNext>0?"text-red-700":"text-green-700"}`,children:N.carryOverToNext>0?`Déficit de ${D(N.carryOverToNext)} será acumulado para o próximo mês`:`Superávit de ${D(Math.abs(N.carryOverToNext))} será abatido do próximo mês`})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Cálculo Detalhado"}),s.jsxs("div",{className:"space-y-2 text-sm text-gray-700",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Meta Original:"}),s.jsx("span",{className:"font-medium",children:D(N.targetRevenue)})]}),P!==0&&s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("span",{children:[P>0?"Déficit":"Superávit"," Herdado:"]}),s.jsxs("span",{className:`font-medium ${P>0?"text-red-600":"text-green-600"}`,children:[P>0?"+":"",D(Math.abs(P))]})]}),s.jsxs("div",{className:"border-t pt-2 flex justify-between font-bold",children:[s.jsx("span",{children:"Meta Efetiva:"}),s.jsx("span",{children:D(N.effectiveTarget)})]}),T&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Realizado:"}),s.jsx("span",{className:"font-medium",children:D(N.actualRevenue)})]}),s.jsxs("div",{className:"border-t pt-2 flex justify-between font-bold",children:[s.jsx("span",{children:N.actualRevenue>=N.effectiveTarget?"Superávit:":"Déficit:"}),s.jsxs("div",{className:N.actualRevenue>=N.effectiveTarget?"text-green-600":"text-red-600",children:[s.jsx("span",{children:D(Math.abs(N.actualRevenue-N.effectiveTarget))}),s.jsxs("div",{className:"text-xs text-gray-500 font-normal",children:["(",D(Math.abs(N.actualRevenue-N.effectiveTarget)/12),"/mês)"]})]})]})]})]})]})]}):s.jsx("div",{className:"text-center py-8",children:s.jsxs("div",{className:"text-gray-500",children:[s.jsx($e,{className:"w-12 h-12 mx-auto mb-3 text-gray-400"}),s.jsx("h3",{className:"text-lg font-medium mb-2",children:"Sem Meta Definida"}),s.jsx("p",{className:"text-sm",children:"Este mês não possui meta comercial configurada"})]})})})]})})};return s.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 rounded-xl shadow-sm border-2 border-blue-200 p-6 mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-xl flex items-center justify-center",children:s.jsx($e,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Meta Comercial ",b]}),s.jsxs("p",{className:"text-gray-600",children:["Janeiro a Dezembro • Meta anual: ",D(m)]})]})]}),s.jsxs("button",{onClick:()=>t(!e),className:"flex items-center space-x-2 px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[s.jsx(Xe,{className:"w-4 h-4"}),s.jsx("span",{children:e?"Ocultar Detalhes":"Ver Detalhes"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[s.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Meta Anual"}),s.jsx($e,{className:"w-5 h-5 text-blue-500"})]}),s.jsx("div",{className:"text-2xl font-bold text-gray-900",children:D(m)}),s.jsxs("div",{className:"text-sm text-gray-500",children:[C," contratos • ",s.jsxs("span",{className:"text-xs",children:["(",D(m/12),"/mês)"]})]})]}),s.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Total Vendido"}),s.jsx(De,{className:"w-5 h-5 text-green-500"})]}),s.jsx("div",{className:"text-2xl font-bold text-green-600",children:D(p)}),s.jsxs("div",{className:"text-sm text-gray-500",children:[S," contratos fechados • ",s.jsxs("span",{className:"text-xs",children:["(",D(p/12),"/mês)"]})]})]}),s.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Progresso"}),s.jsx(ot,{className:"w-5 h-5 text-purple-500"})]}),s.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[v.toFixed(1),"%"]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:s.jsx("div",{className:`h-2 rounded-full transition-all ${E(v)}`,style:{width:`${Math.min(v,100)}%`}})})]}),s.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Falta Atingir"}),s.jsx(Pe,{className:"w-5 h-5 text-orange-500"})]}),s.jsx("div",{className:"text-2xl font-bold text-orange-600",children:j>0?s.jsxs(s.Fragment,{children:[D(j),s.jsxs("div",{className:"text-xs text-gray-500 font-normal mt-1",children:["(",D(j/12),"/mês)"]})]}):"Meta Atingida!"}),s.jsx("div",{className:"text-sm text-gray-500",children:j>0?"Para atingir meta anual":"🎉 Parabéns!"})]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Acompanhamento Mensal - ",b]}),s.jsxs("div",{className:"hidden md:block",children:[s.jsx("div",{className:"grid grid-cols-6 gap-4 mb-4",children:f.slice(0,6).map(N=>O(N))}),s.jsx("div",{className:"grid grid-cols-6 gap-4",children:f.slice(6,12).map(N=>O(N))})]}),s.jsx("div",{className:"md:hidden",children:s.jsx("div",{className:"grid grid-cols-2 gap-3 space-y-0",children:f.map(N=>O(N))})})]}),e&&s.jsx("div",{className:"space-y-6",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 border border-gray-200",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Contratos Fechados ",b," (",S,")"]}),y.length>0?s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Cliente"}),s.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-600",children:"Mês Assinatura"}),s.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-600",children:"Valor Mensal"}),s.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-600",children:"Valor Anual"})]})}),s.jsx("tbody",{children:y.map(N=>{const _=N.monthly_value*12;return new Date(N.closing_date).getMonth()+1,s.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[s.jsx("td",{className:"py-3 px-4 font-medium",children:N.client}),s.jsx("td",{className:"py-3 px-4 text-center",children:new Date(N.closing_date).toLocaleDateString("pt-BR",{month:"short",year:"numeric"})}),s.jsx("td",{className:"py-3 px-4 text-center",children:D(N.monthly_value)}),s.jsx("td",{className:"py-3 px-4 text-center font-medium text-green-600",children:D(_)})]},N.id)})})]})}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx($e,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),s.jsxs("p",{className:"text-gray-500",children:["Nenhum contrato fechado em ",b]}),s.jsx("p",{className:"text-sm text-gray-400",children:"Os contratos fechados aparecerão aqui automaticamente"})]})]})}),r!==null&&s.jsx(U,{monthData:f.find(N=>N.month===r),onClose:()=>n(null)})]})},ay=()=>{const e=()=>196017.31/3,t=()=>86369.53/196017.31,r=e(),n=t(),a=178455.4,i=a/r;return s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 my-6 items-stretch",children:[s.jsxs("div",{className:"p-4 border rounded shadow bg-white flex flex-col h-[350px]",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("h3",{className:"text-sm font-medium text-gray-600 flex items-center gap-1",children:[s.jsx(De,{className:"w-4 h-4 text-blue-500"})," Ticket Médio"]})}),s.jsx("p",{className:"text-2xl font-bold text-blue-600",children:"R$ 14.871,28"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Baseado em 3 contratos fechados"}),s.jsxs("div",{className:"mt-2 text-sm text-gray-700 space-y-1",children:["Total faturado: ",s.jsx("strong",{children:D(44613.85)}),s.jsx("br",{}),"Contratos fechados: ",s.jsx("strong",{children:"3 contratos"}),s.jsx("br",{}),"Ano: ",s.jsx("strong",{children:"2025"})]}),s.jsx("div",{className:"mt-2 text-xs text-green-600 font-medium",children:"● Atualizado automaticamente"}),s.jsxs("div",{className:"mt-4 h-[80px] text-xs bg-blue-50 border border-blue-300 p-2 rounded",children:[s.jsx("strong",{children:"Fórmula:"})," Soma dos valores mensais ÷ Quantidade de contratos",s.jsx("br",{}),'Apenas contratos com status "Fechado\\" em 2025']})]}),s.jsxs("div",{className:"p-4 border rounded shadow bg-white flex flex-col h-[350px]",children:[s.jsxs("h3",{className:"text-sm font-medium text-gray-600 flex items-center gap-1",children:[s.jsx($e,{className:"w-4 h-4 text-orange-500"})," CAC"]}),s.jsx("p",{className:"text-2xl font-bold text-orange-600",children:D(r)}),s.jsx("p",{className:"text-xs text-gray-500",children:"Investimento por cliente adquirido"}),s.jsxs("div",{className:"mt-2 text-sm text-gray-700 space-y-1",children:["Custos 2025: ",s.jsx("strong",{children:D(196017.31)}),s.jsx("br",{}),"Clientes fechados: ",s.jsx("strong",{children:"3 clientes"}),s.jsx("br",{}),"Status: ",s.jsx("span",{className:"text-green-600",children:"● Normal"})]}),s.jsx("div",{className:"mt-2 text-xs text-green-600 font-medium",children:"● Últimos 12 meses"}),s.jsxs("div",{className:"mt-4 h-[80px] text-xs bg-orange-50 border border-orange-300 p-2 rounded",children:[s.jsx("strong",{children:"Fórmula:"})," Custos últimos 12 meses ÷ Clientes únicos fechados",s.jsx("br",{}),"Considera clientes únicos (sem duplicação)"]})]}),s.jsxs("div",{className:"p-4 border rounded shadow bg-white flex flex-col h-[350px]",children:[s.jsxs("h3",{className:"text-sm font-medium text-gray-600 flex items-center gap-1",children:[s.jsx(ot,{className:"w-4 h-4 text-purple-500"})," ROI"]}),s.jsx("p",{className:"text-2xl font-bold text-red-600",children:n.toFixed(2)}),s.jsx("p",{className:"text-xs text-gray-500",children:"Retorno sobre investimento total"}),s.jsxs("div",{className:"mt-2 text-sm text-gray-700 space-y-1",children:["Faturamento c/ margem 20%: ",s.jsx("strong",{children:D(86369.53)}),s.jsx("br",{}),"Custos 2025: ",s.jsx("strong",{children:D(196017.31)}),s.jsx("br",{}),"Status: ",s.jsx("span",{className:"text-red-600",children:"● Baixo"})]}),s.jsx("div",{className:"mt-2 text-xs text-red-600 font-medium",children:"● Retorno negativo"}),s.jsxs("div",{className:"mt-4 h-[80px] text-xs bg-purple-50 border border-purple-300 p-2 rounded",children:[s.jsx("strong",{children:"Fórmula:"})," (Faturamento × 20% − Custos) ÷ Custos × 100",s.jsx("br",{}),"Margem de 20% aplicada sobre faturamento bruto"]})]}),s.jsxs("div",{className:"p-4 border rounded shadow bg-white flex flex-col h-[350px]",children:[s.jsxs("h3",{className:"text-sm font-medium text-gray-600 flex items-center gap-1",children:[s.jsx(rh,{className:"w-4 h-4 text-green-600"})," LTV/CAC"]}),s.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[i.toFixed(1),"x"]}),s.jsx("p",{className:"text-xs text-gray-500",children:"Retorno do investimento em aquisição"}),s.jsxs("div",{className:"mt-2 text-sm text-gray-700 space-y-1",children:["LTV médio: ",s.jsx("strong",{children:D(a)}),s.jsx("br",{}),"CAC (últimos 12 meses): ",s.jsx("strong",{children:D(r)}),s.jsx("br",{}),"Status: ",s.jsx("span",{className:"text-yellow-600",children:"● Marginal"})]}),s.jsxs("div",{className:"mt-4 h-[80px] text-xs bg-green-50 border border-green-300 p-2 rounded",children:[s.jsx("strong",{children:"Fórmula:"})," LTV médio ÷ CAC",s.jsx("br",{}),"LTV = Valor anual do contrato ÷ CAC = Custos ÷ Clientes únicos"]})]})]})},iy=()=>s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 my-6",children:[s.jsxs("div",{className:"flex justify-between items-start p-4 border rounded shadow bg-white h-full",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm text-gray-500 font-medium",children:"Propostas Ativas"}),s.jsx("p",{className:"text-xl font-bold text-gray-900",children:D(558095.76)}),s.jsxs("p",{className:"text-xs text-gray-500",children:[D(46507.98)," valor mensal"]}),s.jsxs("p",{className:"text-xs text-gray-500",children:[4," propostas ativas"]})]}),s.jsx("div",{className:"rounded-full bg-blue-100 p-2",children:s.jsx($e,{className:"w-4 h-4 text-blue-600"})})]}),s.jsxs("div",{className:"flex justify-between items-start p-4 border rounded shadow bg-white h-full",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm text-gray-500 font-medium",children:"Possibilidade de comissão"}),s.jsx("p",{className:"text-xl font-bold text-gray-900",children:D(4234.74)}),s.jsx("p",{className:"text-xs text-gray-500",children:"Propostas em aberto"})]}),s.jsx("div",{className:"rounded-full bg-green-100 p-2",children:s.jsx(De,{className:"w-4 h-4 text-green-600"})})]}),s.jsxs("div",{className:"flex justify-between items-start p-4 border rounded shadow bg-white h-full",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm text-gray-500 font-medium",children:"Negócios Fechados"}),s.jsx("p",{className:"text-xl font-bold text-gray-900",children:3}),s.jsx("p",{className:"text-xs text-gray-500",children:"Total do sistema"})]}),s.jsx("div",{className:"rounded-full bg-purple-100 p-2",children:s.jsx(ot,{className:"w-4 h-4 text-purple-600"})})]}),s.jsxs("div",{className:"flex justify-between items-start p-4 border rounded shadow bg-white h-full",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm text-gray-500 font-medium",children:"Taxa de Conversão"}),s.jsxs("p",{className:"text-xl font-bold text-gray-900",children:[21,"%"]}),s.jsx("p",{className:"text-xs text-gray-500",children:"Proposta → Fechado"})]}),s.jsx("div",{className:"rounded-full bg-orange-100 p-2",children:s.jsx(ot,{className:"w-4 h-4 text-orange-600"})})]})]}),ws=e=>{if(!e)return new Date().toISOString();const t=new Date(e);if(isNaN(t.getTime()))return console.warn("Data inválida fornecida:",e),new Date().toISOString();const r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0");return`${r}-${n}-${a}T12:00:00.000Z`},st=(e,t="pt-BR")=>{if(!e)return"";try{const r=new Date(e);return isNaN(r.getTime())?(console.warn("Data inválida para exibição:",e),""):t==="ISO"?r.toISOString().split("T")[0]:r.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"})}catch(r){return console.error("Erro ao formatar data:",r),""}},On=e=>{if(!e)return"";try{const t=new Date(e);return isNaN(t.getTime())?(console.warn("Data inválida para exibição:",e),""):t.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch(t){return console.error("Erro ao formatar data e hora:",t),""}},_r=e=>{if(!e)return"";try{const t=new Date(e);if(isNaN(t.getTime()))return console.warn("Data inválida para input:",e),"";const r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0");return`${r}-${n}-${a}`}catch(t){return console.error("Erro ao formatar data para input:",t),""}},oy=e=>{if(!e)return!1;const t=new Date(e);return!isNaN(t.getTime())},Mt=()=>{const e=new Date,t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${n}`},ly=()=>{const{data:e=[],loading:t}=J("proposals",{orderBy:{column:"created_at",ascending:!1}}),{data:r=[]}=J("employees"),n=e.filter(c=>c.status==="Proposta"||c.status==="Negociação"||c.status==="Análise de contrato"),a=n.reduce((c,d)=>c+d.total_value,0),i=n.reduce((c,d)=>c+d.commission,0),o=c=>{switch(c){case"Proposta":return"bg-yellow-100 text-yellow-800";case"Negociação":return"bg-blue-100 text-blue-800";case"Análise de contrato":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},l=c=>{if(!c)return null;const d=r.find(u=>u.id===c);return(d==null?void 0:d.name)||"Desconhecido"};return t?s.jsx("div",{className:"flex flex-col justify-between border rounded shadow bg-white p-4 h-full",children:s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):s.jsxs("div",{className:"flex flex-col justify-between border rounded shadow bg-white p-4 h-full",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-md font-semibold text-gray-900",children:"Propostas Ativas"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Em andamento e negociação"})]}),s.jsxs("p",{className:"text-sm text-indigo-600 font-bold",children:[n.length," propostas"]})]}),s.jsx("div",{className:"space-y-3 overflow-y-auto max-h-[280px]",children:n.length>0?n.map(c=>{const d=l(c.closer_id),u=l(c.sdr_id),m=[d,u].filter(Boolean);return s.jsxs("div",{className:"p-3 bg-blue-50 rounded border border-blue-100",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("p",{className:"font-medium text-gray-800 text-sm",children:c.client}),s.jsx("span",{className:`text-xs px-2 py-1 rounded-full font-medium ${o(c.status)}`,children:c.status})]}),s.jsxs("p",{className:"text-sm text-gray-700",children:[D(c.monthly_value)," × ",c.months," meses"]}),s.jsxs("p",{className:"text-xs text-gray-500 mb-1",children:["Total: ",s.jsx("strong",{children:D(c.total_value)})]}),s.jsxs("p",{className:"text-green-600 font-bold text-sm",children:[D(c.commission)," comissão"]}),s.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-2",children:[s.jsxs("span",{children:["Criado: ",st(c.created_at)]}),s.jsx("span",{className:"max-w-[120px] truncate",children:m.length>0?m.join(", "):"Sem responsável"})]})]},c.id)}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(An,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma proposta ativa"}),s.jsx("p",{className:"text-gray-500",children:"Propostas fechadas ou perdidas não aparecem aqui"})]})}),n.length>0&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mt-4 flex justify-between border-t pt-3 text-sm font-medium",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-blue-700",children:D(a)}),s.jsx("p",{className:"text-xs text-gray-500",children:"Valor Total"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-green-700",children:D(i)}),s.jsx("p",{className:"text-xs text-gray-500",children:"Comissão Total"})]})]}),s.jsx("div",{className:"mt-2 text-center",children:s.jsxs("div",{className:"flex items-center justify-center space-x-1 text-xs text-gray-600",children:[s.jsx(ot,{className:"w-3 h-3"}),s.jsxs("span",{children:["Potencial de ",D(i)," em comissões ativas"]})]})})]})]})},Rh=({isOpen:e,onClose:t,person:r})=>{if(!e||!r)return null;const n=a=>{switch(a){case"Fechado":return"bg-green-100 text-green-800";case"Negociação":return"bg-blue-100 text-blue-800";case"Proposta":return"bg-yellow-100 text-yellow-800";case"Perdido":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:s.jsx(De,{className:"w-5 h-5 text-green-600"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Detalhamento de Comissão"}),s.jsxs("div",{className:"flex items-center space-x-3 mt-1",children:[r.avatar&&s.jsx("img",{src:r.avatar,alt:r.name,className:"w-8 h-8 rounded-full"}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:r.name}),s.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["• ",r.role]})]})]})]})]}),s.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(ne,{className:"w-5 h-5 text-gray-500"})})]}),s.jsxs("div",{className:"p-6",children:[s.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-green-900",children:"Total da Comissão"}),s.jsxs("p",{className:"text-sm text-green-700",children:["Baseado em ",r.proposals.length," proposta",r.proposals.length!==1?"s":""]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-3xl font-bold text-green-600",children:D(r.totalCommission)}),s.jsx("div",{className:"text-sm text-green-700",children:"Valor total"})]})]})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-sm border border-gray-200 rounded-lg overflow-hidden",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"text-left p-4 font-medium text-gray-700",children:"Cliente"}),s.jsx("th",{className:"text-center p-4 font-medium text-gray-700",children:"Status"}),s.jsx("th",{className:"text-right p-4 font-medium text-gray-700",children:"Valor da Proposta"}),s.jsx("th",{className:"text-center p-4 font-medium text-gray-700",children:"Taxa Comissão"}),s.jsx("th",{className:"text-right p-4 font-medium text-gray-700",children:"Valor Comissão"}),s.jsx("th",{className:"text-center p-4 font-medium text-gray-700",children:"Data"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:r.proposals.length>0?r.proposals.map(a=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"p-4 font-medium text-gray-900",children:a.client}),s.jsx("td",{className:"p-4 text-center",children:s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${n(a.status)}`,children:a.status})}),s.jsx("td",{className:"p-4 text-right font-medium text-gray-900",children:D(a.totalValue)}),s.jsxs("td",{className:"p-4 text-center text-gray-700",children:[a.commissionRate,"%"]}),s.jsx("td",{className:"p-4 text-right font-semibold text-green-600",children:D(a.commissionValue)}),s.jsx("td",{className:"p-4 text-center text-gray-600",children:a.closingDate?st(a.closingDate):st(a.createdAt)})]},a.proposalId)):s.jsx("tr",{children:s.jsxs("td",{colSpan:6,className:"p-8 text-center text-gray-500",children:[s.jsx(Ks,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),s.jsxs("p",{children:["Nenhuma proposta encontrada para ",r.name]})]})})})]})}),r.proposals.length>0&&s.jsx("div",{className:"mt-6 bg-gray-50 border border-gray-200 rounded-lg p-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-xl font-bold text-blue-600",children:r.proposals.length}),s.jsxs("div",{className:"text-gray-600",children:["Proposta",r.proposals.length!==1?"s":""]})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-xl font-bold text-purple-600",children:D(r.proposals.reduce((a,i)=>a+i.totalValue,0))}),s.jsx("div",{className:"text-gray-600",children:"Valor Total"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-xl font-bold text-green-600",children:D(r.totalCommission)}),s.jsx("div",{className:"text-gray-600",children:"Comissão Total"})]})]})})]}),s.jsx("div",{className:"border-t border-gray-200 p-6",children:s.jsx("div",{className:"flex justify-end",children:s.jsx("button",{onClick:t,className:"px-6 py-2 bg-gray-600 text-white rounded-lg font-medium hover:bg-gray-700 transition-colors",children:"Fechar"})})})]})})},cy=()=>{const[e,t]=je.useState(null),[r,n]=je.useState(null),{data:a=[],loading:i}=J("proposals"),{data:o=[],loading:l}=J("employees");if(i||l)return s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"})})});const c=new Date().getMonth(),d=new Date().getFullYear(),u=a.filter(v=>{if(v.status!=="Fechado"||!v.closing_date)return!1;const j=new Date(v.closing_date);return j.getMonth()===c&&j.getFullYear()===d}),m=u.reduce((v,j)=>v+Number(j.total_value||0),0),g=(v=>v<=6e5?.4:v<=12e5?.8:1.2)(m),b=()=>{const v={};return u.forEach(j=>{const A=Number(j.commission||0);if(j.closer_id){const L=o.find(E=>E.id===j.closer_id);L&&(v[j.closer_id]||(v[j.closer_id]={name:L.name,role:L.role,closerCommission:0,sdrCommission:0,proposals:0}),v[j.closer_id].closerCommission+=A,v[j.closer_id].proposals+=1)}if(j.sdr_id){const L=o.find(E=>E.id===j.sdr_id);L&&(v[j.sdr_id]||(v[j.sdr_id]={name:L.name,role:L.role,closerCommission:0,sdrCommission:0,proposals:0}),v[j.sdr_id].sdrCommission+=A)}}),v},y=v=>{const j=o.find(O=>O.id===v);if(!j)return null;const L=u.filter(O=>O.closer_id===v||O.sdr_id===v).map(O=>{const U=Number(O.commission||0);return{proposalId:O.id,client:O.client,totalValue:O.total_value||0,commissionRate:O.commission_rate||g,commissionValue:U,status:O.status,closingDate:O.closing_date,createdAt:O.created_at}}),E=x[v],w=E?E.closerCommission+E.sdrCommission:0;return{employeeId:v,name:j.name,role:j.role,avatar:j.avatar,totalCommission:w,proposals:L}},k=v=>{const j=y(v);j&&t(j)},x=b(),f=Object.values(x).reduce((v,j)=>v+j.closerCommission+j.sdrCommission,0),p=v=>v===.4?"text-red-600":v===.8?"text-yellow-600":"text-green-600",S=v=>v===.4?"bg-red-50 border-red-200":v===.8?"bg-yellow-50 border-yellow-200":"bg-green-50 border-green-200",C=({type:v,onClose:j})=>{const A=()=>{switch(v){case"total-guaranteed":return s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Composição das Comissões Garantidas"}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[s.jsxs("h4",{className:"font-medium text-blue-900 mb-3",children:["Contratos Fechados Este Mês (",u.length,")"]}),s.jsx("div",{className:"space-y-3",children:u.map(L=>{const E=Number(L.total_value||0)*g/100;return L.closing_date?new Date(L.closing_date):new Date(L.created_at),s.jsxs("div",{className:"bg-white rounded-lg p-3 border border-blue-200",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsxs("div",{children:[s.jsx("h5",{className:"font-medium text-gray-900",children:L.client}),s.jsxs("div",{className:"text-sm text-gray-600",children:["Fechado em: ",st(L.closing_date)]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"font-bold text-green-600",children:D(E)}),s.jsx("div",{className:"text-xs text-gray-500",children:"comissão total"})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs text-gray-600",children:[s.jsxs("div",{children:[s.jsx("span",{children:"Valor Global:"}),s.jsx("div",{className:"font-medium text-blue-600",children:D(L.total_value)})]}),s.jsxs("div",{children:[s.jsx("span",{children:"Taxa:"}),s.jsxs("div",{className:"font-medium",children:[g,"%"]})]}),s.jsxs("div",{children:[s.jsx("span",{children:"Mensal:"}),s.jsxs("div",{className:"font-medium",children:[D(L.monthly_value)," × ",L.months,"m"]})]})]})]},L.id)})})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h4",{className:"font-medium text-gray-900 mt-6 mb-3",children:"Distribuição por Funcionário"}),Object.keys(x).length>0?Object.entries(x).map(([L,E])=>s.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("span",{className:"font-medium",children:E.name}),s.jsx("span",{className:"font-bold text-green-600",children:D(E.closerCommission+E.sdrCommission)})]}),s.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[E.closerCommission>0&&s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("span",{children:["Como Closer (",E.proposals," contratos)"]}),s.jsx("span",{children:D(E.closerCommission)})]}),E.sdrCommission>0&&s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("span",{children:["Como SDR (",g,"% do valor)"]}),s.jsx("span",{children:D(E.sdrCommission)})]})]})]},L)):s.jsxs("div",{className:"text-center py-4 text-gray-500",children:[s.jsx("div",{className:"text-sm",children:"Nenhuma comissão calculada"}),s.jsx("div",{className:"text-xs mt-1",children:"Verifique se existem contratos fechados este mês"})]})]}),s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[s.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"font-bold text-green-600",children:D(m)}),s.jsx("div",{className:"text-gray-600",children:"Volume Fechado"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"font-bold text-green-600",children:[g,"%"]}),s.jsx("div",{className:"text-gray-600",children:"Taxa Aplicada"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"font-bold text-green-600",children:D(f)}),s.jsx("div",{className:"text-gray-600",children:"Total Comissões"})]})]}),s.jsxs("div",{className:"text-center mt-3 text-xs text-green-700",children:[s.jsx("strong",{children:"Fórmula:"})," Valor Fechado × ",g,"% = Total de Comissões"]})]}),s.jsx("div",{className:"border-t pt-3",children:s.jsxs("div",{className:"flex justify-between font-bold",children:[s.jsx("span",{children:"Total Garantido Final"}),s.jsx("span",{className:"text-green-600",children:D(f)})]})})]});case"closed-value":return s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Composição do Valor Fechado"}),s.jsxs("div",{className:"space-y-2",children:[u.map(L=>s.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:L.client}),s.jsxs("div",{className:"text-sm text-gray-600",children:["Fechado em: ",st(L.closing_date)||"Data não informada"]})]}),s.jsx("span",{className:"font-bold text-green-600",children:D(L.total_value)})]},L.id)),s.jsx("div",{className:"border-t pt-3",children:s.jsxs("div",{className:"flex justify-between font-bold",children:[s.jsx("span",{children:"Total Fechado"}),s.jsx("span",{className:"text-green-600",children:D(m)})]})})]})]});default:return s.jsx("div",{className:"text-center py-8",children:s.jsxs("div",{className:"text-gray-500",children:[s.jsx("div",{className:"text-lg mb-2",children:"🔍 Conteúdo não encontrado"}),s.jsxs("div",{className:"text-sm",children:["Tipo de detalhamento: ",v]})]})})}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Detalhamento"}),s.jsx("button",{onClick:j,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(ne,{className:"w-5 h-5 text-gray-500"})})]}),s.jsx("div",{className:"p-6",children:A()})]})})};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center space-x-2",children:[s.jsx(wr,{className:"w-5 h-5 text-green-600"}),s.jsx("span",{children:"Comissões Garantidas do Mês"})]}),s.jsx("p",{className:"text-sm text-gray-600",children:"Baseado em contratos já fechados"})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("button",{onClick:()=>n("total-guaranteed"),className:"text-2xl font-bold text-green-600 hover:text-green-700 transition-colors cursor-pointer flex items-center space-x-1",title:"Clique para ver detalhes",children:[D(f),s.jsx(Xe,{className:"w-4 h-4 ml-1"})]}),s.jsx("div",{className:"text-sm text-gray-500",children:"Total Garantido"})]})]}),s.jsx("div",{className:`mb-6 p-4 rounded-lg border ${S(g)}`,children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Volume Fechado no Mês"}),s.jsxs("button",{onClick:()=>n("closed-value"),className:"text-2xl font-bold text-gray-900 hover:text-gray-700 transition-colors cursor-pointer flex items-center space-x-1",title:"Clique para ver detalhes",children:[D(m),s.jsx(Xe,{className:"w-3 h-3 ml-1"})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:"Taxa Atual"}),s.jsxs("p",{className:`text-2xl font-bold ${p(g)}`,children:[g,"%"]})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[s.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Contratos Fechados"}),s.jsx("p",{className:"text-xl font-bold text-gray-900",children:u.length})]}),s.jsx(wr,{className:"w-8 h-8 text-green-500"})]})}),s.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Valor Fechado"}),s.jsxs("button",{onClick:()=>n("closed-value"),className:"text-xl font-bold text-gray-900 hover:text-gray-700 transition-colors cursor-pointer flex items-center space-x-1",title:"Clique para ver detalhes",children:[D(m),s.jsx(Xe,{className:"w-3 h-3 ml-1"})]})]}),s.jsx(De,{className:"w-8 h-8 text-blue-500"})]})}),s.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Pessoas Beneficiadas"}),s.jsx("p",{className:"text-xl font-bold text-gray-900",children:Object.keys(x).length})]}),s.jsx(Ve,{className:"w-8 h-8 text-purple-500"})]})})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Comissões por Pessoa:"}),Object.entries(x).length>0?Object.entries(x).map(([v,j])=>s.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${j.role==="Closer"?"bg-blue-500":"bg-green-500"}`,children:s.jsx("span",{className:"text-white font-bold text-sm",children:j.name.split(" ").map(A=>A[0]).join("").substring(0,2)})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:j.name}),s.jsxs("p",{className:"text-sm text-gray-500",children:[j.role," • ",j.proposals>0?`${j.proposals} contratos fechados`:"SDR em contratos"]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("button",{onClick:()=>k(v),className:"text-lg font-bold text-green-600 hover:text-green-700 transition-colors cursor-pointer flex items-center space-x-1",title:"Clique para ver detalhes das propostas",children:[D(j.closerCommission+j.sdrCommission),s.jsx(Xe,{className:"w-3 h-3 ml-1"})]}),s.jsxs("div",{className:"text-xs text-gray-500",children:[j.closerCommission>0&&`Closer: ${D(j.closerCommission)}`,j.closerCommission>0&&j.sdrCommission>0&&" • ",j.sdrCommission>0&&`SDR: ${D(j.sdrCommission)}`]})]})]})},v)):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(wr,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"Nenhum contrato fechado este mês"}),s.jsx("p",{className:"text-sm text-gray-400",children:"As comissões aparecerão quando contratos forem fechados"})]})]}),s.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[s.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-3",children:"Escala de Comissões"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 text-sm",children:[s.jsxs("div",{className:`text-center p-2 rounded ${g===.4?"bg-red-100 border border-red-300":"bg-white"}`,children:[s.jsx("div",{className:"font-medium text-red-800",children:"0,4%"}),s.jsx("div",{className:"text-red-600",children:"Até R$ 600 mil"})]}),s.jsxs("div",{className:`text-center p-2 rounded ${g===.8?"bg-yellow-100 border border-yellow-300":"bg-white"}`,children:[s.jsx("div",{className:"font-medium text-yellow-800",children:"0,8%"}),s.jsx("div",{className:"text-yellow-600",children:"R$ 600 mil - R$ 1,2 mi"})]}),s.jsxs("div",{className:`text-center p-2 rounded ${g===1.2?"bg-green-100 border border-green-300":"bg-white"}`,children:[s.jsx("div",{className:"font-medium text-green-800",children:"1,2%"}),s.jsx("div",{className:"text-green-600",children:"Acima de R$ 1,2 mi"})]})]})]})]}),r&&s.jsx(C,{type:r,onClose:()=>n(null)}),s.jsx(Rh,{isOpen:!!e,onClose:()=>t(null),person:e})]})},dy=()=>{const[e,t]=je.useState(null),[r,n]=je.useState(null),{data:a=[],loading:i}=J("proposals"),{data:o=[],loading:l}=J("employees");if(i||l)return s.jsx("div",{className:"bg-gradient-to-br from-green-50 to-blue-50 rounded-xl shadow-sm border border-green-200 p-6",children:s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"})})});const c=a.filter(C=>C.status==="Proposta"||C.status==="Negociação"),d=a.filter(C=>C.status==="Proposta"||C.status==="Negociação"),m=(()=>{const C={};return c.forEach(v=>{if(!C[v.closer_id]){const j=o.find(A=>A.id===v.closer_id);C[v.closer_id]={name:(j==null?void 0:j.name)||"Unknown",closerCommission:0,sdrCommission:0,proposals:0}}if(C[v.closer_id].closerCommission+=Number(v.commission||0),C[v.closer_id].proposals+=1,v.sdr_id){if(!C[v.sdr_id]){const j=o.find(A=>A.id===v.sdr_id);C[v.sdr_id]={name:(j==null?void 0:j.name)||"Unknown",closerCommission:0,sdrCommission:0,proposals:0}}C[v.sdr_id].sdrCommission+=Number(v.commission||0)}}),C})(),h=o.filter(C=>C.role==="Closer").map(C=>({id:C.id,name:C.name,currentMonthSales:a.filter(v=>v.closer_id===C.id&&v.status==="Fechado").reduce((v,j)=>v+(j.total_value||0),0),realizedCommission:a.filter(v=>v.closer_id===C.id&&v.status==="Fechado").reduce((v,j)=>v+(j.commission||0),0),possibleCommission:d.filter(v=>v.closer_id===C.id).reduce((v,j)=>v+(j.commission||0),0),totalCommission:a.filter(v=>v.closer_id===C.id).reduce((v,j)=>v+(j.commission||0),0)})),g=o.filter(C=>C.role==="SDR").map(C=>({id:C.id,name:C.name,currentMonthProposals:a.filter(v=>v.sdr_id===C.id&&new Date(v.created_at).getMonth()===new Date().getMonth()).length,realizedCommission:a.filter(v=>v.sdr_id===C.id&&v.status==="Fechado").reduce((v,j)=>v+(j.commission||0)*.5,0),possibleCommission:d.filter(v=>v.sdr_id===C.id).reduce((v,j)=>v+(j.commission||0)*.5,0),totalCommission:a.filter(v=>v.sdr_id===C.id).reduce((v,j)=>v+(j.commission||0)*.5,0)}));h.reduce((C,v)=>C+v.realizedCommission,0),g.reduce((C,v)=>C+v.realizedCommission,0);const b=h.reduce((C,v)=>C+v.possibleCommission,0),y=g.reduce((C,v)=>C+v.possibleCommission,0),k=Object.values(m).reduce((C,v)=>C+v.closerCommission+v.sdrCommission,0),x=d.reduce((C,v)=>C+Number(v.total_value||0),0),f=C=>{const v=o.find(E=>E.id===C);if(!v)return null;const A=d.filter(E=>E.closer_id===C||E.sdr_id===C).map(E=>{const w=Number(E.commission||0);return{proposalId:E.id,client:E.client,totalValue:E.total_value||0,commissionRate:E.commission_rate||.4,commissionValue:w,status:E.status,closingDate:E.closing_date,createdAt:E.created_at}}),L=A.reduce((E,w)=>E+w.commissionValue,0);return{employeeId:C,name:v.name,role:v.role,avatar:v.avatar,totalCommission:L,proposals:A}},p=C=>{const v=f(C);v&&t(v)},S=({type:C,onClose:v})=>{const j=()=>{switch(C){case"total-possible":return s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Composição das Comissões Possíveis"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[s.jsxs("h4",{className:"font-medium text-blue-900 mb-2",children:["Closers (",b.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),")"]}),h.map(A=>s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:A.name}),s.jsx("span",{className:"font-medium",children:D(A.possibleCommission)})]},A.id))]}),s.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[s.jsxs("h4",{className:"font-medium text-green-900 mb-2",children:["SDRs (",y.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),")"]}),g.map(A=>s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:A.name}),s.jsx("span",{className:"font-medium",children:D(A.possibleCommission)})]},A.id))]}),s.jsx("div",{className:"border-t pt-3",children:s.jsxs("div",{className:"flex justify-between font-bold",children:[s.jsx("span",{children:"Total Geral"}),s.jsx("span",{className:"text-green-600",children:D(k)})]})})]})]});case"proposal-value":return s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Composição do Valor Possível"}),s.jsxs("div",{className:"space-y-3",children:[d.map(A=>s.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:A.client}),s.jsxs("div",{className:"text-sm text-gray-600",children:["R$ ",A.monthly_value.toLocaleString()," × ",A.months," meses"]})]}),s.jsx("span",{className:"font-bold text-blue-600",children:D(A.total_value)})]},A.id)),s.jsx("div",{className:"border-t pt-3",children:s.jsxs("div",{className:"flex justify-between font-bold",children:[s.jsx("span",{children:"Total"}),s.jsx("span",{className:"text-blue-600",children:D(x)})]})})]})]});default:return null}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Detalhamento"}),s.jsx("button",{onClick:v,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(ne,{className:"w-5 h-5 text-gray-500"})})]}),s.jsx("div",{className:"p-6",children:j()})]})})};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-blue-50 rounded-xl shadow-sm border border-green-200 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center space-x-2",children:[s.jsx(De,{className:"w-5 h-5 text-green-600"}),s.jsx("span",{children:"Comissões Possíveis"})]}),s.jsx("p",{className:"text-sm text-gray-600",children:"Baseado nas propostas em aberto"})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:D(k)}),s.jsx("div",{className:"text-sm text-gray-500",children:"Total Possível"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[s.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Propostas Possíveis"}),s.jsx("p",{className:"text-xl font-bold text-blue-600",children:d.length})]}),s.jsx($e,{className:"w-8 h-8 text-blue-500"})]})}),s.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Valor Possível"}),s.jsxs("button",{onClick:()=>n("proposal-value"),className:"text-xl font-bold text-purple-600 hover:text-purple-700 transition-colors cursor-pointer flex items-center space-x-1",title:"Clique para ver detalhes",children:[D(x),s.jsx(Xe,{className:"w-3 h-3 ml-1"})]})]}),s.jsx(ot,{className:"w-8 h-8 text-purple-500"})]})}),s.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Pessoas Envolvidas"}),s.jsx("p",{className:"text-xl font-bold text-orange-600",children:Object.keys(m).length})]}),s.jsx(Ve,{className:"w-8 h-8 text-orange-500"})]})})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Comissões por Pessoa:"}),Object.entries(m).map(([C,v])=>s.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-500 to-blue-600 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-white font-bold text-sm",children:v.name.split(" ").map(j=>j[0]).join("").substring(0,2)})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:v.name}),s.jsxs("p",{className:"text-sm text-gray-500",children:[v.proposals>0?`${v.proposals} propostas como Closer`:"",v.sdrCommission>0?" • SDR em propostas":""]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("button",{onClick:()=>p(C),className:"text-lg font-bold text-green-600 hover:text-green-700 transition-colors cursor-pointer flex items-center space-x-1",title:"Clique para ver detalhes das propostas",children:[D(v.closerCommission+v.sdrCommission),s.jsx(Xe,{className:"w-3 h-3 ml-1"})]}),s.jsxs("div",{className:"text-xs text-gray-500",children:[v.closerCommission>0&&`Closer: ${D(v.closerCommission)}`,v.closerCommission>0&&v.sdrCommission>0&&" • ",v.sdrCommission>0&&`SDR: ${D(v.sdrCommission)}`]})]})]})},C))]}),s.jsx("div",{className:"mt-4 p-3 bg-blue-100 rounded-lg",children:s.jsxs("p",{className:"text-sm text-blue-800 text-center",children:["💡 ",s.jsx("strong",{children:"Motivação:"})," Feche essas ",d.length," propostas e ganhe até ",D(k)," em comissões!"]})})]}),r&&s.jsx(S,{type:r,onClose:()=>n(null)}),s.jsx(Rh,{isOpen:!!e,onClose:()=>t(null),person:e})]})},uy=()=>{const e=[{id:"1",title:"A educação é o caminho",description:"Meta: 70 pts educação | 17 dias restantes | André Silva e mais 2",participants:["André Silva","+2 outros"],prize:"R$ 200,00",status:"active",daysRemaining:17,progress:"Com a meta atingida: 1º colocado em pontos: R$ 200,00 • 1 dia de folga: 2º colocado em pontos: R$ 50,00 • 1 dia de folga: 3º",type:"education"},{id:"2",title:"Competição sadia",description:"Meta: 100 pontos | 17 dias restantes | André Silva e mais 2",participants:["André Silva","+2 outros"],prize:"R$ 150,00",status:"active",daysRemaining:17,progress:"Prêmio de R$ 150,00",type:"points"},{id:"3",title:"Quem agenda mais?",description:"Meta: 15 visitas | 48 dias restantes | Pedro Domingues, Andressa Cordeiro",participants:["Pedro Domingues","Andressa Cordeiro"],prize:"150,00",status:"active",daysRemaining:48,progress:"",type:"meetings"},{id:"4",title:"Liberação do fundo de bonificação",description:"Fundo: 600 pontos | 48 dias restantes | André Silva e mais 2",participants:["André Silva","+2 outros"],prize:"No momento da meta conquistada, liberamos o valor que tem no fundo de bonificação",status:"active",daysRemaining:48,progress:"",type:"bonus"}],t=e.filter(i=>i.status==="active").length,r=0,n=2,a=i=>{switch(i){case"education":return s.jsx(At,{className:"w-4 h-4 text-purple-500"});case"points":return s.jsx($e,{className:"w-4 h-4 text-blue-500"});case"meetings":return s.jsx(Pe,{className:"w-4 h-4 text-green-500"});case"bonus":return s.jsx(ft,{className:"w-4 h-4 text-orange-500"});default:return s.jsx(ft,{className:"w-4 h-4 text-gray-500"})}};return s.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-yellow-50 rounded-xl shadow-sm border-2 border-orange-200 p-6 h-full flex flex-col",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[s.jsx(ft,{className:"w-6 h-6 text-orange-600"}),s.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Desafios e Prêmios"})]}),s.jsx("p",{className:"text-sm text-gray-600",children:"Status dos desafios em andamento"})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[s.jsxs("div",{className:"bg-white rounded-lg p-4 text-center border border-blue-200",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t}),s.jsx("div",{className:"text-sm text-blue-700",children:"Ativos"})]}),s.jsxs("div",{className:"bg-white rounded-lg p-4 text-center border border-green-200",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:r}),s.jsx("div",{className:"text-sm text-green-700",children:"Concluídos"})]}),s.jsxs("div",{className:"bg-white rounded-lg p-4 text-center border border-red-200",children:[s.jsx("div",{className:"text-2xl font-bold text-red-600",children:n}),s.jsx("div",{className:"text-sm text-red-700",children:"Expirados"})]})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto max-h-[400px] pr-2 space-y-4",children:[e.map(i=>s.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 hover:shadow-sm transition-shadow",children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[a(i.type),s.jsx("h3",{className:"font-semibold text-gray-900 text-sm",children:i.title})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Lt,{className:"w-4 h-4 text-orange-500"}),s.jsxs("span",{className:"text-sm font-medium text-orange-600",children:[i.daysRemaining," dias"]})]})]}),s.jsx("div",{className:"text-xs text-gray-600 mb-3",children:i.description}),s.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[s.jsx(Ve,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{className:"text-xs text-gray-600",children:i.participants.join(", ")})]}),s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded p-2 mb-2",children:s.jsxs("div",{className:"text-xs font-medium text-yellow-800",children:["🏆 Prêmio: ",i.prize]})}),i.progress&&s.jsx("div",{className:"text-xs text-gray-500 bg-gray-50 rounded p-2",children:i.progress})]},i.id)),e.length===0&&s.jsxs("div",{className:"text-center py-8",children:[s.jsx(ft,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum desafio ativo"}),s.jsx("p",{className:"text-gray-500",children:"Crie desafios para engajar sua equipe"})]})]}),s.jsx("div",{className:"mt-4 pt-4 border-t border-orange-200",children:s.jsx("button",{className:"w-full bg-orange-600 text-white py-2 px-4 rounded-lg text-sm font-medium hover:bg-orange-700 transition-colors",children:"Ver Todos os Desafios"})})]})},my=()=>{const{selectedYear:e}=Tt(),{loading:t}=J("proposals"),{loading:r}=J("employees");return t||r?s.jsx("div",{className:"flex items-center justify-center py-12 min-h-screen",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),s.jsx("div",{className:"text-lg text-gray-700",children:"Carregando Dashboard..."})]})}):s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-gray-900",children:["Dashboard ",e]}),s.jsx("p",{className:"text-gray-600",children:"Visão geral do desempenho comercial"})]}),s.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600 bg-blue-50 px-3 py-2 rounded-lg",children:[s.jsx(Pe,{className:"w-4 h-4"}),s.jsxs("span",{children:["Ano Fiscal: ",e]})]})]}),s.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"KPI's comerciais"}),s.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Indicadores-chave de performance do negócio"}),s.jsx(ay,{}),s.jsx(ny,{}),s.jsx(iy,{}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsx(sy,{}),s.jsx(ly,{})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsx(cy,{}),s.jsx(dy,{})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsx(ry,{}),s.jsx(uy,{})]})]})},hy=[{key:"economicBuyer",title:"Economic Buyer (Tomador de Decisão)",description:"Identificação e acesso ao verdadeiro tomador de decisão",levels:{1:"Não identificado ou sem acesso",2:"Identificado mas acesso limitado",3:"Identificado e com acesso direto"}},{key:"metrics",title:"Metrics (Objetivos)",description:"Clareza sobre os objetivos e métricas do cliente",levels:{1:"Objetivos vagos ou desconhecidos",2:"Objetivos parcialmente definidos",3:"Objetivos claros e mensuráveis"}},{key:"decisionCriteria",title:"Decision Criteria",description:"Critérios de decisão do cliente",levels:{1:"Critérios desconhecidos",2:"Alguns critérios identificados",3:"Todos os critérios mapeados"}},{key:"decisionProcess",title:"Decision Process",description:"Processo de tomada de decisão",levels:{1:"Processo desconhecido",2:"Processo parcialmente mapeado",3:"Processo totalmente mapeado"}},{key:"identifyPain",title:"Identify Pain",description:"Identificação das dores e necessidades",levels:{1:"Dores superficiais ou genéricas",2:"Algumas dores específicas identificadas",3:"Dores críticas bem mapeadas"}},{key:"champion",title:"Champion/Influenciador",description:"Presença de um defensor interno",levels:{1:"Sem champion identificado",2:"Champion identificado mas neutro",3:"Champion ativo e influente"}},{key:"competition",title:"Competition",description:"Conhecimento sobre a concorrência",levels:{1:"Concorrência desconhecida",2:"Alguns concorrentes identificados",3:"Cenário competitivo mapeado"}},{key:"engagement",title:"Engagement",description:"Nível de engajamento do cliente",levels:{1:"Baixo engajamento",2:"Engajamento moderado",3:"Alto engajamento"}}],Oh=({isOpen:e,onClose:t,onSave:r,currentScores:n,clientName:a})=>{const[i,o]=M.useState(n||{economicBuyer:1,metrics:1,decisionCriteria:1,decisionProcess:1,identifyPain:1,champion:1,competition:1,engagement:1});if(je.useEffect(()=>{n&&o(n)},[n]),!e)return null;const l=Object.values(i).reduce((h,g)=>h+g,0),d=(h=>h<12?{level:"Baixa",color:"text-red-600",bgColor:"bg-red-50"}:h<=18?{level:"Média",color:"text-yellow-600",bgColor:"bg-yellow-50"}:{level:"Alta",color:"text-green-600",bgColor:"bg-green-100"})(l),u=(h,g)=>{o(b=>({...b,[h]:g}))},m=()=>{console.log("Salvando avaliação de probabilidade:",{scores:i,totalScore:l,probabilityLevel:d.level}),r(i)};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Avaliação de Probabilidade"}),s.jsx("p",{className:"text-gray-600",children:a})]}),s.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(ne,{className:"w-5 h-5 text-gray-500"})})]}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:`mb-6 p-4 rounded-lg border-2 ${d.bgColor} ${d.level==="Baixa"?"border-red-200":d.level==="Média"?"border-yellow-200":"border-green-200"}`,children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Probabilidade Atual"}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Pontuação total: ",l,"/24"]})]}),s.jsx("div",{className:`text-2xl font-bold ${d.color}`,children:d.level})]}),s.jsxs("div",{className:"mt-2 text-sm text-gray-700",children:[s.jsx("strong",{children:"Cálculo:"})," ",Object.entries(i).map(([h,g])=>`${g}`).join(" + ")," = ",l," pontos"]})]}),s.jsx("div",{className:"space-y-6",children:hy.map(h=>s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"text-lg font-medium text-gray-900",children:h.title}),s.jsx("p",{className:"text-sm text-gray-600",children:h.description})]}),s.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[s.jsx(Xe,{className:"w-4 h-4 text-gray-400"}),s.jsxs("span",{className:"text-sm text-gray-500",children:["Nota: ",i[h.key]]})]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[1,2,3].map(g=>s.jsxs("label",{className:`relative flex items-center p-3 border rounded-lg cursor-pointer transition-colors ${i[h.key]===g?"border-blue-500 bg-blue-50":"border-gray-200 hover:bg-gray-50"}`,children:[s.jsx("input",{type:"radio",name:h.key,value:g,checked:i[h.key]===g,onChange:()=>u(h.key,g),className:"sr-only"}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:`w-4 h-4 rounded-full border-2 flex items-center justify-center ${i[h.key]===g?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:i[h.key]===g&&s.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),s.jsxs("div",{children:[s.jsxs("div",{className:"font-medium text-gray-900",children:["Nível ",g," (",g," ponto",g>1?"s":"",")"]}),s.jsx("div",{className:"text-sm text-gray-600",children:h.levels[g]})]})]})]},g))})]},h.key))}),s.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Escala de Probabilidade"}),s.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{className:"text-center p-2 bg-red-100 rounded",children:[s.jsx("div",{className:"font-medium text-red-800",children:"Baixa"}),s.jsx("div",{className:"text-red-600",children:"Soma < 12"})]}),s.jsxs("div",{className:"text-center p-2 bg-yellow-100 rounded",children:[s.jsx("div",{className:"font-medium text-yellow-800",children:"Média"}),s.jsx("div",{className:"text-yellow-600",children:"Soma 12-18"})]}),s.jsxs("div",{className:"text-center p-2 bg-green-100 rounded",children:[s.jsx("div",{className:"font-medium text-green-800",children:"Alta"}),s.jsx("div",{className:"text-green-600",children:"Soma > 18"})]})]})]}),s.jsxs("div",{className:"flex space-x-4 pt-6",children:[s.jsx("button",{onClick:m,className:"flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"Salvar Avaliação"}),s.jsx("button",{onClick:t,className:"flex-1 border border-gray-300 text-gray-700 py-3 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Cancelar"})]})]})]})})},xy=({proposalId:e,proposalClient:t,isOpen:r,onClose:n})=>{const{data:a=[],loading:i}=J("proposal_status_history",{filter:{proposal_id:e},orderBy:{column:"changed_at",ascending:!1}});if(!r)return null;const o=l=>{switch(l){case"Proposta":return"bg-yellow-100 text-yellow-800 border-yellow-300";case"Negociação":return"bg-blue-100 text-blue-800 border-blue-300";case"Análise de contrato":return"bg-purple-100 text-purple-800 border-purple-300";case"Fechado":return"bg-green-100 text-green-800 border-green-300";case"Perdido":return"bg-red-100 text-red-800 border-red-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:s.jsx(Zo,{className:"w-5 h-5 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Histórico de Status"}),s.jsx("p",{className:"text-sm text-gray-600",children:t})]})]}),s.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(ne,{className:"w-5 h-5 text-gray-500"})})]}),s.jsx("div",{className:"p-6",children:i?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a.length>0?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"text-sm text-gray-600 mb-4",children:[a.length," alteração",a.length>1?"ões":""," de status registrada",a.length>1?"s":""]}),a.map((l,c)=>s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("div",{className:"flex items-center space-x-3",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[l.old_status&&s.jsxs(s.Fragment,{children:[s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${o(l.old_status)}`,children:l.old_status}),s.jsx(ac,{className:"w-4 h-4 text-gray-400 transform rotate-[-90deg]"})]}),s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${o(l.new_status)}`,children:l.new_status})]})}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:l.changed_by}),s.jsx("div",{className:"text-xs text-gray-500",children:On(l.changed_at)})]})]}),l.notes&&s.jsx("div",{className:"text-sm text-gray-600 bg-gray-50 rounded p-2 mt-2",children:l.notes}),c===0&&s.jsx("div",{className:"mt-2 text-xs text-blue-600 font-medium",children:"Alteração mais recente"})]},l.id))]}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Zo,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum histórico"}),s.jsx("p",{className:"text-gray-500",children:"As alterações de status desta proposta aparecerão aqui"})]})})]})})},fy=({proposal:e,isOpen:t,onClose:r,onEdit:n,onUpdateProbability:a,readOnly:i=!1})=>{const{data:o=[]}=J("employees"),[l,c]=M.useState(!1),[d,u]=M.useState(!1);if(!t)return null;const m=o.find(x=>x.id===e.closerId),h=e.sdrId?o.find(x=>x.id===e.sdrId):null,g=x=>{switch(x){case"Fechado":return"bg-green-100 text-green-800 border-green-200";case"Negociação":return"bg-blue-100 text-blue-800 border-blue-200";case"Proposta":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"Perdido":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},y=(x=>{if(!x)return{level:"Não avaliada",color:"text-gray-500",bgColor:"bg-gray-100"};const f=Object.values(x).reduce((p,S)=>p+S,0);return f<12?{level:"Baixa",color:"text-red-600",bgColor:"bg-red-100 border-red-300"}:f<=18?{level:"Média",color:"text-yellow-600",bgColor:"bg-yellow-100 border-yellow-300"}:{level:"Alta",color:"text-green-600",bgColor:"bg-green-100 border-green-300"}})(e.probabilityScores),k=x=>{const f=Object.values(x).reduce((p,S)=>p+S,0);console.log("Atualizando probabilidade nos detalhes:",{scores:x,total:f}),a(x),setTimeout(()=>{c(!1)},500)};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:e.client}),s.jsx("p",{className:"text-gray-600",children:"Detalhes da proposta"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[!i&&n&&s.jsxs("button",{onClick:n,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[s.jsx(Zt,{className:"w-4 h-4"}),s.jsx("span",{children:"Editar"})]}),s.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(ne,{className:"w-5 h-5 text-gray-500"})})]})]}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Status"}),s.jsxs("div",{className:"mt-1",children:[s.jsx("span",{className:`inline-flex px-3 py-1 rounded-full text-sm font-medium border ${g(e.status)}`,children:e.status}),s.jsx("button",{onClick:()=>u(!0),className:"ml-2 text-xs text-blue-600 hover:text-blue-800 underline",children:"Ver histórico"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Probabilidade"}),s.jsx("div",{className:"mt-1",children:!i&&a?s.jsx("button",{onClick:()=>c(!0),className:`inline-flex px-3 py-1 rounded-full text-sm font-medium border hover:opacity-80 transition-opacity ${y.bgColor} ${y.color} border-current`,children:y.level}):s.jsx("span",{className:`inline-flex px-3 py-1 rounded-full text-sm font-medium border ${y.bgColor} ${y.color} border-current`,children:y.level})})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Criado em"}),s.jsxs("div",{className:"mt-1 flex items-center space-x-2",children:[s.jsx(Pe,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{className:"text-gray-900",children:On(e.createdAt)})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Última atualização"}),s.jsxs("div",{className:"mt-1 flex items-center space-x-2",children:[s.jsx(Lt,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{className:"text-gray-900",children:On(e.updatedAt)})]})]})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informações Financeiras"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-blue-100 rounded-lg mb-3 mx-auto",children:s.jsx(De,{className:"w-6 h-6 text-blue-600"})}),s.jsx("p",{className:"text-sm text-gray-500",children:"Valor Mensal"}),s.jsx("p",{className:"text-xl font-bold text-gray-900",children:D(e.monthlyValue)})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-purple-100 rounded-lg mb-3 mx-auto",children:s.jsx(Pe,{className:"w-6 h-6 text-purple-600"})}),s.jsx("p",{className:"text-sm text-gray-500",children:"Duração"}),s.jsxs("p",{className:"text-xl font-bold text-gray-900",children:[e.months," meses"]})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-green-100 rounded-lg mb-3 mx-auto",children:s.jsx($e,{className:"w-6 h-6 text-green-600"})}),s.jsx("p",{className:"text-sm text-gray-500",children:"Valor Total"}),s.jsx("p",{className:"text-xl font-bold text-gray-900",children:D(e.totalValue)})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-orange-100 rounded-lg mb-3 mx-auto",children:s.jsx(ot,{className:"w-6 h-6 text-orange-600"})}),s.jsx("p",{className:"text-sm text-gray-500",children:"Comissão"}),s.jsx("p",{className:"text-xl font-bold text-green-600",children:D(e.commission)}),s.jsxs("p",{className:"text-xs text-gray-500",children:["(",e.commissionRate,"%)"]})]})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Equipe Responsável"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[m&&s.jsxs("div",{className:"flex items-center space-x-4 p-4 bg-white rounded-lg border border-gray-200",children:[s.jsx("img",{src:m.avatar,alt:m.name,className:"w-12 h-12 rounded-full"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:m.name}),s.jsx("p",{className:"text-sm text-gray-500",children:"Closer"}),s.jsx("p",{className:"text-xs text-gray-400",children:m.email})]})]}),h?s.jsxs("div",{className:"flex items-center space-x-4 p-4 bg-white rounded-lg border border-gray-200",children:[s.jsx("img",{src:h.avatar,alt:h.name,className:"w-12 h-12 rounded-full"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:h.name}),s.jsx("p",{className:"text-sm text-gray-500",children:"SDR"}),s.jsx("p",{className:"text-xs text-gray-400",children:h.email})]})]}):s.jsx("div",{className:"flex items-center justify-center p-4 bg-white rounded-lg border border-gray-200 border-dashed",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Ks,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Nenhum SDR atribuído"})]})})]})]}),s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-green-800 mb-4",children:"Detalhamento da Comissão"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-green-700",children:"Valor base do cálculo:"}),s.jsxs("span",{className:"font-medium text-green-900",children:[D(e.monthlyValue)," × ",e.months," meses = ",D(e.totalValue)]})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-green-700",children:"Taxa de comissão:"}),s.jsxs("span",{className:"font-medium text-green-900",children:[e.commissionRate,"%"]})]}),s.jsxs("div",{className:"border-t border-green-300 pt-3",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-green-700 font-medium",children:"Comissão do Closer:"}),s.jsx("span",{className:"font-bold text-green-900 text-lg",children:D(e.commission)})]}),h&&s.jsxs("div",{className:"flex justify-between items-center mt-2",children:[s.jsx("span",{className:"text-green-700 font-medium",children:"Comissão do SDR (50%):"}),s.jsx("span",{className:"font-bold text-green-900 text-lg",children:D(e.commission*.5)})]})]})]})]})]})]})}),!i&&a&&s.jsx(Oh,{isOpen:l,onClose:()=>c(!1),onSave:k,currentScores:e.probabilityScores,clientName:e.client}),s.jsx(xy,{proposalId:e.id,proposalClient:e.client,isOpen:d,onClose:()=>u(!1)})]})},gy=({proposal:e,isOpen:t,onClose:r,onSave:n,onDelete:a})=>{const{data:i=[]}=J("employees"),{isAdministrative:o}=Js(),[l,c]=M.useState(!1),[d,u]=M.useState({client:e.client,monthlyValue:e.monthlyValue,months:e.months,status:e.status,closerId:e.closerId,sdrId:e.sdrId||"",proposalDate:_r(e.createdAt),closingDate:_r(e.closingDate),lostDate:_r(e.lostDate),lostReason:e.lostReason||"Fechou com concorrente"});if(!t)return null;const m=(f,p)=>({commission:f*p*.4/100,rate:.4}),h=f=>{f.preventDefault(),console.log("Submitting proposal update:",d),d.status==="Fechado"&&!d.closingDate&&(d.closingDate=Mt(),console.log("Auto-setting closing_date to current date:",d.closingDate));const p=d.monthlyValue*d.months,{commission:S,rate:C}=m(d.monthlyValue,d.months),v={...e,client:d.client,monthlyValue:d.monthlyValue,months:d.months,totalValue:p,status:d.status,commission:S,commissionRate:C,closerId:d.closerId,sdrId:d.sdrId||void 0,proposalDate:d.proposalDate,closingDate:d.status==="Fechado"?ws(d.closingDate):null,lostDate:d.status==="Perdido"?ws(d.lostDate):null,lostReason:d.status==="Perdido"?d.lostReason:null,updatedAt:ws(Mt())};console.log("Updated proposal object:",v),n(v),r()},g=async()=>{const f=`⚠️ ATENÇÃO: EXCLUSÃO IRREVERSÍVEL

Tem certeza que deseja EXCLUIR PERMANENTEMENTE a proposta "${e.client}"?

Esta ação irá:
• Remover a proposta do sistema
• Excluir dados de probabilidade associados
• Atualizar todas as estatísticas
• Impactar cálculos de comissões

⚠️ ESTA AÇÃO NÃO PODE SER DESFEITA!

Digite "EXCLUIR" para confirmar:`,p=prompt(f);if(p==="EXCLUIR"){c(!0);try{console.log("🗑️ Iniciando exclusão da proposta:",e.id);const{error:S}=await ie.from("proposals").delete().eq("id",e.id);if(S){console.error("Erro ao excluir proposta:",S),alert(`Erro ao excluir proposta: ${S.message}`);return}console.log("✅ Proposta excluída com sucesso"),a&&a(),r(),alert(`✅ Proposta excluída com sucesso!

🔄 Todos os dados relacionados foram removidos do sistema.`)}catch(S){console.error("Erro inesperado ao excluir proposta:",S),alert("Erro inesperado ao excluir proposta. Tente novamente.")}finally{c(!1)}}else p!==null&&alert('Exclusão cancelada. Digite exatamente "EXCLUIR" para confirmar.')},b=i.filter(f=>f.role==="Closer"),y=i.filter(f=>f.role==="SDR"),{commission:k,rate:x}=m(d.monthlyValue,d.months);return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Editar Proposta"}),s.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(ne,{className:"w-5 h-5 text-gray-500"})})]}),s.jsxs("form",{onSubmit:h,className:"p-6 space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cliente"}),s.jsx("input",{type:"text",value:d.client,onChange:f=>u({...d,client:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data da Proposta"}),s.jsx("input",{type:"date",value:d.proposalDate,onChange:f=>u({...d,proposalDate:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,max:Mt()})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Valor Mensal (R$)"}),s.jsx("input",{type:"number",value:d.monthlyValue,onChange:f=>u({...d,monthlyValue:Number(f.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,min:"0",step:"0.01"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Meses"}),s.jsx("input",{type:"number",value:d.months,onChange:f=>u({...d,months:Number(f.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,min:"1"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),s.jsxs("select",{value:d.status,onChange:f=>u({...d,status:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"Proposta",children:"Proposta"}),s.jsx("option",{value:"Negociação",children:"Negociação"}),s.jsx("option",{value:"Fechado",children:"Fechado"}),s.jsx("option",{value:"Perdido",children:"Perdido"})]})]}),d.status==="Fechado"&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data de Fechamento"}),s.jsx("input",{type:"date",value:d.closingDate,onChange:f=>u({...d,closingDate:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:d.status==="Fechado",max:Mt()}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Data em que o contrato foi efetivamente fechado"})]}),d.status==="Perdido"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data da Perda"}),s.jsx("input",{type:"date",value:d.lostDate,onChange:f=>u({...d,lostDate:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:d.status==="Perdido",max:Mt()}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Data em que perdemos a proposta"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Motivo da Perda"}),s.jsxs("select",{value:d.lostReason,onChange:f=>u({...d,lostReason:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:d.status==="Perdido",children:[s.jsx("option",{value:"Fechou com concorrente",children:"Fechou com concorrente"}),s.jsx("option",{value:"Fechou com o atual",children:"Fechou com o atual"}),s.jsx("option",{value:"Desistiu da contratação",children:"Desistiu da contratação"})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Selecione o motivo pelo qual perdemos a proposta"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Closer"}),s.jsxs("select",{value:d.closerId,onChange:f=>u({...d,closerId:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[s.jsx("option",{value:"",children:"Selecione um closer"}),b.map(f=>s.jsx("option",{value:f.id,children:f.name},f.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"SDR (Opcional)"}),s.jsxs("select",{value:d.sdrId,onChange:f=>u({...d,sdrId:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"Selecione um SDR"}),y.map(f=>s.jsx("option",{value:f.id,children:f.name},f.id))]})]})]}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsx("h3",{className:"text-sm font-medium text-blue-800 mb-2",children:"Prévia da Comissão Atualizada"}),s.jsx("div",{className:"text-xs text-blue-700 mb-2",children:"* Taxa final será definida pelo volume total fechado no mês"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-blue-600",children:"Valor Total:"}),s.jsx("span",{className:"font-bold ml-2",children:D(d.monthlyValue*d.months)})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-blue-600",children:"Taxa Base:"}),s.jsxs("span",{className:"font-bold ml-2",children:[x,"%"]})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("span",{className:"text-blue-600",children:"Comissão Base:"}),s.jsx("span",{className:"font-bold ml-2 text-lg",children:D(k)})]})]}),s.jsxs("div",{className:"mt-3 p-2 bg-blue-100 rounded text-xs text-blue-800",children:[s.jsx("strong",{children:"Escala Real:"})," 0,4% (até R$ 600k) • 0,8% (R$ 600k-1,2mi) • 1,2% (acima R$ 1,2mi)"]})]}),s.jsxs("div",{className:"flex space-x-4 pt-4",children:[o&&s.jsxs("button",{type:"button",onClick:g,disabled:l,className:"px-4 py-3 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[s.jsx(It,{className:"w-4 h-4"}),s.jsx("span",{children:l?"Excluindo...":"Excluir Proposta"})]}),s.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:opacity-50",disabled:l,children:l?"Processando...":"Salvar Alterações"}),s.jsx("button",{type:"button",onClick:r,className:"flex-1 border border-gray-300 text-gray-700 py-3 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors disabled:opacity-50",disabled:l,children:"Cancelar"})]})]})]})})},so=[{value:"Proposta",label:"Proposta",color:"bg-yellow-100 text-yellow-800"},{value:"Negociação",label:"Negociação",color:"bg-blue-100 text-blue-800"},{value:"Análise de contrato",label:"Análise de contrato",color:"bg-purple-100 text-purple-800"},{value:"Fechado",label:"Fechado",color:"bg-green-100 text-green-800"},{value:"Perdido",label:"Perdido",color:"bg-red-100 text-red-800"}],py=({currentStatus:e,proposalId:t,proposalClient:r,onStatusChange:n,readOnly:a=!1})=>{const[i,o]=M.useState(!1),[l,c]=M.useState(!1),d=so.find(m=>m.value===e)||so[0],u=async m=>{if(!(m===e||a)){c(!0);try{console.log("🔄 Atualizando status da proposta:",{proposalId:t,oldStatus:e,newStatus:m,client:r});const h={status:m,updated_at:new Date().toISOString()};m==="Fechado"&&e!=="Fechado"?h.closing_date=ws(new Date().toISOString().split("T")[0]):m!=="Fechado"&&(h.closing_date=null),m==="Perdido"&&e!=="Perdido"?(h.lost_date=ws(new Date().toISOString().split("T")[0]),h.lost_reason="Fechou com concorrente"):m!=="Perdido"&&(h.lost_date=null,h.lost_reason=null);const{error:g}=await ie.from("proposals").update(h).eq("id",t);if(g)throw g;const{error:b}=await ie.from("proposal_status_history").insert({proposal_id:t,old_status:e,new_status:m,changed_by:"Sistema",changed_at:new Date().toISOString(),notes:`Status alterado de "${e}" para "${m}" via Dashboard`});b&&console.warn("Erro ao salvar histórico (não crítico):",b),console.log("✅ Status atualizado com sucesso!"),n(),o(!1)}catch(h){console.error("❌ Erro ao atualizar status:",h),alert(`Erro ao atualizar status: ${h instanceof Error?h.message:"Erro desconhecido"}`)}finally{c(!1)}}};return a?s.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${d.color}`,children:d.label}):s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:()=>o(!i),disabled:l,className:`flex items-center space-x-1 px-3 py-1 rounded-full text-sm font-medium transition-all ${d.color} ${l?"opacity-50 cursor-not-allowed":"hover:opacity-80 cursor-pointer"}`,children:[s.jsx("span",{children:l?"Atualizando...":d.label}),!l&&s.jsx(ac,{className:"w-3 h-3"})]}),i&&!l&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>o(!1)}),s.jsx("div",{className:"absolute top-full left-0 mt-1 w-48 bg-white border border-gray-200 rounded-lg shadow-lg z-20",children:s.jsxs("div",{className:"p-2",children:[s.jsx("div",{className:"text-xs text-gray-500 px-2 py-1 border-b border-gray-200 mb-1",children:s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Lt,{className:"w-3 h-3"}),s.jsx("span",{children:"Alterar status"})]})}),so.map(m=>s.jsxs("button",{onClick:()=>u(m.value),className:`w-full text-left px-2 py-2 rounded text-sm transition-colors ${m.value===e?`${m.color} cursor-default`:"hover:bg-gray-100 text-gray-700"}`,disabled:m.value===e,children:[s.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${m.color}`,children:m.label}),m.value===e&&s.jsx("span",{className:"text-xs text-gray-500 ml-2",children:"(atual)"})]},m.value))]})})]})]})},yy=({proposal:e,onUpdateProbability:t,onUpdateProposal:r,readOnly:n=!1})=>{const{data:a}=J("employees"),i=Array.isArray(a)?a:[],[o,l]=M.useState(!1),[c,d]=M.useState(!1),[u,m]=M.useState(!1),[h,g]=M.useState(!1),[b,y]=M.useState(e.monthlyValue.toString()),[k,x]=M.useState(!1),[f,p]=M.useState(_r(e.createdAt)),S=N=>{if(!N)return{level:"Não avaliada",color:"text-gray-500",bgColor:"bg-gray-100 border-gray-300"};const _=Object.values(N).reduce((T,I)=>T+I,0);return _<12?{level:"Baixa",color:"text-red-600",bgColor:"bg-red-100 border-red-300"}:_<=18?{level:"Média",color:"text-yellow-600",bgColor:"bg-yellow-100 border-yellow-300"}:{level:"Alta",color:"text-green-600",bgColor:"bg-green-100 border-green-300"}};i.find(N=>N.id===e.closerId),e.sdrId&&i.find(N=>N.id===e.sdrId);const C=S(e.probabilityScores),v=N=>{const _=Object.values(N).reduce((I,P)=>I+P,0);console.log("Atualizando probabilidade no card:",{scores:N,total:_}),t&&t(e.id,N);const T=_<12?"Baixa":_<=18?"Média":"Alta";alert(`✅ Avaliação salva com sucesso!

📊 Pontuação: ${_}/24
🎯 Probabilidade: ${T}

🔄 Atualizando toda a tela...`)},j=N=>{r&&r(N)},A=()=>{g(!0),y(e.monthlyValue.toString())},L=()=>{const N=parseFloat(b)||0;if(N!==e.monthlyValue){const _=N*e.months;let T=.4;N>=1e5?T=1.2:N>=5e4&&(T=.8);const I=_*T/100,P={...e,monthlyValue:N,totalValue:_,commission:I,commissionRate:T,updatedAt:new Date().toISOString()};j(P)}g(!1)},E=()=>{g(!1),y(e.monthlyValue.toString())},w=()=>{x(!0),p(e.createdAt.split("T")[0])},O=()=>{const N=f;if(N!==_r(e.createdAt)){const _={...e,createdAt:N,updatedAt:new Date().toISOString()};j(_)}x(!1)},U=()=>{x(!1),p(_r(e.createdAt))};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow",children:[s.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-5 gap-1 md:gap-4 mb-2 md:mb-4 text-xs md:text-sm font-medium text-gray-500 border-b border-gray-100 pb-1 md:pb-2",children:[s.jsx("div",{className:"text-xs md:text-sm",children:"Cliente"}),s.jsx("div",{className:"text-center text-xs md:text-sm hidden md:block",children:"Data de Inclusão"}),s.jsx("div",{className:"text-center text-xs md:text-sm",children:"Valor Mensal"}),s.jsx("div",{className:"text-center text-xs md:text-sm",children:"Probabilidade"}),s.jsx("div",{className:"text-center text-xs md:text-sm",children:"Status"})]}),s.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-5 gap-1 md:gap-4 items-center",children:[s.jsx("div",{children:s.jsx("button",{onClick:()=>d(!0),className:"text-xs md:text-lg font-semibold text-blue-600 hover:text-blue-800 hover:underline text-left break-words whitespace-normal md:truncate leading-tight",children:e.client})}),s.jsx("div",{className:"text-center hidden md:block",children:k?s.jsxs("div",{className:"flex items-center justify-center space-x-1",children:[s.jsx("input",{type:"date",value:f,onChange:N=>p(N.target.value),className:"w-32 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 text-center",autoFocus:!0,onKeyDown:N=>{N.key==="Enter"&&O(),N.key==="Escape"&&U()}}),s.jsx("button",{onClick:O,className:"p-1 text-green-600 hover:text-green-800",title:"Salvar",children:s.jsx(hs,{className:"w-3 h-3"})}),s.jsx("button",{onClick:U,className:"p-1 text-red-600 hover:text-red-800",title:"Cancelar",children:s.jsx(ne,{className:"w-3 h-3"})})]}):s.jsxs("button",{onClick:w,className:"group flex items-center justify-center space-x-1 hover:bg-blue-50 rounded px-2 py-1 transition-colors",title:"Clique para editar",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900",children:st(e.createdAt)}),s.jsx(Zt,{className:"w-3 h-3 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity"})]})}),s.jsx("div",{className:"text-center",children:h&&!n?s.jsxs("div",{className:"flex items-center justify-center space-x-1",children:[s.jsx("input",{type:"number",value:b,onChange:N=>y(N.target.value),className:"w-12 md:w-24 px-1 md:px-2 py-1 text-xs md:text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 text-center",autoFocus:!0,onKeyDown:N=>{N.key==="Enter"&&L(),N.key==="Escape"&&E()}}),s.jsx("button",{onClick:L,className:"p-0.5 md:p-1 text-green-600 hover:text-green-800",title:"Salvar",children:s.jsx(hs,{className:"w-2.5 md:w-3 h-2.5 md:h-3"})}),s.jsx("button",{onClick:E,className:"p-0.5 md:p-1 text-red-600 hover:text-red-800",title:"Cancelar",children:s.jsx(ne,{className:"w-2.5 md:w-3 h-2.5 md:h-3"})})]}):s.jsxs("button",{onClick:A,className:`group flex items-center justify-center space-x-1 rounded px-1 md:px-2 py-1 transition-colors ${n?"cursor-default":"hover:bg-blue-50"}`,title:"Clique para editar",disabled:n,children:[s.jsx("span",{className:"text-xs md:text-sm font-bold text-gray-900 truncate",children:D(e.monthlyValue)}),!n&&s.jsx(Zt,{className:"w-2.5 md:w-3 h-2.5 md:h-3 text-gray-400 opacity-0 group-hover:opacity-100 transition-opacity"})]})}),s.jsx("div",{className:"text-center",children:s.jsx("button",{onClick:()=>!n&&l(!0),className:`inline-flex px-1 md:px-3 py-0.5 md:py-1 rounded-full text-xs md:text-sm font-medium border hover:opacity-80 transition-opacity ${C.bgColor} ${C.color} border-current`,title:n?"Somente leitura":"Clique para avaliar probabilidade",disabled:n,children:C.level})}),s.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-center space-y-1 md:space-y-0 md:space-x-3",children:[s.jsx(py,{currentStatus:e.status,proposalId:e.id,proposalClient:e.client,onStatusChange:r?()=>{window.location.reload()}:()=>{},readOnly:n}),n?s.jsx("span",{className:"px-2 md:px-3 py-1 bg-gray-300 text-gray-500 rounded-lg text-xs font-medium",children:"Somente Leitura"}):s.jsx("button",{onClick:()=>m(!0),className:"px-1 md:px-3 py-0.5 md:py-1 bg-blue-600 text-white rounded-lg text-xs font-medium hover:bg-blue-700 transition-colors",children:"Editar"})]})]})]}),!n&&s.jsx(Oh,{isOpen:o,onClose:()=>l(!1),onSave:v,currentScores:e.probabilityScores,clientName:e.client}),s.jsx(fy,{proposal:e,isOpen:c,onClose:()=>d(!1),onEdit:n?void 0:()=>{d(!1),m(!0)},onUpdateProbability:n?void 0:v,readOnly:n}),!n&&s.jsx(gy,{proposal:e,isOpen:u,onClose:()=>m(!1),onSave:j,onDelete:()=>{window.location.reload()}})]})},vy=({onSubmit:e,onCancel:t})=>{const{data:r=[]}=J("employees"),[n,a]=M.useState({client:"",monthlyValue:0,months:12,status:"Proposta",closerId:"",sdrId:"",proposalDate:Mt(),closingDate:"",lostDate:"",lostReason:"Fechou com concorrente"}),i=(m,h)=>({commission:m*h*.4/100,rate:.4}),o=m=>{m.preventDefault(),n.status==="Fechado"&&!n.closingDate&&(n.closingDate=Mt(),console.log("Auto-setting closing_date to current date for new proposal:",n.closingDate));const h=n.monthlyValue*n.months,{commission:g,rate:b}=i(n.monthlyValue,n.months),y={...n,totalValue:h,commission:g,commissionRate:b,sdrId:n.sdrId||void 0,closingDate:n.status==="Fechado"?ws(n.closingDate):null,lostDate:n.status==="Perdido"?ws(n.lostDate):null,lostReason:n.status==="Perdido"?n.lostReason:null,proposalDate:ws(n.proposalDate)};console.log("Enviando dados da proposta:",y),e(y)},l=r.filter(m=>m.role==="Closer"),c=r.filter(m=>m.role==="SDR"),{commission:d,rate:u}=i(n.monthlyValue,n.months);return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Nova Proposta"}),s.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(ne,{className:"w-5 h-5 text-gray-500"})})]}),s.jsxs("form",{onSubmit:o,className:"p-6 space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cliente"}),s.jsx("input",{type:"text",value:n.client,onChange:m=>a({...n,client:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data da Proposta"}),s.jsx("input",{type:"date",value:n.proposalDate,onChange:m=>a({...n,proposalDate:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",required:!0,max:Mt()}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Data em que a proposta foi criada (pode ser retroativa)"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Valor Mensal (R$)"}),s.jsx("input",{type:"number",value:n.monthlyValue,onChange:m=>a({...n,monthlyValue:Number(m.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",required:!0,min:"0",step:"0.01"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Meses"}),s.jsx("input",{type:"number",value:n.months,onChange:m=>a({...n,months:Number(m.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",required:!0,min:"1"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),s.jsxs("select",{value:n.status,onChange:m=>a({...n,status:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",children:[s.jsx("option",{value:"Proposta",children:"Proposta"}),s.jsx("option",{value:"Negociação",children:"Negociação"}),s.jsx("option",{value:"Fechado",children:"Fechado"}),s.jsx("option",{value:"Perdido",children:"Perdido"})]})]}),n.status==="Fechado"&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data de Fechamento"}),s.jsx("input",{type:"date",value:n.closingDate,onChange:m=>a({...n,closingDate:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",required:n.status==="Fechado",max:Mt()}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Data em que o contrato foi efetivamente fechado"})]}),n.status==="Perdido"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data da Perda"}),s.jsx("input",{type:"date",value:n.lostDate,onChange:m=>a({...n,lostDate:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",required:n.status==="Perdido",max:Mt()}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Data em que perdemos a proposta"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Motivo da Perda"}),s.jsxs("select",{value:n.lostReason,onChange:m=>a({...n,lostReason:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",required:n.status==="Perdido",children:[s.jsx("option",{value:"Fechou com concorrente",children:"Fechou com concorrente"}),s.jsx("option",{value:"Fechou com o atual",children:"Fechou com o atual"}),s.jsx("option",{value:"Desistiu da contratação",children:"Desistiu da contratação"})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Selecione o motivo pelo qual perdemos a proposta"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Closer"}),s.jsxs("select",{value:n.closerId,onChange:m=>a({...n,closerId:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",required:!0,children:[s.jsx("option",{value:"",children:"Selecione um closer"}),l.map(m=>s.jsx("option",{value:m.id,children:m.name},m.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"SDR (Opcional)"}),s.jsxs("select",{value:n.sdrId,onChange:m=>a({...n,sdrId:m.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",children:[s.jsx("option",{value:"",children:"Selecione um SDR"}),c.map(m=>s.jsx("option",{value:m.id,children:m.name},m.id))]})]})]}),s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[s.jsx("h3",{className:"text-sm font-medium text-green-800 mb-2",children:"Prévia da Comissão"}),s.jsx("div",{className:"text-xs text-green-700 mb-2",children:"* Taxa final será definida pelo volume total fechado no mês"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-green-600",children:"Valor Total:"}),s.jsx("span",{className:"font-bold ml-2",children:D(n.monthlyValue*n.months)})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-green-600",children:"Taxa Base:"}),s.jsxs("span",{className:"font-bold ml-2",children:[u,"%"]})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("span",{className:"text-green-600",children:"Comissão Base:"}),s.jsx("span",{className:"font-bold ml-2 text-lg",children:D(d)})]})]}),s.jsxs("div",{className:"mt-3 p-2 bg-green-100 rounded text-xs text-green-800",children:[s.jsx("strong",{children:"Escala Real:"})," 0,4% (até R$ 600k) • 0,8% (R$ 600k-1,2mi) • 1,2% (acima R$ 1,2mi)"]})]}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsx("h3",{className:"text-sm font-medium text-blue-800 mb-2",children:"Avaliação de Probabilidade"}),s.jsx("p",{className:"text-sm text-blue-600",children:"Após criar a proposta, você poderá avaliar a probabilidade de fechamento clicando no indicador de probabilidade no card da proposta."})]}),s.jsxs("div",{className:"flex space-x-4 pt-4",children:[s.jsx("button",{type:"submit",className:"flex-1 bg-green-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-green-700 transition-colors",children:"Criar Proposta"}),s.jsx("button",{type:"button",onClick:t,className:"flex-1 border border-gray-300 text-gray-700 py-3 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Cancelar"})]})]})]})})},Bd=M.memo(({onDataChange:e})=>{const{selectedYear:t}=Tt(),{canEdit:r}=Js(),n=r("proposals"),{data:a=[],loading:i,refetch:o}=J("proposals",{select:"id, client, monthly_value, months, total_value, status, commission, commission_rate, closer_id, sdr_id, closing_date, lost_date, lost_reason, created_at, updated_at",orderBy:{column:"created_at",ascending:!1}}),{data:l=[]}=J("probability_scores",{select:"proposal_id, economic_buyer, metrics, decision_criteria, decision_process, identify_pain, champion, competition, engagement"}),c=M.useMemo(()=>a.map(_=>({id:_.id,client:_.client,monthlyValue:_.monthly_value,months:_.months,totalValue:_.total_value,status:_.status,commission:_.commission,commissionRate:_.commission_rate,closerId:_.closer_id||"",sdrId:_.sdr_id||void 0,closingDate:_.closing_date||void 0,lostDate:_.lost_date||void 0,lostReason:_.lost_reason||void 0,probabilityScores:(()=>{const T=l.find(I=>I.proposal_id===_.id);return T?{economicBuyer:T.economic_buyer,metrics:T.metrics,decisionCriteria:T.decision_criteria,decisionProcess:T.decision_process,identifyPain:T.identify_pain,champion:T.champion,competition:T.competition,engagement:T.engagement}:void 0})(),createdAt:_.created_at,updatedAt:_.updated_at})).filter(_=>_.status==="Proposta"||_.status==="Negociação"?!0:_.status==="Fechado"&&_.closingDate?new Date(_.closingDate).getFullYear()===t:_.status==="Perdido"&&_.lostDate?new Date(_.lostDate).getFullYear()===t:new Date(_.createdAt).getFullYear()===t),[a,l,t]),[d,u]=M.useState("all"),[m,h]=M.useState(["all"]),[g,b]=M.useState(!1),[y,k]=M.useState(!1),[x,f]=M.useState(""),[p,S]=M.useState("status"),[C,v]=M.useState("asc"),j=M.useMemo(()=>{const _=new Set;return c.forEach(T=>{const I=new Date(T.createdAt),P=`${I.getFullYear()}-${String(I.getMonth()+1).padStart(2,"0")}`;_.add(P)}),Array.from(_).sort().reverse()},[c]),A=M.useCallback(_=>{const[T,I]=_.split("-");return new Date(parseInt(T),parseInt(I)-1).toLocaleDateString("pt-BR",{month:"long",year:"numeric"})},[]),L=M.useCallback(_=>{_==="all"?m.includes("all")||m.length===j.length?h([]):h(["all"]):h(T=>{let I=T.filter(P=>P!=="all");return T.includes(_)?I=I.filter(P=>P!==_):I=[...I,_],I.length===j.length?["all"]:I})},[j]),E=M.useMemo(()=>c.filter(T=>{const I=d==="all"||T.status===d,P=x===""||T.client.toLowerCase().includes(x.toLowerCase());if(m.includes("all")||m.length===0)return I&&P;const z=new Date(T.createdAt),R=`${z.getFullYear()}-${String(z.getMonth()+1).padStart(2,"0")}`,$=m.includes(R);return I&&P&&$}).sort((T,I)=>{let P,z;switch(p){case"client":P=T.client.toLowerCase(),z=I.client.toLowerCase();break;case"created_at":P=new Date(T.createdAt).getTime(),z=new Date(I.createdAt).getTime();break;case"status":const R={"Análise de contrato":1,Negociação:2,Proposta:3,Fechado:4,Perdido:5};P=R[T.status],z=R[I.status];break;case"monthly_value":P=T.monthlyValue,z=I.monthlyValue;break;default:P=new Date(T.createdAt).getTime(),z=new Date(I.createdAt).getTime()}return C==="asc"?P>z?1:P<z?-1:0:P<z?1:P>z?-1:0}),[c,d,x,m,p,C]),w=M.useMemo(()=>{const _=E.reduce((q,Y)=>q+Y.totalValue,0),T=c.filter(q=>q.status==="Proposta"||q.status==="Negociação"),P=(()=>{const q={};return T.forEach(Y=>{const F=Number(Y.commission||0);Y.closerId&&(q[Y.closerId]||(q[Y.closerId]={closerCommission:0,sdrCommission:0}),q[Y.closerId].closerCommission+=F),Y.sdrId&&(q[Y.sdrId]||(q[Y.sdrId]={closerCommission:0,sdrCommission:0}),q[Y.sdrId].sdrCommission+=F)}),Object.values(q).reduce((Y,F)=>Y+F.closerCommission+F.sdrCommission,0)})(),z=E.filter(q=>q.probabilityScores);let R=0,$="Não avaliada";if(z.length>0){const Y=z.reduce((F,G)=>{const W=Object.values(G.probabilityScores).reduce((ee,X)=>ee+X,0);return F+W},0)/z.length;R=Math.round(Y/24*100),Y<12?$="Baixa":Y<=18?$="Média":$="Alta"}return{totalValue:_,totalPossibleCommission:P,averageProbability:R,averageProbabilityLabel:$,evaluatedCount:z.length}},[E,c]),O=M.useCallback(_=>{(async()=>{try{const I=new Date(_.proposalDate).toISOString(),P={client:_.client,monthly_value:_.monthlyValue,months:_.months,total_value:_.totalValue,status:_.status,commission:_.commission,commission_rate:_.commissionRate,closer_id:_.closerId,sdr_id:_.sdrId||null,closing_date:_.closingDate||null,lost_date:_.lostDate||null,lost_reason:_.lostReason||null,created_at:I,updated_at:I};console.log("Dados sendo inseridos no Supabase:",P);const{data:z,error:R}=await ie.from("proposals").insert(P).select().single();if(R){console.error("Error inserting proposal:",R),alert(`Erro ao criar proposta: ${R.message}`);return}console.log("Proposal created successfully:",z),await o(),k(!1)}catch(I){console.error("Unexpected error:",I),alert("Erro inesperado ao criar proposta. Tente novamente.")}})()},[o]),U=M.useCallback((_,T)=>{(async()=>{try{const P=Object.values(T).reduce((Y,F)=>Y+F,0);ht("probability_scores"),ht("proposals");const{data:z,error:R}=await ie.from("probability_scores").select("id").eq("proposal_id",_).maybeSingle();if(R&&R.code!=="PGRST116")throw R;const $={economic_buyer:T.economicBuyer,metrics:T.metrics,decision_criteria:T.decisionCriteria,decision_process:T.decisionProcess,identify_pain:T.identifyPain,champion:T.champion,competition:T.competition,engagement:T.engagement,updated_at:new Date().toISOString()};let q;if(z){const{data:Y,error:F}=await ie.from("probability_scores").update($).eq("proposal_id",_).select().single();q={data:Y,error:F}}else{const{data:Y,error:F}=await ie.from("probability_scores").insert({proposal_id:_,...$}).select().single();q={data:Y,error:F}}if(q.error){alert(`Erro ao atualizar probabilidade: ${q.error.message}`);return}ht("probability_scores"),ht("proposals"),await o(),setTimeout(()=>{window.location.reload()},500)}catch(P){alert(`Erro inesperado ao atualizar probabilidade: ${P instanceof Error?P.message:"Tente novamente."}`)}})()},[o]),N=M.useCallback(_=>{(async()=>{try{console.log("Updating proposal:",_.id,"with data:",_);const I={client:_.client,monthly_value:_.monthlyValue,months:_.months,total_value:_.totalValue,status:_.status,commission:_.commission,commission_rate:_.commissionRate,closer_id:_.closerId,sdr_id:_.sdrId||null,closing_date:_.closingDate||null,lost_date:_.lostDate||null,lost_reason:_.lostReason||null,updated_at:new Date().toISOString()};console.log("Sending to Supabase:",I);const{data:P,error:z}=await ie.from("proposals").update(I).eq("id",_.id).select().single();if(z){console.error("Supabase update error:",z),alert(`Erro ao atualizar proposta: ${z.message}`);return}console.log("Update successful:",P),ht("proposals"),ht("probability_scores"),await o(),e&&e(),setTimeout(()=>{console.log("Proposal update completed")},100)}catch(I){console.error("Unexpected error updating proposal:",I),alert("Erro inesperado ao atualizar proposta.")}})()},[o,e]);return i?s.jsx("div",{className:"flex items-center justify-center py-12 min-h-screen",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),s.jsx("div",{className:"text-lg text-gray-700",children:"Carregando Propostas..."})]})}):s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Propostas ",t]}),s.jsxs("p",{className:"text-gray-600",children:["Gerencie suas propostas e acompanhe comissões para ",t,(d==="Proposta"||d==="Negociação"||d==="all")&&" (propostas em aberto de todos os anos)"]})]}),n?s.jsxs("button",{onClick:()=>k(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:bg-green-700 transition-colors",children:[s.jsx(ze,{className:"w-4 h-4"}),s.jsx("span",{children:"Nova Proposta"})]}):s.jsxs("div",{className:"bg-gray-100 text-gray-500 px-4 py-2 rounded-lg flex items-center space-x-2",children:[s.jsx(ze,{className:"w-4 h-4"}),s.jsx("span",{children:"Modo Somente Leitura"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Valor Total"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:D(w.totalValue)})]}),s.jsx("div",{className:"w-12 h-12 rounded-lg bg-blue-500 flex items-center justify-center",children:s.jsx(De,{className:"w-6 h-6 text-white"})})]})}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Comissão Total Possível"}),s.jsx("p",{className:"text-2xl font-bold text-green-600",children:D(w.totalPossibleCommission)})]}),s.jsx("div",{className:"w-12 h-12 rounded-lg bg-green-500 flex items-center justify-center",children:s.jsx(ot,{className:"w-6 h-6 text-white"})})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Propostas em andamento (Proposta e Negociação)"})]}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Propostas"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:c.length})]}),s.jsx("div",{className:"w-12 h-12 rounded-lg bg-purple-500 flex items-center justify-center",children:s.jsx(Pe,{className:"w-6 h-6 text-white"})})]})}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Avaliação Média"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:[w.averageProbability,"%"]}),s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${w.averageProbabilityLabel==="Alta"?"bg-green-100 text-green-800":w.averageProbabilityLabel==="Média"?"bg-yellow-100 text-yellow-800":w.averageProbabilityLabel==="Baixa"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:w.averageProbabilityLabel})]})]}),s.jsx("div",{className:"w-12 h-12 rounded-lg bg-orange-500 flex items-center justify-center",children:s.jsx(Ks,{className:"w-6 h-6 text-white"})})]}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Baseado em ",w.evaluatedCount," avaliações"]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"flex-1 max-w-md",children:s.jsxs("div",{className:"relative",children:[s.jsx(_d,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Buscar por nome do cliente...",value:x,onChange:_=>f(_.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500"}),x&&s.jsx("button",{onClick:()=>f(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:"×"})]})}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(pf,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Ordenar por:"}),s.jsxs("select",{value:p,onChange:_=>S(_.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500",children:[s.jsx("option",{value:"created_at",children:"Data de Inclusão"}),s.jsx("option",{value:"client",children:"Nome do Cliente"}),s.jsx("option",{value:"status",children:"Situação"}),s.jsx("option",{value:"monthly_value",children:"Valor Mensal"})]}),s.jsx("button",{onClick:()=>v(C==="asc"?"desc":"asc"),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm hover:bg-gray-50 transition-colors",title:`Ordenação ${C==="asc"?"crescente":"decrescente"}`,children:C==="asc"?"↑":"↓"})]})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(ah,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Filtrar por status:"})]}),s.jsxs("select",{value:d,onChange:_=>u(_.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500",children:[s.jsx("option",{value:"all",children:"Todas"}),s.jsx("option",{value:"Proposta",children:"Proposta"}),s.jsx("option",{value:"Negociação",children:"Negociação"}),s.jsx("option",{value:"Fechado",children:"Fechado"}),s.jsx("option",{value:"Perdido",children:"Perdido"})]}),s.jsxs("div",{className:"relative flex items-center space-x-2",children:[s.jsx(Pe,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Mês de inclusão:"}),s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:()=>b(!g),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500 min-w-[200px] bg-white flex items-center justify-between",children:[s.jsx("span",{children:m.includes("all")||m.length===0?"📅 Todos os meses":m.length===1?A(m[0]):`${m.length} meses selecionados`}),s.jsx(ac,{className:`w-4 h-4 transition-transform ${g?"rotate-180":""}`})]}),g&&s.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-10 max-h-60 overflow-y-auto",children:[s.jsxs("label",{className:"flex items-center px-3 py-2 hover:bg-gray-50 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:m.includes("all")||m.length===j.length,onChange:()=>L("all"),className:"mr-3 rounded border-gray-300 text-green-600 focus:ring-green-500"}),s.jsx(Pe,{className:"w-4 h-4 mr-2 text-gray-400"}),s.jsx("span",{className:"text-sm",children:"Todos os meses"}),(m.includes("all")||m.length===j.length)&&s.jsx(Nd,{className:"w-4 h-4 ml-auto text-green-600"})]}),s.jsx("div",{className:"border-t border-gray-200"}),j.map(_=>s.jsxs("label",{className:"flex items-center px-3 py-2 hover:bg-gray-50 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:m.includes("all")||m.includes(_),onChange:()=>L(_),className:"mr-3 rounded border-gray-300 text-green-600 focus:ring-green-500"}),s.jsx("span",{className:"text-sm flex-1",children:A(_)}),(m.includes("all")||m.includes(_))&&s.jsx(Nd,{className:"w-4 h-4 text-green-600"})]},_))]})]})]}),s.jsxs("div",{className:"text-sm text-gray-500 bg-gray-50 px-3 py-2 rounded-lg",children:["Mostrando ",E.length," de ",c.length," propostas",x&&` • Busca: "${x}"`,m.includes("all")||m.length===0?" (todos os meses)":m.length===1?` (${A(m[0])})`:` (${m.length} meses selecionados)`,` • Ano: ${t}`,` • Ordenado por ${p==="created_at"?"Data de Inclusão":p==="client"?"Nome do Cliente":p==="status"?"Situação":"Valor Mensal"} (${C==="asc"?"crescente":"decrescente"})`]})]})]}),g&&s.jsx("div",{className:"fixed inset-0 z-5",onClick:()=>b(!1)}),s.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[E.map(_=>s.jsx(yy,{proposal:_,onUpdateProbability:n?U:void 0,onUpdateProposal:n?N:void 0,readOnly:!n},_.id)),E.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(_d,{className:"w-8 h-8 text-gray-400"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:x?"Nenhuma proposta encontrada":"Nenhuma proposta"}),s.jsx("p",{className:"text-gray-500",children:x?`Não encontramos propostas com "${x}". Tente outro termo de busca.`:'Clique em "Nova Proposta" para começar.'}),x&&s.jsx("button",{onClick:()=>f(""),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Limpar Busca"})]})]}),y&&n&&s.jsx(vy,{onSubmit:O,onCancel:()=>k(!1)})]})}),hn=[{rate:.4,minValue:0,maxValue:6e5,label:"Meta Base",color:"text-red-600",bgColor:"bg-red-100"},{rate:.8,minValue:6e5,maxValue:12e5,label:"Supermeta",color:"text-yellow-600",bgColor:"bg-yellow-100"},{rate:1.2,minValue:12e5,maxValue:null,label:"Megameta",color:"text-green-600",bgColor:"bg-green-100"}],Ih=e=>e<=6e5?.4:e<=12e5?.8:1.2,by=e=>hn.find(t=>e>=t.minValue&&(t.maxValue===null||e<=t.maxValue))||hn[0],jy=(e,t)=>e*t/100,Lh=(e,t,r,n)=>{const a=n||new Date().getFullYear(),i={};for(let l=1;l<=12;l++){const c=`${a}-${l.toString().padStart(2,"0")}`;i[c]={contracts:[],totalValue:0,commission:0}}return e.filter(l=>!(l.status!=="Fechado"||r==="closer"&&l.closer_id!==t||r==="sdr"&&l.sdr_id!==t||(l.closing_date?new Date(l.closing_date):new Date(l.created_at)).getFullYear()!==a)).forEach(l=>{const c=l.closing_date?new Date(l.closing_date):new Date(l.created_at),d=`${a}-${(c.getMonth()+1).toString().padStart(2,"0")}`;if(i[d]){i[d].contracts.push(l),i[d].totalValue+=l.total_value||0;const u=Ih(l.total_value||0);i[d].commission+=jy(l.total_value||0,u)}}),i},Ny=(e,t,r)=>{const n=new Date().getMonth(),a=new Date().getFullYear();return e.filter(i=>{if(i.status!=="Fechado"||r==="closer"&&i.closer_id!==t||r==="sdr"&&i.sdr_id!==t)return!1;const o=i.closing_date?new Date(i.closing_date):new Date(i.created_at);return o.getMonth()===n&&o.getFullYear()===a}).reduce((i,o)=>i+(o.total_value||0),0)},wy=(e,t,r)=>e.filter(n=>!(n.status!=="Proposta"&&n.status!=="Negociação"||r==="closer"&&n.closer_id!==t||r==="sdr"&&n.sdr_id!==t)),_y=e=>{const t=Ih(e),r=by(e),n=r.maxValue?Math.min(e/r.maxValue*100,100):100;let a=null,i=0;return e<6e5?(a=6e5,i=6e5-e):e<12e5&&(a=12e5,i=12e5-e),{currentRate:t,currentTier:r,progressPercentage:n,nextMilestone:a,remainingToNext:i,hasAchievement:e>=6e5}},ky=({employeeId:e,employeeRole:t,proposals:r,employeeName:n,selectedYear:a})=>{const i=Lh(r,e,t,a),o=["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],l=Math.max(...Object.values(i).map(d=>d.commission),1e3),c=Object.values(i).reduce((d,u)=>d+u.commission,0);return s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center space-x-2",children:[s.jsx(rh,{className:"w-5 h-5 text-blue-600"}),s.jsxs("span",{children:["Comissões Mensais - ",n]})]}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Comissões efetivas recebidas por mês em ",a]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:D(c)}),s.jsx("div",{className:"text-sm text-gray-500",children:"Total Anual"})]})]}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"flex items-end justify-between space-x-2 h-64 mb-4",children:o.map((d,u)=>{const m=`${a}-${(u+1).toString().padStart(2,"0")}`,h=i[m],g=l>0?h.commission/l*100:0;return s.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[s.jsx("div",{className:"relative w-full h-48 flex items-end",children:s.jsx("div",{className:"w-full bg-gradient-to-t from-blue-500 to-blue-400 rounded-t hover:from-blue-600 hover:to-blue-500 transition-all cursor-pointer group",style:{height:`${Math.max(g,2)}%`},children:s.jsx("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-10",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"font-medium",children:D(h.commission)}),s.jsxs("div",{children:[h.contracts.length," contrato",h.contracts.length!==1?"s":""]})]})})})}),s.jsx("div",{className:"text-xs text-gray-600 mt-2 font-medium",children:d}),s.jsx("div",{className:"text-xs text-gray-500",children:h.contracts.length>0?`${h.contracts.length}`:"-"})]},d)})}),s.jsxs("div",{className:"absolute left-0 top-0 h-48 flex flex-col justify-between text-xs text-gray-500 -ml-16",children:[s.jsx("span",{children:D(l)}),s.jsx("span",{children:D(l*.75)}),s.jsx("span",{children:D(l*.5)}),s.jsx("span",{children:D(l*.25)}),s.jsx("span",{children:"R$ 0,00"})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4 pt-4 border-t border-gray-200",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-xl font-bold text-blue-600",children:Object.values(i).filter(d=>d.contracts.length>0).length}),s.jsx("div",{className:"text-sm text-gray-600",children:"Meses com Comissão"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-xl font-bold text-purple-600",children:Object.values(i).reduce((d,u)=>d+u.contracts.length,0)}),s.jsx("div",{className:"text-sm text-gray-600",children:"Contratos Fechados"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-xl font-bold text-green-600",children:c>0?D(c/12):"R$ 0,00"}),s.jsx("div",{className:"text-sm text-gray-600",children:"Média Mensal"})]})]})]})},Cy=({employeeId:e,employeeRole:t,proposals:r,employeeName:n,selectedYear:a})=>{var h;const[i,o]=M.useState(new Date().getMonth()+1),l=Lh(r,e,t,a),c=[{value:1,label:"Janeiro"},{value:2,label:"Fevereiro"},{value:3,label:"Março"},{value:4,label:"Abril"},{value:5,label:"Maio"},{value:6,label:"Junho"},{value:7,label:"Julho"},{value:8,label:"Agosto"},{value:9,label:"Setembro"},{value:10,label:"Outubro"},{value:11,label:"Novembro"},{value:12,label:"Dezembro"}],d=`${a}-${i.toString().padStart(2,"0")}`,u=l[d],m=((h=c.find(g=>g.value===i))==null?void 0:h.label)||"";return s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center space-x-2",children:[s.jsx(An,{className:"w-5 h-5 text-green-600"}),s.jsxs("span",{children:["Contratos por Mês - ",n]})]}),s.jsx("p",{className:"text-sm text-gray-600",children:"Contratos fechados que geraram comissão"})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Pe,{className:"w-4 h-4 text-gray-500"}),s.jsx("select",{value:i,onChange:g=>o(Number(g.target.value)),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:c.map(g=>s.jsx("option",{value:g.value,children:g.label},g.value))})]})]}),s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h4",{className:"text-lg font-semibold text-blue-900",children:[m," ",a]}),s.jsxs("p",{className:"text-sm text-blue-700",children:[(u==null?void 0:u.contracts.length)||0," contrato",(u==null?void 0:u.contracts.length)!==1?"s":""," fechado",(u==null?void 0:u.contracts.length)!==1?"s":""]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:D((u==null?void 0:u.commission)||0)}),s.jsx("div",{className:"text-sm text-blue-700",children:"Comissão Total"})]})]})}),s.jsx("div",{className:"space-y-4 max-h-80 overflow-y-auto",children:(u==null?void 0:u.contracts.length)>0?u.contracts.map(g=>{g.closing_date?new Date(g.closing_date):new Date(g.created_at);const b=g.total_value*.4/100;return s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-lg font-medium text-gray-900",children:g.client}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Fechado em ",st(g.closing_date||g.created_at)]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-lg font-bold text-green-600",children:D(b)}),s.jsx("div",{className:"text-sm text-gray-500",children:"Comissão"})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Valor Mensal:"}),s.jsx("div",{className:"font-medium",children:D(g.monthly_value)})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Duração:"}),s.jsxs("div",{className:"font-medium",children:[g.months," meses"]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Valor Global:"}),s.jsx("div",{className:"font-medium text-blue-600",children:D(g.total_value)})]})]}),s.jsxs("div",{className:"mt-3 flex items-center justify-between text-xs",children:[s.jsx("span",{className:`px-2 py-1 rounded-full font-medium ${t==="closer"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:t==="closer"?"Como Closer":"Como SDR"}),s.jsxs("span",{className:"text-gray-500",children:["Taxa: 0,4% • ID: ",g.id.substring(0,8)]})]})]},g.id)}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(An,{className:"w-8 h-8 text-gray-400"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Mês sem comissão"}),s.jsxs("p",{className:"text-gray-500",children:["Nenhum contrato foi fechado por ",n," em ",m.toLowerCase()," ",a]})]})})]})},Sy=({employeeId:e,employeeRole:t,proposals:r,employeeName:n,selectedYear:a})=>{const i=wy(r,e,t),o=hn.reduce((l,c)=>{const d=i.reduce((u,m)=>u+m.total_value*c.rate/100,0);return{...l,[c.rate]:d}},{});return s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center space-x-2",children:[s.jsx($e,{className:"w-5 h-5 text-purple-600"}),s.jsxs("span",{children:["Contratos em Aberto - ",n]})]}),s.jsx("p",{className:"text-sm text-gray-600",children:"Potencial de comissão por meta"})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"text-lg font-bold text-purple-600",children:[i.length," contratos"]}),s.jsx("div",{className:"text-sm text-gray-500",children:"Em negociação"})]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:hn.map(l=>s.jsx("div",{className:`${l.bgColor} border-2 border-current rounded-lg p-4`,children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:`text-lg font-bold ${l.color}`,children:D(o[l.rate])}),s.jsxs("div",{className:`text-sm font-medium ${l.color}`,children:[l.label," (",l.rate,"%)"]}),s.jsx("div",{className:"text-xs text-gray-600 mt-1",children:l.maxValue?`${D(l.minValue)} - ${D(l.maxValue)}`:`Acima de ${D(l.minValue)}`})]})},l.rate))}),s.jsx("div",{className:"space-y-4 max-h-80 overflow-y-auto",children:i.length>0?i.map(l=>s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-lg font-medium text-gray-900",children:l.client}),s.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${l.status==="Negociação"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:l.status}),s.jsxs("span",{children:["Criado em ",new Date(l.created_at).toLocaleDateString("pt-BR")]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-lg font-bold text-gray-900",children:D(l.total_value)}),s.jsx("div",{className:"text-sm text-gray-500",children:"Valor Global"})]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mt-4",children:hn.map(c=>{const d=l.total_value*c.rate/100;return s.jsxs("div",{className:`${c.bgColor} rounded-lg p-3 text-center`,children:[s.jsx("div",{className:`text-lg font-bold ${c.color}`,children:D(d)}),s.jsx("div",{className:`text-xs font-medium ${c.color}`,children:c.label}),s.jsxs("div",{className:"text-xs text-gray-600",children:[c.rate,"% do global"]})]},c.rate)})}),s.jsxs("div",{className:"mt-3 flex items-center justify-between text-xs",children:[s.jsx("span",{className:`px-2 py-1 rounded-full font-medium ${t==="closer"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:t==="closer"?"Como Closer":"Como SDR"}),s.jsxs("span",{className:"text-gray-500",children:[l.monthly_value&&D(l.monthly_value)," × ",l.months," meses"]})]})]},l.id)):s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx($e,{className:"w-8 h-8 text-gray-400"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum contrato em aberto"}),s.jsxs("p",{className:"text-gray-500",children:[n," não possui contratos em negociação no momento"]})]})})]})},Ey=({employeeId:e,employeeRole:t,proposals:r,employeeName:n,selectedYear:a})=>{const i=Ny(r,e,t),o=_y(i),l=new Date().toLocaleDateString("pt-BR",{month:"long"}),c=6e5/15e5*100,d=12e5/15e5*100,u=Math.min(i/15e5*100,100),h=i>=12e5?{icon:s.jsx(At,{className:"w-6 h-6 text-yellow-500"}),message:"🚀 MEGAMETA CONQUISTADA! Parabéns!",color:"text-yellow-600",bgColor:"bg-yellow-50 border-yellow-200"}:i>=6e5?{icon:s.jsx(Yt,{className:"w-6 h-6 text-orange-500"}),message:"🎯 SUPERMETA CONQUISTADA! Continue assim!",color:"text-orange-600",bgColor:"bg-orange-50 border-orange-200"}:null;return s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center space-x-2",children:[s.jsx(ot,{className:"w-5 h-5 text-indigo-600"}),s.jsxs("span",{children:["Progresso das Metas - ",n]})]}),s.jsxs("p",{className:"text-sm text-gray-600 capitalize",children:["Performance em ",l," ",a]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:`text-2xl font-bold ${o.currentTier.color}`,children:[o.currentRate,"%"]}),s.jsx("div",{className:"text-sm text-gray-500",children:"Taxa Atual"})]})]}),h&&s.jsx("div",{className:`${h.bgColor} border rounded-lg p-4 mb-6`,children:s.jsxs("div",{className:"flex items-center space-x-3",children:[h.icon,s.jsxs("div",{children:[s.jsx("p",{className:`font-bold ${h.color}`,children:h.message}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Você atingiu ",D(i)," em vendas este mês!"]})]})]})}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Progresso do Mês"}),s.jsx("span",{className:"text-sm text-gray-600",children:D(i)})]}),s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"w-full bg-gray-200 rounded-full h-6",children:[s.jsx("div",{className:`h-6 rounded-full transition-all duration-500 ${i>=12e5?"bg-gradient-to-r from-yellow-400 to-yellow-600":i>=6e5?"bg-gradient-to-r from-orange-400 to-orange-600":"bg-gradient-to-r from-blue-400 to-blue-600"}`,style:{width:`${u}%`}}),s.jsx("div",{className:"absolute top-0 w-1 h-6 bg-red-500 rounded",style:{left:`${c}%`},title:"Meta R$ 600k"}),s.jsx("div",{className:"absolute top-0 w-1 h-6 bg-purple-500 rounded",style:{left:`${d}%`},title:"Meta R$ 1,2M"})]}),s.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-2",children:[s.jsx("span",{children:"R$ 0"}),s.jsx("span",{className:"text-red-600 font-medium",style:{position:"absolute",left:`${c-5}%`},children:"600k"}),s.jsx("span",{className:"text-purple-600 font-medium",style:{position:"absolute",left:`${d-5}%`},children:"1,2M"}),s.jsx("span",{children:"1,5M+"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:`${o.currentTier.bgColor} rounded-lg p-4 text-center`,children:[s.jsx("div",{className:`text-xl font-bold ${o.currentTier.color}`,children:o.currentTier.label}),s.jsx("div",{className:"text-sm text-gray-600",children:"Meta Atual"}),s.jsxs("div",{className:`text-lg font-bold ${o.currentTier.color} mt-1`,children:[o.currentRate,"%"]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[s.jsx("div",{className:"text-xl font-bold text-gray-900",children:D(i)}),s.jsx("div",{className:"text-sm text-gray-600",children:"Vendido no Mês"}),s.jsxs("div",{className:"text-sm text-blue-600 mt-1",children:[o.progressPercentage.toFixed(1),"% da meta atual"]})]}),s.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 text-center",children:[s.jsx("div",{className:"text-xl font-bold text-blue-600",children:o.nextMilestone?D(o.remainingToNext):"🎉"}),s.jsx("div",{className:"text-sm text-gray-600",children:o.nextMilestone?"Falta para próxima meta":"Todas as metas atingidas!"}),o.nextMilestone&&s.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:["Próxima: ",D(o.nextMilestone)]})]})]}),s.jsx("div",{className:"mt-6 p-4 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg border border-blue-200",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-sm font-medium text-blue-900",children:o.nextMilestone?s.jsxs(s.Fragment,{children:["💪 Continue focado! Faltam apenas ",D(o.remainingToNext)," para a próxima meta!"]}):s.jsx(s.Fragment,{children:"🏆 Parabéns! Você atingiu todas as metas disponíveis este mês!"})}),s.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"Cada meta atingida aumenta sua taxa de comissão e reconhecimento!"})]})})]})},Ty=()=>{const{selectedYear:e}=Tt(),{data:t=[],loading:r}=J("employees"),{data:n=[],loading:a}=J("proposals"),[i,o]=M.useState("");if(r||a)return s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});const l=t.filter(b=>b.role!=="Admin");if(l.length===0)return s.jsx("div",{className:"p-6",children:s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Ve,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum funcionário cadastrado"}),s.jsx("p",{className:"text-gray-500",children:'Cadastre funcionários na aba "Configurações" para ver as comissões'})]})});const c=i?l.find(b=>b.id===i):null,d=(c==null?void 0:c.role)==="Closer"?"closer":"sdr",u=n.reduce((b,y)=>b+Number(y.total_value||0),0),m=n.filter(b=>b.status==="Fechado").reduce((b,y)=>b+Number(y.commission||0),0),g=n.filter(b=>b.status==="Proposta"||b.status==="Negociação").reduce((b,y)=>b+Number(y.commission||0),0);return s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Comissões por Funcionário ",e]}),s.jsxs("p",{className:"text-gray-600",children:["Acompanhamento detalhado de comissões individuais para ",e]})]}),s.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 md:space-x-4",children:[s.jsxs("div",{className:"flex items-center space-x-2 md:space-x-2",children:[s.jsx(Ks,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Funcionário:"})]}),s.jsxs("select",{value:i,onChange:b=>o(b.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 w-full md:min-w-[200px]",children:[s.jsx("option",{value:"",children:"Selecione um funcionário"}),l.map(b=>s.jsxs("option",{value:b.id,children:[b.name," - ",b.role]},b.id))]})]})]}),!i&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Valor Total em Propostas"}),s.jsx("p",{className:"text-2xl font-bold text-blue-600",children:D(u)})]}),s.jsx("div",{className:"w-12 h-12 rounded-lg bg-blue-500 flex items-center justify-center",children:s.jsx(De,{className:"w-6 h-6 text-white"})})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Comissões Efetivas"}),s.jsx("p",{className:"text-2xl font-bold text-green-600",children:D(m)}),s.jsx("p",{className:"text-xs text-gray-500",children:"Contratos fechados"})]}),s.jsx("div",{className:"w-12 h-12 rounded-lg bg-green-500 flex items-center justify-center",children:s.jsx(De,{className:"w-6 h-6 text-white"})})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Comissões Possíveis"}),s.jsx("p",{className:"text-2xl font-bold text-purple-600",children:D(g)}),s.jsx("p",{className:"text-xs text-gray-500",children:"Propostas ativas"})]}),s.jsx("div",{className:"w-12 h-12 rounded-lg bg-purple-500 flex items-center justify-center",children:s.jsx(De,{className:"w-6 h-6 text-white"})})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Funcionários"}),s.jsx("p",{className:"text-2xl font-bold text-orange-600",children:l.length}),s.jsx("p",{className:"text-xs text-gray-500",children:"Closers e SDRs"})]}),s.jsx("div",{className:"w-12 h-12 rounded-lg bg-orange-500 flex items-center justify-center",children:s.jsx(Ve,{className:"w-6 h-6 text-white"})})]})})]}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-4",children:"Como usar esta aba"}),s.jsxs("div",{className:"space-y-2 text-blue-800",children:[s.jsxs("p",{children:["• ",s.jsx("strong",{children:"Selecione um funcionário"})," no seletor acima para ver detalhes individuais"]}),s.jsxs("p",{children:["• ",s.jsx("strong",{children:"Gráfico mensal:"})," Visualize as comissões efetivas recebidas mês a mês"]}),s.jsxs("p",{children:["• ",s.jsx("strong",{children:"Contratos por mês:"})," Veja quais contratos geraram comissão em cada período"]}),s.jsxs("p",{children:["• ",s.jsx("strong",{children:"Contratos em aberto:"})," Acompanhe o potencial de comissão com 3 cenários de meta"]}),s.jsxs("p",{children:["• ",s.jsx("strong",{children:"Barra de progresso:"})," Monitore o avanço nas metas mensais e conquistas"]})]})]})]}),c&&s.jsxs("div",{className:"space-y-6",children:[s.jsx(Ey,{employeeId:c.id,employeeRole:d,proposals:n,employeeName:c.name,selectedYear:e}),s.jsx(ky,{employeeId:c.id,employeeRole:d,proposals:n,employeeName:c.name,selectedYear:e}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsx(Cy,{employeeId:c.id,employeeRole:d,proposals:n,employeeName:c.name,selectedYear:e}),s.jsx(Sy,{employeeId:c.id,employeeRole:d,proposals:n,employeeName:c.name,selectedYear:e})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Regras de Comissão"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[s.jsxs("div",{className:"text-center p-4 bg-red-50 border border-red-200 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-red-600",children:"0,4%"}),s.jsx("div",{className:"text-sm text-red-700",children:"Meta Base"}),s.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Até R$ 600.000"})]}),s.jsxs("div",{className:"text-center p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:"0,8%"}),s.jsx("div",{className:"text-sm text-yellow-700",children:"Supermeta"}),s.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"R$ 600k - R$ 1,2mi"})]}),s.jsxs("div",{className:"text-center p-4 bg-green-50 border border-green-200 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:"1,2%"}),s.jsx("div",{className:"text-sm text-green-700",children:"Megameta"}),s.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Acima de R$ 1,2mi"})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"📋 Regras Importantes"}),s.jsxs("ul",{className:"text-sm text-gray-700 space-y-1",children:[s.jsxs("li",{children:["• ",s.jsx("strong",{children:"Taxa única:"})," Closer e SDR recebem a mesma % do valor global"]}),s.jsxs("li",{children:["• ",s.jsx("strong",{children:"Volume mensal:"})," Meta baseada no volume total fechado no mês"]}),s.jsxs("li",{children:["• ",s.jsx("strong",{children:"Aplicação retroativa:"})," Taxa se aplica a todos os contratos do mês"]}),s.jsxs("li",{children:["• ",s.jsx("strong",{children:"Conquistas:"})," Cada meta atingida é uma conquista permanente"]})]})]})]})]})},Py=({weeklyData:e,weeks:t,employees:r})=>{const n=y=>{const k=["#3B82F6","#10B981","#8B5CF6","#F59E0B","#EF4444","#6366F1","#EC4899","#14B8A6"];return k[y%k.length]},a=(y,k)=>{const x=e.find(f=>f.employeeId===y&&f.weekEndingDate===k);return(x==null?void 0:x.totalPoints)||0},i=Math.max(...r.map(y=>Math.max(...t.map(k=>a(y.id,k)))),10),o=y=>new Date(y).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"}),l=800,c=300,d={top:20,right:20,bottom:40,left:60},u=l-d.left-d.right,m=c-d.top-d.bottom,h=y=>y/(t.length-1)*u,g=y=>m-y/i*m,b=y=>t.map((x,f)=>{const p=h(f),S=g(a(y,x));return`${f===0?"M":"L"} ${p} ${S}`}).join(" ");return s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center space-x-2",children:[s.jsx(ot,{className:"w-5 h-5 text-blue-600"}),s.jsx("span",{children:"Evolução Semanal de Pontos"})]}),s.jsx("p",{className:"text-sm text-gray-600",children:"Gráfico de linhas mostrando a evolução de cada funcionário"})]}),s.jsx("div",{className:"flex flex-wrap gap-3",children:r.map((y,k)=>s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:n(k)}}),s.jsx("span",{className:"text-sm text-gray-700",children:y.name})]},y.id))})]}),s.jsx("div",{className:"relative flex justify-center",children:s.jsxs("svg",{width:l,height:c,className:"border border-gray-200 rounded-lg",children:[s.jsx("defs",{children:s.jsx("pattern",{id:"grid",width:"40",height:"30",patternUnits:"userSpaceOnUse",children:s.jsx("path",{d:"M 40 0 L 0 0 0 30",fill:"none",stroke:"#f3f4f6",strokeWidth:"1"})})}),s.jsx("rect",{width:"100%",height:"100%",fill:"url(#grid)"}),s.jsx("line",{x1:d.left,y1:d.top,x2:d.left,y2:c-d.bottom,stroke:"#6b7280",strokeWidth:"2"}),s.jsx("line",{x1:d.left,y1:c-d.bottom,x2:l-d.right,y2:c-d.bottom,stroke:"#6b7280",strokeWidth:"2"}),[0,.25,.5,.75,1].map(y=>{const k=d.top+y*m,x=Math.round(i*(1-y));return s.jsxs("g",{children:[s.jsx("line",{x1:d.left-5,y1:k,x2:d.left,y2:k,stroke:"#6b7280"}),s.jsx("text",{x:d.left-10,y:k+4,textAnchor:"end",fontSize:"12",fill:"#6b7280",children:x})]},y)}),t.map((y,k)=>{const x=d.left+h(k),p=new Date(y).getDate();return[1,5,10,15,20,25,30].includes(p)?s.jsxs("g",{children:[s.jsx("line",{x1:x,y1:c-d.bottom,x2:x,y2:c-d.bottom+5,stroke:"#6b7280"}),s.jsx("text",{x,y:c-d.bottom+20,textAnchor:"middle",fontSize:"10",fill:"#6b7280",transform:`rotate(-45 ${x} ${c-d.bottom+20})`,children:o(y)})]},y):s.jsx("g",{children:s.jsx("line",{x1:x,y1:c-d.bottom,x2:x,y2:c-d.bottom+5,stroke:"#6b7280"})},y)}),r.map((y,k)=>s.jsxs("g",{children:[s.jsx("path",{d:b(y.id),fill:"none",stroke:n(k),strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",transform:`translate(${d.left}, ${d.top})`}),t.map((x,f)=>{const p=a(y.id,x),S=d.left+h(f),C=d.top+g(p);return s.jsx("circle",{cx:S,cy:C,r:"4",fill:n(k),stroke:"white",strokeWidth:"2",className:"hover:r-6 transition-all cursor-pointer",children:s.jsx("title",{children:`${y.name}: ${p} pontos`})},`${y.id}-${x}`)})]},y.id))]})}),s.jsx("div",{className:"mt-4 text-center",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"📈 Gráfico de Linhas:"})," Evolução temporal"]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"🔄 Atualização:"})," Tempo real"]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"💾 Auto-save:"})," Alterações salvas automaticamente"]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4 border-t border-gray-200",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:r.reduce((y,k)=>y+t.reduce((x,f)=>x+a(k.id,f),0),0)}),s.jsx("div",{className:"text-sm text-gray-600",children:"Total de Pontos"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:Math.round(r.reduce((y,k)=>y+t.reduce((x,f)=>x+a(k.id,f),0),0)/r.length)}),s.jsx("div",{className:"text-sm text-gray-600",children:"Média por Pessoa"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-purple-600",children:Math.max(...r.map(y=>t.reduce((k,x)=>k+a(y.id,x),0)))}),s.jsx("div",{className:"text-sm text-gray-600",children:"Maior Pontuação"})]})]})]})},ro=[{id:"pontosEducacao",name:"Pontos de educação",points:1},{id:"propostasApresentadas",name:"Propostas apresentadas",points:1},{id:"contratoAssinado",name:"Contrato assinado",points:1}],no=[{id:"pontosEducacao",name:"Pontos de educação",points:1},{id:"mql",name:"MQL",points:1},{id:"visitasAgendadas",name:"Visitas agendadas",points:1}],Ca=()=>{const e=[],t=new Date,r=t.getDay(),n=r>=5?r-5:r+2,a=new Date(t);a.setDate(t.getDate()-n);for(let i=11;i>=0;i--){const o=new Date(a);o.setDate(a.getDate()-i*7),e.push(o.toISOString().split("T")[0])}return e},Dy=(e,t)=>{const r=Ca(),n=e.map(i=>i.week_ending_date).filter(i=>new Date(i).getFullYear()===t);return[...new Set([...r,...n])].sort((i,o)=>new Date(i).getTime()-new Date(o).getTime())},Ay=()=>{const{selectedYear:e}=Tt(),[t,r]=M.useState([]),[n,a]=M.useState([]),[i,o]=M.useState(!1),[l,c]=M.useState(!1),[d,u]=M.useState(!1),[m,h]=M.useState(""),[g,b]=M.useState(""),{canEdit:y,canView:k}=Js(),x=y("weekly-performance"),f=k("weekly-performance"),{data:p=[],loading:S}=J("employees",{select:"id, name, avatar, role",orderBy:{column:"name",ascending:!0}}),{data:C=[],loading:v,refetch:j}=J("weekly_performance",{select:"employee_id, week_ending_date, tarefas, pontos_educacao, propostas_apresentadas, contrato_assinado, mql, visitas_agendadas, total_points",orderBy:{column:"week_ending_date",ascending:!1}});if(Ns("weekly_performance"),Rn("weekly_performance"),je.useEffect(()=>{if(C.length>=0){const F=Dy(C,e);console.log("🔄 Atualizando weeks com dados do banco:",{baseFridays:Ca().length,datesFromDB:C.filter(G=>new Date(G.week_ending_date).getFullYear()===e).length,totalWeeks:F.length,selectedYear:e,allWeeks:F}),r(F)}},[C,e]),je.useEffect(()=>{if(C.length>0&&p.length>0){const G=C.filter(W=>new Date(W.week_ending_date).getFullYear()===e).map(W=>({employeeId:W.employee_id,weekEndingDate:W.week_ending_date,metrics:{tarefas:W.tarefas||0,pontosEducacao:W.pontos_educacao||0,propostasApresentadas:W.propostas_apresentadas||0,contratoAssinado:W.contrato_assinado||0,mql:W.mql||0,visitasAgendadas:W.visitas_agendadas||0},totalPoints:W.total_points||0}));a(G)}},[C,p,e]),S||v)return s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});const A=p.filter(F=>F.role==="Closer"),L=p.filter(F=>F.role==="SDR");if(A.length===0&&L.length===0)return s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Pe,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum funcionário cadastrado"}),s.jsx("p",{className:"text-gray-500",children:'Cadastre Closers e SDRs na aba "Funcionários" para acompanhar a performance semanal'})]});const E=(F,G)=>(G==="Closer"?ro:no).reduce((ee,X)=>{const le=F[X.id]||0;return ee+le*X.points},0),w=(F,G)=>n.find(W=>W.employeeId===F&&W.weekEndingDate===G)||null,O=(F,G,W,ee,X)=>{a(le=>{const ce=le.findIndex(te=>te.employeeId===F&&te.weekEndingDate===G),dt=X==="Closer"?ro:no,ts={};dt.forEach(te=>{ts[te.id]=0});const V={...ts,...ce>=0?le[ce].metrics:{},[W]:ee},Q={employeeId:F,weekEndingDate:G,metrics:V,totalPoints:E(V,X)};if(ce>=0){const te=[...le];return te[ce]=Q,te}else return[...le,Q]}),o(!0)},U=(F,G,W,ee,X)=>{const le=parseInt(ee)||0;O(F,G,W,le,X),o(!0)},N=async()=>{c(!0);try{console.log("Salvando dados de performance semanal...",n);for(const F of n){const G={employee_id:F.employeeId,week_ending_date:F.weekEndingDate,tarefas:F.metrics.tarefas||0,pontos_educacao:F.metrics.pontosEducacao||0,propostas_apresentadas:F.metrics.propostasApresentadas||0,contrato_assinado:F.metrics.contratoAssinado||0,mql:F.metrics.mql||0,visitas_agendadas:F.metrics.visitasAgendadas||0};console.log("Fazendo upsert para:",F.employeeId,"Data original:",F.weekEndingDate,"Dados:",G);const{error:W}=await ie.from("weekly_performance").upsert(G,{onConflict:"employee_id,week_ending_date"});if(W)throw console.error("Erro ao fazer upsert da performance:",W),W}await j(),console.log("Todos os dados salvos com sucesso!"),c(!1),o(!1),alert("Todas as alterações foram salvas com sucesso!")}catch(F){console.error("Erro ao salvar dados:",F),c(!1);let G="Erro desconhecido ao salvar dados.";(F instanceof Error||typeof F=="object"&&F!==null&&"message"in F)&&(G=F.message),alert(`Erro ao salvar dados: ${G}`)}},_=()=>{confirm("Tem certeza que deseja descartar todas as alterações não salvas?")&&(j(),o(!1))},T=()=>{u(!0),h(""),b("")},I=()=>{if(!m){b("Por favor, selecione uma data");return}if(!oy(m)){b("Data inválida");return}const F=new Date(m);if(t.includes(m)){b("Esta data já existe na tabela");return}if(F.getFullYear()!==e){b(`Por favor, selecione uma data de ${e}`);return}const G=[...t,m].filter((W,ee,X)=>X.indexOf(W)===ee).sort((W,ee)=>new Date(W).getTime()-new Date(ee).getTime());r(G),u(!1),h(""),b(""),console.log("📅 Nova data adicionada EXATAMENTE como inserida:",{dataInserida:m,dataFormatada:st(m),totalDatas:G.length,proximaAcao:"Inserir dados e salvar"}),alert(`✅ Data adicionada: ${st(m)}

📋 PRÓXIMOS PASSOS:
1. Insira os dados de performance
2. Clique em "Salvar Todas as Alterações"
3. A data ${m} será salva EXATAMENTE como inserida

⚠️ GARANTIA: Sem alteração automática de datas!`)},P=F=>{const G=`Tem certeza que deseja remover o dia ${new Date(F).toLocaleDateString("pt-BR")}?

Esta ação irá:
• Remover a coluna da tabela
• Manter os dados no banco (não serão excluídos)
• Ocultar o dia da visualização atual

Para excluir permanentemente os dados, use a função de exclusão no banco.`;if(confirm(G)){const W=t.filter(X=>X!==F);r(W);const ee=n.filter(X=>X.weekEndingDate!==F);a(ee),alert("Dia removido da visualização. Os dados no banco foram preservados.")}},z=F=>st(F,"pt-BR").split("/").slice(0,2).join("/"),R=F=>{const G=new Date().getMonth(),W=e;return n.filter(ee=>{const X=new Date(ee.weekEndingDate);return ee.employeeId===F&&X.getMonth()===G&&X.getFullYear()===W}).reduce((ee,X)=>ee+X.totalPoints,0)},q=[...A,...L].map(W=>({employee:W,total:R(W.id)})).reduce((W,ee)=>ee.total>W.total?ee:W),Y=(F,G,W,ee)=>F.length===0?null:s.jsxs(je.Fragment,{children:[s.jsx("tr",{className:`${ee} border-t-2 border-gray-300`,children:s.jsx("td",{colSpan:t.length+3,className:`px-6 py-4 ${ee}`,children:s.jsx("h3",{className:"text-lg font-bold text-gray-900",children:G})})}),F.map(X=>s.jsxs(je.Fragment,{children:[s.jsxs("tr",{className:"bg-yellow-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap sticky left-0 bg-yellow-50 z-10",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("img",{src:X.avatar,alt:X.name,className:"w-8 h-8 rounded-full mr-3"}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:X.name}),s.jsx("div",{className:"text-xs text-gray-500",children:X.role})]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800",children:"Pontuação total"})}),t.map(le=>{const ce=w(X.id,le);return s.jsx("td",{className:"px-4 py-4 text-center",children:s.jsx("span",{className:"text-lg font-bold text-yellow-600",children:(ce==null?void 0:ce.totalPoints)||0})},le)}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx("span",{className:"text-xl font-bold text-green-600",children:R(X.id)})})]}),W.map(le=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-3 whitespace-nowrap sticky left-0 bg-white z-10"}),s.jsx("td",{className:"px-6 py-3 whitespace-nowrap",children:s.jsx("span",{className:"text-sm text-gray-900",children:le.name})}),t.map(ce=>{const dt=w(X.id,ce),ts=(dt==null?void 0:dt.metrics[le.id])||0;return s.jsx("td",{className:"px-4 py-3 text-center",children:s.jsx("input",{type:"number",value:ts,onChange:V=>x&&U(X.id,ce,le.id,V.target.value,X.role),className:"w-16 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center hover:border-blue-400 transition-colors",min:"0",placeholder:"0",disabled:!x})},ce)}),s.jsx("td",{className:"px-6 py-3 text-center",children:s.jsx("span",{className:"text-sm font-medium text-gray-900",children:n.filter(ce=>{const dt=new Date(ce.weekEndingDate),ts=new Date().getMonth(),V=new Date().getFullYear();return ce.employeeId===X.id&&dt.getMonth()===ts&&dt.getFullYear()===V}).reduce((ce,dt)=>ce+(dt.metrics[le.id]||0),0)})})]},`${X.id}-${le.id}`))]},X.id))]});return s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Performance Semanal ",e]}),s.jsx("p",{className:"text-gray-600",children:f&&x?`Acompanhe a performance detalhada por função e semana para ${e}`:f?`Visualize a performance detalhada por função e semana para ${e} (somente leitura)`:"Acesso restrito à performance semanal"})]}),s.jsxs("div",{className:"flex items-center space-x-4",children:[f&&x&&s.jsxs("button",{onClick:T,className:"bg-green-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:bg-green-700 transition-colors",children:[s.jsx(Pe,{className:"w-4 h-4"}),s.jsx("span",{children:"adicionar dia"})]}),f&&i&&x&&s.jsxs("div",{className:"flex items-center space-x-2 text-sm text-orange-600 bg-orange-50 px-3 py-1 rounded-full",children:[s.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full animate-pulse"}),s.jsx("span",{children:"Alterações não salvas"})]}),f&&!x&&s.jsxs("div",{className:"flex items-center space-x-2 text-sm text-blue-600 bg-blue-50 px-3 py-1 rounded-full",children:[s.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),s.jsx("span",{children:"Modo Somente Leitura"})]}),s.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(ot,{className:"w-5 h-5 text-green-600"}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-green-800",children:"Líder do Mês"}),s.jsxs("div",{className:"text-lg font-bold text-green-900",children:[q.employee.name," - ",q.total," pts"]})]})]})})]})]}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-blue-900 mb-4",children:["Indicadores do Mês Atual (",e,")"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-3",children:"Closers - Semana Atual"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[A.map(F=>{const G=t[t.length-1],W=w(F.id,G),ee=(W==null?void 0:W.metrics.propostasApresentadas)||0,X=(W==null?void 0:W.metrics.contratoAssinado)||0;return s.jsxs(je.Fragment,{children:[s.jsxs("div",{className:"bg-white rounded-lg p-3 border border-blue-200",children:[s.jsx("div",{className:"text-xs font-medium text-gray-500 mb-1",children:F.name}),s.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Propostas apresentadas"}),s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:ee})]}),s.jsxs("div",{className:"bg-white rounded-lg p-3 border border-blue-200",children:[s.jsx("div",{className:"text-xs font-medium text-gray-500 mb-1",children:F.name}),s.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Contrato assinado"}),s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:X})]})]},F.id)}),A.length===0&&s.jsx("div",{className:"col-span-2 text-center py-4 text-gray-500",children:"Nenhum Closer cadastrado"})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-medium text-green-900 mb-3",children:"SDRs - Mês Atual"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[L.map(F=>{const G=new Date().getMonth(),W=e,ee=n.filter(le=>{const ce=new Date(le.weekEndingDate);return le.employeeId===F.id&&ce.getMonth()===G&&ce.getFullYear()===W}).reduce((le,ce)=>le+(ce.metrics.mql||0),0),X=n.filter(le=>{const ce=new Date(le.weekEndingDate);return le.employeeId===F.id&&ce.getMonth()===G&&ce.getFullYear()===W}).reduce((le,ce)=>le+(ce.metrics.visitasAgendadas||0),0);return s.jsxs(je.Fragment,{children:[s.jsxs("div",{className:"bg-white rounded-lg p-3 border border-green-200",children:[s.jsx("div",{className:"text-xs font-medium text-gray-500 mb-1",children:F.name}),s.jsx("div",{className:"text-sm font-medium text-gray-900",children:"MQL do mês"}),s.jsx("div",{className:"text-2xl font-bold text-green-600",children:ee})]}),s.jsxs("div",{className:"bg-white rounded-lg p-3 border border-green-200",children:[s.jsx("div",{className:"text-xs font-medium text-gray-500 mb-1",children:F.name}),s.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Visitas agendadas"}),s.jsx("div",{className:"text-2xl font-bold text-green-600",children:X})]})]},F.id)}),L.length===0&&s.jsx("div",{className:"col-span-2 text-center py-4 text-gray-500",children:"Nenhum SDR cadastrado"})]})]})]})]}),s.jsx(Py,{weeklyData:n,weeks:t,employees:[...A,...L]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Tabela de Performance por Função (",e,")"]}),s.jsxs("div",{className:"text-sm text-gray-600",children:["📅 ",t.length," datas • 🤖 ",Ca().filter(F=>new Date(F).getFullYear()===e).length," sextas automáticas • ➕ ",t.length-Ca().filter(F=>new Date(F).getFullYear()===e).length," datas customizadas"]})]})}),s.jsx("div",{className:"overflow-x-auto max-h-[80vh] overflow-y-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10 shadow-sm",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sticky left-0 bg-gray-50 z-10",children:"Funcionário"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"Métrica"}),t.map(F=>s.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[80px] bg-gray-50",children:s.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[s.jsx("span",{children:z(F)}),x&&s.jsx("button",{onClick:()=>P(F),className:"text-xs text-red-500 hover:text-red-700 transition-colors",title:"Remover este dia",children:"✕"})]})},F)),s.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"Total Mês"})]})}),s.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[Y(A,"CLOSERS",ro,"bg-blue-50"),Y(L,"SDRs",no,"bg-green-50")]})]})})]}),s.jsx("div",{className:`border rounded-xl p-6 ${x?i?"bg-orange-50 border-orange-200":"bg-green-50 border-green-200":"bg-blue-50 border-blue-200"}`,children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:`w-3 h-3 rounded-full ${x?i?"bg-orange-500 animate-pulse":"bg-green-500":"bg-blue-500"}`}),s.jsxs("div",{children:[s.jsx("h3",{className:`text-lg font-semibold ${x?i?"text-orange-900":"text-green-900":"text-blue-900"}`,children:x?i?"Alterações Pendentes":"Dados Salvos":"Modo Somente Leitura"}),s.jsx("p",{className:`text-sm ${x?i?"text-orange-700":"text-green-700":"text-blue-700"}`,children:x?i?'Clique em "Salvar Todas as Alterações" para persistir no banco':"Todos os dados estão sincronizados":"Para editar, mude para o modo administrativo"})]})]}),s.jsx("div",{className:"flex items-center space-x-3",children:i&&x?s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("button",{onClick:_,disabled:l,className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:[s.jsx(Df,{className:"w-4 h-4"}),s.jsx("span",{children:"Descartar"})]}),s.jsxs("button",{onClick:N,disabled:l,className:"flex items-center space-x-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[s.jsx(hs,{className:"w-4 h-4"}),s.jsx("span",{children:l?"Salvando...":"Salvar Todas as Alterações"})]})]}):x?s.jsxs("div",{className:"text-sm text-green-700",children:["✅ Pontuação atualizada em tempo real",s.jsx("br",{}),"📊 Gráfico sincronizado automaticamente",s.jsx("br",{}),"💾 Dados persistidos no banco"]}):s.jsxs("div",{className:"text-sm text-blue-700",children:["👁️ Visualização dos dados",s.jsx("br",{}),"📊 Gráfico atualizado automaticamente",s.jsx("br",{}),"🔒 Edição requer modo administrativo"]})})]})}),d&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Adicionar Nova Data"}),s.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600",children:s.jsx(ne,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Selecione a data"}),s.jsx("input",{type:"date",value:m,onChange:F=>{h(F.target.value),b("")},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",required:!0}),g&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:g})]}),s.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[s.jsx("button",{onClick:()=>u(!1),className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancelar"}),s.jsx("button",{onClick:I,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Adicionar"})]})]})]})})]})},$y=()=>{const[e]=M.useState(new Date().getFullYear()),[t,r]=M.useState([]),[n,a]=M.useState(!1),[i,o]=M.useState(new Set),{data:l=[],loading:c}=J("proposals",{select:"id, client, total_value, status, updated_at, created_at"}),{data:d=[],loading:u}=J("employees",{select:"id, name, avatar, role, admission_date"}),m=()=>{const v=l.filter(L=>L.status==="Fechado"&&!i.has(L.id));let j=0;const A=[];return v.forEach(L=>{const w=(L.total_value||0)*.001;j+=50+w,A.push({id:`fixed-${L.id}`,proposalId:L.id,clientName:L.client,contractValue:L.total_value||0,fixedAmount:50,percentageAmount:w,totalContribution:50+w,date:L.updated_at||L.created_at})}),{totalAmount:j,contributions:A,closedProposals:v}},h=v=>{if(!v)return 0;const j=new Date(v),A=new Date,L=A.getFullYear(),E=new Date(L,0,1),w=j.getFullYear()<L?E:j;if(w>A)return 0;let O=A.getMonth()-w.getMonth()+1;return A.getDate()<w.getDate()&&O--,Math.max(1,O)},g=v=>{const j=d.filter(A=>A.role!=="Admin");return j.length===0?[]:j.map(A=>{const L=A.admission_date||"2024-01-01",E=h(L);return{id:A.id,name:A.name,avatar:A.avatar,startDate:L,monthsWorked:E,projectedBonus:0}})},b=(v,j)=>{const A=v.reduce((L,E)=>L+E.monthsWorked,0);return v.map(L=>({...L,projectedBonus:A>0?L.monthsWorked/A*j:0}))},{totalAmount:y,contributions:k,closedProposals:x}=m(),f=g(),p=b(f,y);M.useEffect(()=>{const v=[];x.forEach(L=>{const E=L.updated_at||L.created_at;v.push({id:`fixed-${L.id}`,type:"contribution",date:E,description:"Valor fixo por contrato fechado",amount:50,contractOrigin:L.client});const w=(L.total_value||0)*.001;v.push({id:`percentage-${L.id}`,type:"contribution",date:E,description:"0,1% do valor global do contrato",amount:w,contractOrigin:L.client})});const A=[...t.filter(L=>L.type!=="contribution"),...v];A.sort((L,E)=>new Date(E.date).getTime()-new Date(L.date).getTime()),r(A)},[l,i]);const S=()=>{if(y<=0){alert("Não há valor no fundo para distribuir.");return}const v=`Confirma o pagamento de ${D(y)} para ${p.length} funcionários?

Esta ação irá:
- Distribuir o valor proporcionalmente
- Zerar o fundo atual
- Marcar contratos como processados
- Registrar os pagamentos no histórico

APÓS O PAGAMENTO O FUNDO SERÁ ZERADO!`;confirm(v)&&(a(!0),setTimeout(()=>{const j=new Date().toISOString(),A=[];p.forEach(w=>{w.projectedBonus>0&&A.push({id:`payment-${w.id}-${Date.now()}`,type:"payment",date:j,description:`Pagamento de bonificação proporcional (${w.monthsWorked} meses em ${new Date().getFullYear()})`,amount:-w.projectedBonus,employeeName:w.name})});const L=new Set(i);x.forEach(w=>{L.add(w.id)}),o(L);const E={id:`cycle-end-${Date.now()}`,type:"cycle_end",date:j,description:`🔄 FUNDO ZERADO - Fim do ciclo de bonificação. Contratos processados: ${x.length}. Novo ciclo iniciado.`,amount:-y,employeeName:"Sistema"};r(w=>[E,...A.reverse(),...w]),a(!1),alert(`✅ PAGAMENTO REALIZADO COM SUCESSO!

💰 Total distribuído: ${D(y)}
👥 Funcionários beneficiados: ${p.length}

🔄 FUNDO ZERADO!
📈 Acúmulo recomeçará com novos contratos fechados.

⚠️ Contratos já processados não alimentarão mais o fundo.`)},2e3))},C=v=>On(v);return c||u?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})}):s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Fundo de Bonificação"}),s.jsx("p",{className:"text-gray-600",children:"Cofrinho para distribuição proporcional baseado no tempo de empresa"})]}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[s.jsx(Pe,{className:"w-4 h-4"}),s.jsxs("span",{children:["Ano: ",e]})]}),s.jsxs("button",{onClick:S,disabled:n||y<=0,className:`flex items-center space-x-2 px-6 py-3 rounded-lg font-medium transition-colors ${y>0&&!n?"bg-green-600 text-white hover:bg-green-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:[s.jsx(jf,{className:"w-5 h-5"}),s.jsx("span",{children:n?"Processando...":"Pagar"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total do Fundo"}),s.jsx("p",{className:"text-2xl font-bold text-green-600",children:D(y)}),s.jsx("p",{className:"text-xs text-gray-500",children:"Apenas contratos não processados"})]}),s.jsx("div",{className:"w-12 h-12 rounded-lg bg-green-500 flex items-center justify-center",children:s.jsx(el,{className:"w-6 h-6 text-white"})})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Contratos Pendentes"}),s.jsx("p",{className:"text-2xl font-bold text-blue-600",children:x.length}),s.jsx("p",{className:"text-xs text-gray-500",children:"Não processados"})]}),s.jsx("div",{className:"w-12 h-12 rounded-lg bg-blue-500 flex items-center justify-center",children:s.jsx(ot,{className:"w-6 h-6 text-white"})})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Funcionários"}),s.jsx("p",{className:"text-2xl font-bold text-purple-600",children:p.length}),s.jsx("p",{className:"text-xs text-gray-500",children:"Beneficiários"})]}),s.jsx("div",{className:"w-12 h-12 rounded-lg bg-purple-500 flex items-center justify-center",children:s.jsx(Ve,{className:"w-6 h-6 text-white"})})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Contratos Processados"}),s.jsx("p",{className:"text-2xl font-bold text-orange-600",children:i.size}),s.jsx("p",{className:"text-xs text-gray-500",children:"Já pagos"})]}),s.jsx("div",{className:"w-12 h-12 rounded-lg bg-orange-500 flex items-center justify-center",children:s.jsx(De,{className:"w-6 h-6 text-white"})})]})})]}),s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(Xe,{className:"w-6 h-6 text-blue-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Como Funciona o Fundo"}),s.jsxs("div",{className:"space-y-2 text-blue-800",children:[s.jsxs("p",{children:["• A cada contrato fechado, o fundo recebe ",s.jsx("strong",{children:"R$ 50,00 + 0,1% do valor global"})]}),s.jsx("p",{children:'• Ao clicar em "Pagar", o valor é distribuído proporcionalmente entre todos os funcionários'}),s.jsxs("p",{children:["• A proporção é baseada nos ",s.jsxs("strong",{children:["meses trabalhados no ano atual (",new Date().getFullYear(),")"]})]}),s.jsxs("p",{children:["• ",s.jsx("strong",{children:"APÓS O PAGAMENTO:"})," O fundo é zerado e contratos são marcados como processados"]}),s.jsxs("p",{children:["• ",s.jsx("strong",{children:"IMPORTANTE:"})," Contratos já processados não alimentam mais o fundo (evita duplicidade)"]})]})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Projeção de Bonificação por Funcionário"}),s.jsx("div",{className:"space-y-4",children:p.sort((v,j)=>j.projectedBonus-v.projectedBonus).map(v=>s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center space-x-4 mb-3",children:[s.jsx("img",{src:v.avatar,alt:v.name,className:"w-12 h-12 rounded-full"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-medium text-gray-900",children:v.name}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Desde ",st(v.startDate)," • ",v.monthsWorked," ",v.monthsWorked===1?"mês":"meses"," em ",new Date().getFullYear()]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-lg font-bold text-green-600",children:D(v.projectedBonus)}),s.jsx("div",{className:"text-xs text-gray-500",children:"projeção atual"})]})]}),s.jsx("div",{className:"bg-gray-100 rounded-full h-2",children:s.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${p.length>0?v.monthsWorked/Math.max(...p.map(j=>j.monthsWorked))*100:0}%`}})}),s.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[s.jsxs("span",{children:["Meses trabalhados em ",new Date().getFullYear()]}),s.jsxs("span",{children:[v.monthsWorked," ",v.monthsWorked===1?"mês":"meses"]})]})]},v.id))})]}),s.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 border border-green-200 rounded-xl p-6",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[s.jsx(Lt,{className:"w-6 h-6 text-green-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Distribuição Atual"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600 mb-1",children:D(y)}),s.jsx("div",{className:"text-sm text-gray-600",children:"Total Acumulado"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:p.reduce((v,j)=>v+j.monthsWorked,0)}),s.jsxs("div",{className:"text-sm text-gray-600",children:["Total Meses em ",new Date().getFullYear()]})]})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-lg font-bold text-purple-600 mb-1",children:p.reduce((v,j)=>v+j.monthsWorked,0)>0?D(y/p.reduce((v,j)=>v+j.monthsWorked,0)):D(0)}),s.jsxs("div",{className:"text-sm text-gray-600",children:["Valor por Mês em ",new Date().getFullYear()]})]}),s.jsx("div",{className:"mt-4 pt-4 border-t border-blue-300 text-center",children:s.jsx("p",{className:"text-sm text-gray-600",children:'Clique em "Pagar" para distribuir o valor atual e zerar o fundo'})})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[s.jsx(Zo,{className:"w-6 h-6 text-gray-600"}),s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Histórico de Transações"})]}),s.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:t.length>0?t.map(v=>s.jsxs("div",{className:`border-l-4 pl-4 py-3 rounded-r-lg ${v.type==="contribution"?"border-green-500 bg-green-50":v.type==="cycle_end"?"border-purple-500 bg-purple-50":"border-red-500 bg-red-50"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:`text-sm font-medium ${v.type==="contribution"?"text-green-800":v.type==="cycle_end"?"text-purple-800":"text-red-800"}`,children:v.type==="contribution"?"+ Contribuição":v.type==="cycle_end"?"🔄 Fim de Ciclo":"- Pagamento"}),s.jsx("span",{className:"text-xs text-gray-500",children:C(v.date)})]}),s.jsx("span",{className:`text-lg font-bold ${v.type==="contribution"?"text-green-600":v.type==="cycle_end"?"text-purple-600":"text-red-600"}`,children:v.type==="cycle_end"?"":D(Math.abs(v.amount))})]}),s.jsx("p",{className:"text-sm text-gray-700 mb-1",children:v.description}),v.contractOrigin&&s.jsxs("p",{className:"text-xs text-gray-500",children:[s.jsx("strong",{children:"Contrato:"})," ",v.contractOrigin]}),v.employeeName&&s.jsxs("p",{className:"text-xs text-gray-500",children:[s.jsx("strong",{children:"Funcionário:"})," ",v.employeeName]})]},v.id)):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(el,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"Nenhuma transação ainda"}),s.jsx("p",{className:"text-sm text-gray-400",children:"O histórico será alimentado quando contratos forem fechados"})]})})]})]})},My=()=>{const{selectedYear:e}=Tt(),{data:t=[],loading:r}=J("employees",{select:"id, name, avatar, role, department",orderBy:{column:"name",ascending:!0}}),{data:n=[],loading:a}=J("weekly_performance",{select:"employee_id, week_ending_date, total_points, tarefas, propostas_apresentadas, contrato_assinado, mql, visitas_agendadas",orderBy:{column:"week_ending_date",ascending:!1}}),[i,o]=je.useState(new Date),[l,c]=je.useState(0),d=i.toLocaleDateString("pt-BR",{month:"long",year:"numeric"});if(r||a)return s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(t.length===0)return s.jsxs("div",{className:"text-center py-12",children:[s.jsx(At,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum funcionário cadastrado"}),s.jsx("p",{className:"text-gray-500",children:'Cadastre funcionários na aba "Funcionários" para ver o ranking mensal'})]});const u=w=>{new Date(e,w.getMonth(),1);const O=new Date(w.getFullYear(),w.getMonth(),1),U=new Date(w.getFullYear(),w.getMonth()+1,0),N={};return t.forEach(_=>{N[_.id]={tasks:0,meetings:0,proposals:0,closedDeals:0,total:0}}),n.forEach(_=>{const T=new Date(_.week_ending_date);if(T>=O&&T<=U&&N[_.employee_id]){const I=t.find(P=>P.id===_.employee_id);(I==null?void 0:I.role)==="Closer"?(N[_.employee_id].tasks+=_.tarefas||0,N[_.employee_id].proposals+=_.propostas_apresentadas||0,N[_.employee_id].closedDeals+=_.contrato_assinado||0):(I==null?void 0:I.role)==="SDR"&&(N[_.employee_id].tasks+=_.tarefas||0,N[_.employee_id].meetings+=_.mql||0,N[_.employee_id].proposals+=_.visitas_agendadas||0,N[_.employee_id].closedDeals+=0),N[_.employee_id].total+=_.total_points||0}}),N},m=u(i),h=()=>t.map(w=>{const O=m[w.id]||{tasks:0,meetings:0,proposals:0,closedDeals:0,total:0};return{employee:w,points:O,rank:1}}).sort((w,O)=>O.points.total-w.points.total).map((w,O)=>({...w,rank:O+1})),b=(()=>{const w=new Set;return n.forEach(O=>{const U=new Date(O.week_ending_date);if(U.getFullYear()===e){const N=`${U.getFullYear()}-${U.getMonth()}`;w.add(N)}}),Array.from(w).map(O=>{const[U,N]=O.split("-");return new Date(parseInt(U),parseInt(N),1)}).sort((O,U)=>U.getTime()-O.getTime())})(),k=b.map(w=>{const O=u(w),U=t.map(N=>{const _=O[N.id]||{tasks:0,meetings:0,proposals:0,closedDeals:0,total:0};return{employee:N,points:_,rank:1}}).sort((N,_)=>_.points.total-N.points.total);return{month:w,winner:U[0]||null,monthLabel:w.toLocaleDateString("pt-BR",{month:"long",year:"numeric"})}}),x=k.slice(l,l+4),f=h(),p=f[0]||{employee:{name:"Nenhum funcionário",avatar:"",position:"",id:"0"},points:{tasks:0,meetings:0,proposals:0,closedDeals:0,total:0},rank:1},S=w=>{switch(w){case 1:return s.jsx(At,{className:"w-6 h-6 text-yellow-500"});case 2:return s.jsx(Yt,{className:"w-6 h-6 text-gray-400"});case 3:return s.jsx($e,{className:"w-6 h-6 text-amber-600"});default:return s.jsx("span",{className:"w-6 h-6 flex items-center justify-center text-gray-500 font-bold",children:w})}},C=w=>{switch(w){case 1:return"from-yellow-400 to-yellow-600";case 2:return"from-gray-300 to-gray-500";case 3:return"from-amber-400 to-amber-600";default:return"from-gray-200 to-gray-400"}},v=n.length>0,j=()=>{const w=b.findIndex(O=>O.getTime()===i.getTime());w<b.length-1&&o(b[w+1])},A=()=>{const w=b.findIndex(O=>O.getTime()===i.getTime());w>0&&o(b[w-1])},L=()=>{l>0&&c(l-1)},E=()=>{l<k.length-4&&c(l+1)};return s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Selecionar Mês (",e,")"]}),s.jsx("p",{className:"text-gray-600",children:"Escolha o mês para ver o destaque"})]}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("button",{onClick:j,disabled:b.findIndex(w=>w.getTime()===i.getTime())>=b.length-1,className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(Xo,{className:"w-5 h-5"})}),s.jsxs("div",{className:"text-center min-w-[200px]",children:[s.jsx("div",{className:"text-xl font-bold text-gray-900 capitalize",children:d}),s.jsxs("div",{className:"text-sm text-gray-500",children:[b.findIndex(w=>w.getTime()===i.getTime())+1," de ",b.length," meses"]})]}),s.jsx("button",{onClick:A,disabled:b.findIndex(w=>w.getTime()===i.getTime())<=0,className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(wd,{className:"w-5 h-5"})})]})]})}),!v&&s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Pe,{className:"w-6 h-6 text-blue-600"}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-blue-900",children:"Dados de Performance Necessários"}),s.jsx("p",{className:"text-blue-800",children:'Para ver o ranking do mês, adicione dados na aba "Performance Semanal". Os pontos serão calculados automaticamente baseados nas métricas inseridas.'})]})]})}),s.jsxs("div",{className:"bg-gradient-to-br from-yellow-50 to-orange-50 border-2 border-yellow-200 rounded-xl p-8",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[s.jsx(At,{className:"w-8 h-8 text-yellow-500"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Destaque do Mês"})]}),s.jsx("p",{className:"text-gray-600 capitalize",children:d})]}),s.jsxs("div",{className:"flex items-center justify-center space-x-6 mb-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:p.employee.avatar||"https://images.pexels.com/photos/774909/pexels-photo-774909.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop",alt:p.employee.name,className:"w-24 h-24 rounded-full border-4 border-yellow-400 shadow-lg"}),s.jsx("div",{className:"absolute -top-2 -right-2 w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center",children:s.jsx(At,{className:"w-4 h-4 text-white"})})]}),s.jsx("h3",{className:"text-xl font-bold text-gray-900 mt-3",children:p.employee.name}),s.jsxs("p",{className:"text-gray-600",children:[p.employee.role," • ",p.employee.department]})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-4xl font-bold text-yellow-600 mb-2",children:p.points.total}),s.jsx("div",{className:"text-gray-600",children:"pontos totais"}),s.jsx("div",{className:"text-sm text-gray-500 mt-1",children:v?"Baseado na performance semanal":"Aguardando dados de performance"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"bg-white rounded-lg p-4 text-center border border-yellow-200",children:[s.jsx(An,{className:"w-6 h-6 text-blue-500 mx-auto mb-2"}),s.jsx("div",{className:"text-lg font-bold text-gray-900",children:p.employee.role==="Closer"?p.points.proposals:"—"}),s.jsx("div",{className:"text-sm text-gray-600",children:"Propostas Apresentadas"}),s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"(Closers)"})]}),s.jsxs("div",{className:"bg-white rounded-lg p-4 text-center border border-yellow-200",children:[s.jsx(Cf,{className:"w-6 h-6 text-blue-500 mx-auto mb-2"}),s.jsx("div",{className:"text-lg font-bold text-gray-900",children:p.employee.role==="Closer"?p.points.closedDeals:"—"}),s.jsx("div",{className:"text-sm text-gray-600",children:"Contrato Assinado"}),s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"(Closers)"})]}),s.jsxs("div",{className:"bg-white rounded-lg p-4 text-center border border-yellow-200",children:[s.jsx($e,{className:"w-6 h-6 text-green-500 mx-auto mb-2"}),s.jsx("div",{className:"text-lg font-bold text-gray-900",children:p.employee.role==="SDR"?p.points.meetings:"—"}),s.jsx("div",{className:"text-sm text-gray-600",children:"MQL"}),s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"(SDRs)"})]}),s.jsxs("div",{className:"bg-white rounded-lg p-4 text-center border border-yellow-200",children:[s.jsx(Pe,{className:"w-6 h-6 text-green-500 mx-auto mb-2"}),s.jsx("div",{className:"text-lg font-bold text-gray-900",children:p.employee.role==="SDR"?p.points.proposals:"—"}),s.jsx("div",{className:"text-sm text-gray-600",children:"Visitas Agendadas"}),s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"(SDRs)"})]})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Ranking Completo - ",d," ",e]}),s.jsx("div",{className:"space-y-4",children:f.map(w=>s.jsxs("div",{className:"flex items-center space-x-4 p-4 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors",children:[s.jsx("div",{className:`w-12 h-12 rounded-full bg-gradient-to-br ${C(w.rank)} flex items-center justify-center`,children:S(w.rank)}),s.jsx("img",{src:w.employee.avatar,alt:w.employee.name,className:"w-12 h-12 rounded-full"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("h4",{className:"text-lg font-medium text-gray-900",children:w.employee.name}),s.jsxs("span",{className:"text-sm text-gray-500",children:["#",w.rank]})]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[w.employee.role," • ",w.employee.department]}),s.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500",children:[s.jsxs("span",{children:[w.points.tasks," tarefas"]}),s.jsxs("span",{children:[w.points.meetings," conexões"]}),s.jsxs("span",{children:[w.points.proposals," propostas"]}),s.jsxs("span",{children:[w.points.closedDeals," fechamentos"]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-xl font-bold text-gray-900",children:w.points.total}),s.jsx("div",{className:"text-sm text-gray-500",children:"pontos"})]})]},w.employee.id))})]}),k.length>0&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Histórico de Destaques"}),s.jsx("p",{className:"text-gray-600",children:"Vencedores dos meses anteriores"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:L,disabled:l<=0,className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(Xo,{className:"w-4 h-4"})}),s.jsxs("span",{className:"text-sm text-gray-500",children:[l+1,"-",Math.min(l+4,k.length)," de ",k.length]}),s.jsx("button",{onClick:E,disabled:l>=k.length-4,className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(wd,{className:"w-4 h-4"})})]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:x.map((w,O)=>s.jsx("div",{className:`border-2 rounded-xl p-4 transition-all cursor-pointer ${w.month.getTime()===i.getTime()?"border-yellow-400 bg-yellow-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,onClick:()=>o(w.month),children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-sm font-medium text-gray-600 mb-2 capitalize",children:w.monthLabel}),w.winner?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"relative mb-3",children:[s.jsx("img",{src:w.winner.employee.avatar,alt:w.winner.employee.name,className:"w-12 h-12 rounded-full mx-auto border-2 border-yellow-400"}),s.jsx("div",{className:"absolute -top-1 -right-1 w-6 h-6 bg-yellow-500 rounded-full flex items-center justify-center",children:s.jsx(At,{className:"w-3 h-3 text-white"})})]}),s.jsx("div",{className:"text-sm font-bold text-gray-900 mb-1",children:w.winner.employee.name}),s.jsx("div",{className:"text-xs text-gray-600 mb-2",children:w.winner.employee.role}),s.jsx("div",{className:"text-lg font-bold text-yellow-600",children:w.winner.points.total}),s.jsx("div",{className:"text-xs text-gray-500",children:"pontos"})]}):s.jsxs("div",{className:"text-center py-4",children:[s.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full mx-auto mb-2 flex items-center justify-center",children:s.jsx(At,{className:"w-6 h-6 text-gray-400"})}),s.jsx("div",{className:"text-sm text-gray-500",children:"Sem dados"})]})]})},w.month.getTime()))})]}),s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-green-900 mb-4",children:"Como Funciona o Ranking"}),s.jsxs("div",{className:"space-y-2 text-green-800",children:[s.jsxs("p",{children:["• ",s.jsx("strong",{children:"Dados em tempo real:"}),' Baseado na aba "Performance Semanal"']}),s.jsxs("p",{children:["• ",s.jsx("strong",{children:"Cálculo automático:"})," Soma todas as semanas do mês selecionado"]}),s.jsxs("p",{children:["• ",s.jsx("strong",{children:"Pesos aplicados:"})," Cada métrica tem seu multiplicador específico"]}),s.jsxs("p",{children:["• ",s.jsx("strong",{children:"Atualização automática:"})," Ranking muda conforme você adiciona dados semanais"]}),s.jsxs("p",{children:["• ",s.jsx("strong",{children:"Período ativo:"})," ",d," ",e]})]})]})]})},Ry=()=>{const{data:e=[],loading:t,refetch:r}=J("employees",{orderBy:{column:"name",ascending:!0}}),{insert:n,loading:a}=Ns("employees"),{update:i,loading:o}=Rn("employees"),{deleteRecord:l,loading:c}=dl("employees"),[d,u]=M.useState(!1),[m,h]=M.useState(null),[g,b]=M.useState(!1),[y,k]=M.useState({name:"",email:"",role:"SDR",department:"Vendas",position:"",admissionDate:"",avatar:""});if(t)return s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});const x=()=>{k(w=>({...w,avatar:""}))},f=async w=>{if(w.preventDefault(),!y.name.trim()||!y.email.trim()){alert("Nome e email são obrigatórios");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(y.email)){alert("Por favor, insira um email válido");return}try{console.log("🚀 Iniciando salvamento do funcionário:",y);const U={name:y.name,email:y.email,role:y.role,department:y.department,position:y.position||y.role,avatar:y.avatar||j(y.name),admission_date:y.admissionDate||new Date().toISOString().split("T")[0],points:0,level:1};console.log("📊 Dados preparados para inserção:",U),m?(console.log("✏️ Atualizando funcionário existente:",m.id),await i(m.id,U),console.log("Employee updated successfully"),alert("Funcionário atualizado com sucesso!")):(console.log("➕ Criando novo funcionário..."),await n(U),console.log("Employee added successfully"),alert("Funcionário adicionado com sucesso!")),console.log("🔄 Atualizando lista de funcionários..."),r(),p()}catch(U){console.error("Error saving employee:",U);let N="Erro desconhecido ao salvar funcionário.";if(U&&typeof U=="object"&&"message"in U){const _=U.message;_.includes("duplicate key")||_.includes("unique constraint")?N="Este email já está cadastrado. Use um email diferente.":_.includes("network")||_.includes("fetch")?N="Erro de conexão. Verifique sua internet e tente novamente.":N=`Erro: ${_}`}alert(N)}finally{console.log("🏁 Finalizando processo de salvamento")}},p=()=>{console.log("🔄 Resetando formulário..."),k({name:"",email:"",role:"SDR",department:"Vendas",position:"",admissionDate:"",avatar:""}),u(!1),h(null),b(!1)},S=async w=>{var U;const O=(U=w.target.files)==null?void 0:U[0];if(O){if(!O.type.startsWith("image/")){alert("Por favor, selecione apenas arquivos de imagem (JPG, PNG, GIF)");return}if(O.size>5*1024*1024){alert("A imagem deve ter no máximo 5MB");return}b(!0);try{const N=new FileReader;N.onload=_=>{var I;const T=(I=_.target)==null?void 0:I.result;k(P=>({...P,avatar:T})),b(!1)},N.onerror=()=>{alert("Erro ao carregar a imagem. Tente novamente."),b(!1)},N.readAsDataURL(O)}catch(N){console.error("Error uploading photo:",N),alert("Erro ao carregar a imagem. Tente novamente."),b(!1)}}},C=w=>{console.log("✏️ Editando funcionário:",w.name),h(w),k({name:w.name,email:w.email,role:w.role,department:w.department,position:w.position,admissionDate:w.admission_date||new Date().toISOString().split("T")[0],avatar:w.avatar}),u(!0)},v=async w=>{const O=e.find(_=>_.id===w),U=`Tem certeza que deseja remover "${O==null?void 0:O.name}"?

Esta ação não pode ser desfeita e removerá:
- O funcionário do sistema
- Todas as propostas associadas
- Dados de performance

Digite "CONFIRMAR" para prosseguir:`,N=prompt(U);if(N==="CONFIRMAR")try{console.log("🗑️ Deletando funcionário:",O==null?void 0:O.name),await l(w),console.log("Employee deleted successfully"),await r(),alert("Funcionário removido com sucesso!")}catch(_){console.error("Error deleting employee:",_),alert(`Erro ao excluir funcionário: ${_ instanceof Error?_.message:"Tente novamente."}`)}else N!==null&&alert('Exclusão cancelada. Digite exatamente "CONFIRMAR" para remover o funcionário.')},j=w=>{const O=["https://images.pexels.com/photos/774909/pexels-photo-774909.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop","https://images.pexels.com/photos/1222271/pexels-photo-1222271.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop","https://images.pexels.com/photos/1239291/pexels-photo-1239291.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop","https://images.pexels.com/photos/1043471/pexels-photo-1043471.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop","https://images.pexels.com/photos/1181690/pexels-photo-1181690.jpeg?auto=compress&cs=tinysrgb&w=150&h=150&fit=crop"],U=w.length%O.length;return O[U]},A=w=>{switch(w){case"Closer":return"bg-blue-100 text-blue-800";case"SDR":return"bg-green-100 text-green-800";case"Admin":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},L=w=>{if(!w)return 0;const O=new Date(w),U=new Date;let N=(U.getFullYear()-O.getFullYear())*12;return N+=U.getMonth()-O.getMonth(),U.getDate()<O.getDate()&&N--,Math.max(1,N)},E=w=>{if(!w)return"Data não informada";const O=L(w);if(O<12)return`${O} ${O===1?"mês":"meses"}`;{const U=Math.floor(O/12),N=O%12;return N===0?`${U} ${U===1?"ano":"anos"}`:`${U} ${U===1?"ano":"anos"} e ${N} ${N===1?"mês":"meses"}`}};return s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gerenciar Funcionários"}),s.jsx("p",{className:"text-gray-600",children:"Adicione, edite e gerencie SDRs e Closers"})]}),s.jsxs("button",{onClick:()=>u(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:bg-blue-700 transition-colors",children:[s.jsx(ze,{className:"w-4 h-4"}),s.jsx("span",{children:"Novo Funcionário"})]})]}),d&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:m?"Editar Funcionário":"Novo Funcionário"})}),s.jsxs("form",{onSubmit:f,className:"p-6 space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Foto do Funcionário"}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"relative",children:y.avatar?s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:y.avatar,alt:"Preview",className:"w-20 h-20 rounded-full object-cover border-2 border-gray-300"}),s.jsx("button",{type:"button",onClick:x,className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600 transition-colors",children:s.jsx(ne,{className:"w-3 h-3"})})]}):s.jsx("div",{className:"w-20 h-20 rounded-full bg-gray-200 flex items-center justify-center border-2 border-dashed border-gray-300",children:s.jsx(Ks,{className:"w-8 h-8 text-gray-400"})})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("input",{type:"file",accept:"image/*",onChange:S,className:"hidden",id:"photo-upload",disabled:g}),s.jsxs("label",{htmlFor:"photo-upload",className:`inline-flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium cursor-pointer transition-colors ${g?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 hover:bg-gray-50"}`,children:[s.jsx($f,{className:"w-4 h-4"}),s.jsx("span",{children:g?"Carregando...":"Escolher Foto"})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"JPG, PNG ou GIF até 5MB"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome"}),s.jsx("input",{type:"text",value:y.name,onChange:w=>k({...y,name:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),s.jsx("input",{type:"email",value:y.email,onChange:w=>k({...y,email:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Função"}),s.jsxs("select",{value:y.role,onChange:w=>k({...y,role:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"SDR",children:"SDR"}),s.jsx("option",{value:"Closer",children:"Closer"}),s.jsx("option",{value:"Admin",children:"Admin"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Departamento"}),s.jsx("input",{type:"text",value:y.department,onChange:w=>k({...y,department:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data de Admissão"}),s.jsx("input",{type:"date",value:y.admissionDate,onChange:w=>k({...y,admissionDate:w.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",max:new Date().toISOString().split("T")[0]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Deixe em branco para usar a data atual"})]}),s.jsxs("div",{className:"flex space-x-4 pt-4",children:[s.jsx("button",{type:"submit",disabled:a||o,className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:a||o?"Salvando...":m?"Atualizar":"Adicionar"}),s.jsx("button",{type:"button",onClick:p,disabled:a||o,className:"flex-1 border border-gray-300 text-gray-700 py-2 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancelar"})]})]})]})}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Funcionários Cadastrados"})}),s.jsx("div",{className:"divide-y divide-gray-200",children:e.map(w=>s.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("img",{src:w.avatar,alt:w.name,className:"w-12 h-12 rounded-full"}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:w.name}),s.jsx("p",{className:"text-sm text-gray-600",children:w.email}),s.jsxs("div",{className:"flex items-center space-x-3 mt-1",children:[s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${A(w.role)}`,children:w.role}),s.jsxs("div",{className:"flex items-center space-x-1 text-xs text-gray-500",children:[s.jsx(nh,{className:"w-3 h-3"}),s.jsx("span",{children:w.department})]}),s.jsxs("div",{className:"flex items-center space-x-1 text-xs text-gray-500",children:[s.jsx(Pe,{className:"w-3 h-3"}),s.jsx("span",{children:E(w.admission_date)})]})]})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("div",{className:"text-right mr-4",children:[s.jsx("div",{className:"text-lg font-bold text-blue-600",children:w.points.toLocaleString()}),s.jsx("div",{className:"text-sm text-gray-500",children:"pontos"})]}),s.jsx("button",{onClick:()=>C(w),className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:s.jsx(Zt,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>v(w.id),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:s.jsx(It,{className:"w-4 h-4"})})]})]})},w.id))})]})]})},Oy=()=>{const{data:e=[],loading:t,refetch:r}=J("user_profiles",{orderBy:{column:"created_at",ascending:!1}}),{update:n}=Rn("user_profiles"),[a,i]=M.useState(!1),[o,l]=M.useState(!1),[c,d]=M.useState(null),[u,m]=M.useState({email:"",password:"",name:"",role:"sdr"}),h=async x=>{x.preventDefault(),i(!0);try{const{data:f,error:p}=await ie.from("user_profiles").insert({email:u.email,name:u.name}).select().single();if(p)throw p;alert("Usuário criado com sucesso!"),l(!1),m({email:"",password:"",name:"",role:"sdr"}),r()}catch(f){console.error("Erro ao criar usuário:",f),alert(`Erro ao criar usuário: ${f instanceof Error?f.message:"Erro desconhecido"}`)}finally{i(!1)}},g=x=>{d(x),m({email:x.email,password:"",name:x.name||"",role:"sdr"}),l(!0)},b=async x=>{if(x.preventDefault(),!!c){i(!0);try{await n(c.id,{name:u.name}),alert("Usuário atualizado com sucesso!"),l(!1),d(null),m({email:"",password:"",name:"",role:"sdr"}),r()}catch(f){console.error("Erro ao atualizar usuário:",f),alert(`Erro ao atualizar usuário: ${f instanceof Error?f.message:"Erro desconhecido"}`)}finally{i(!1)}}},y=async(x,f)=>{const p=prompt(`Para excluir o usuário "${f}", digite "EXCLUIR":`);if(p==="EXCLUIR")try{const{error:S}=await ie.from("user_profiles").delete().eq("id",x);if(S)throw S;alert("Usuário excluído com sucesso!"),r()}catch(S){console.error("Erro ao excluir usuário:",S),alert(`Erro ao excluir usuário: ${S instanceof Error?S.message:"Erro desconhecido"}`)}else p!==null&&alert('Exclusão cancelada. Digite exatamente "EXCLUIR" para confirmar.')},k=x=>On(x);return t?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gerenciar Usuários"}),s.jsx("p",{className:"text-gray-600",children:"Controle de acesso e permissões do sistema"})]}),s.jsxs("button",{onClick:()=>l(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:bg-blue-700 transition-colors",children:[s.jsx(ze,{className:"w-4 h-4"}),s.jsx("span",{children:"Novo Usuário"})]})]}),o&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:c?"Editar Usuário":"Criar Novo Usuário"})}),s.jsxs("form",{onSubmit:c?b:h,className:"p-6 space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome"}),s.jsx("input",{type:"text",value:u.name,onChange:x=>m({...u,name:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),s.jsx("input",{type:"email",value:u.email,onChange:x=>m({...u,email:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:!!c,required:!0})]}),s.jsxs("div",{className:"flex space-x-4 pt-4",children:[s.jsx("button",{type:"submit",disabled:a,className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:opacity-50",children:a?c?"Atualizando...":"Criando...":c?"Atualizar":"Criar Usuário"}),s.jsx("button",{type:"button",onClick:()=>{l(!1),d(null),m({email:"",password:"",name:"",role:"sdr"})},disabled:a,className:"flex-1 border border-gray-300 text-gray-700 py-2 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Cancelar"})]})]})]})}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Usuários do Sistema"})}),s.jsx("div",{className:"divide-y divide-gray-200",children:e.map(x=>s.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center",children:s.jsx(Ks,{className:"w-6 h-6 text-gray-500"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:x.name||x.email}),s.jsx("p",{className:"text-sm text-gray-600",children:x.email}),s.jsx("div",{className:"flex items-center space-x-3 mt-1",children:s.jsxs("div",{className:"flex items-center space-x-1 text-xs text-gray-500",children:[s.jsx(Tf,{className:"w-3 h-3"}),s.jsxs("span",{children:["Criado em ",k(x.created_at)]})]})})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>g(x),className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:s.jsx(Zt,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>y(x.id,x.email),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:s.jsx(It,{className:"w-4 h-4"})})]})]})},x.id))})]}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-4",children:"Informações do Sistema"}),s.jsxs("div",{className:"space-y-2 text-blue-800",children:[s.jsxs("p",{children:["• ",s.jsx("strong",{children:"Usuários ativos:"})," ",e.length]}),s.jsxs("p",{children:["• ",s.jsx("strong",{children:"Autenticação:"})," Desativada - Acesso livre"]}),s.jsxs("p",{children:["• ",s.jsx("strong",{children:"Segurança:"})," Sem restrições de acesso"]})]})]})]})},Iy=()=>{const[e,t]=M.useState(null),[r,n]=M.useState(null),[a,i]=M.useState(!1),[o,l]=M.useState(!1),[c,d]=M.useState({name:"",salary:""}),[u,m]=M.useState({name:"",people:"",days:""}),[h,g]=M.useState({name:"",salary:""}),[b,y]=M.useState({name:"",people:"",days:""}),{data:k=[],loading:x,refetch:f}=J("budget_job_roles",{filter:{is_active:!0},orderBy:{column:"role_name",ascending:!0}}),{data:p=[],loading:S,refetch:C}=J("budget_work_scales",{filter:{is_active:!0},orderBy:{column:"scale_name",ascending:!0}}),{insert:v}=Ns("budget_job_roles"),{update:j}=Rn("budget_job_roles"),{deleteRecord:A}=dl("budget_job_roles"),{insert:L}=Ns("budget_work_scales"),{update:E}=Rn("budget_work_scales"),{deleteRecord:w}=dl("budget_work_scales"),O=async()=>{if(!c.name.trim()||!c.salary){alert("Preencha o nome do cargo e o salário base.");return}try{await v({role_name:c.name,base_salary:parseFloat(c.salary),is_active:!0}),d({name:"",salary:""}),i(!1),f(),alert("✅ Cargo adicionado com sucesso!")}catch(R){alert(`❌ Erro ao adicionar cargo: ${R instanceof Error?R.message:"Erro desconhecido"}`)}},U=R=>{t(R.id),g({name:R.role_name,salary:R.base_salary.toString()})},N=async R=>{try{await j(R,{role_name:h.name,base_salary:parseFloat(h.salary)}),t(null),f(),alert("✅ Cargo atualizado com sucesso!")}catch($){alert(`❌ Erro ao atualizar cargo: ${$ instanceof Error?$.message:"Erro desconhecido"}`)}},_=async(R,$)=>{if(confirm(`Tem certeza que deseja excluir o cargo "${$}"?`))try{await A(R),f(),alert("✅ Cargo excluído com sucesso!")}catch(q){alert(`❌ Erro ao excluir cargo: ${q instanceof Error?q.message:"Erro desconhecido"}`)}},T=async()=>{if(!u.name.trim()||!u.people||!u.days){alert("Preencha todos os campos da escala.");return}try{await L({scale_name:u.name,people_quantity:parseFloat(u.people),working_days:parseFloat(u.days),is_active:!0}),m({name:"",people:"",days:""}),l(!1),C(),alert("✅ Escala adicionada com sucesso!")}catch(R){alert(`❌ Erro ao adicionar escala: ${R instanceof Error?R.message:"Erro desconhecido"}`)}},I=R=>{n(R.id),y({name:R.scale_name,people:R.people_quantity.toString(),days:R.working_days.toString()})},P=async R=>{try{await E(R,{scale_name:b.name,people_quantity:parseFloat(b.people),working_days:parseFloat(b.days)}),n(null),C(),alert("✅ Escala atualizada com sucesso!")}catch($){alert(`❌ Erro ao atualizar escala: ${$ instanceof Error?$.message:"Erro desconhecido"}`)}},z=async(R,$)=>{if(confirm(`Tem certeza que deseja excluir a escala "${$}"?`))try{await w(R),C(),alert("✅ Escala excluída com sucesso!")}catch(q){alert(`❌ Erro ao excluir escala: ${q instanceof Error?q.message:"Erro desconhecido"}`)}};return x||S?s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:s.jsx(Us,{className:"w-5 h-5 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Parâmetros para Orçamentos"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Configure cargos e escalas utilizados nos orçamentos"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-md font-semibold text-gray-900",children:"Cargos e Salários Base"}),s.jsxs("button",{onClick:()=>i(!0),className:"bg-blue-600 text-white px-3 py-1 rounded-lg text-sm hover:bg-blue-700 transition-colors flex items-center space-x-1",children:[s.jsx(ze,{className:"w-3 h-3"}),s.jsx("span",{children:"Adicionar"})]})]}),s.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-700",children:"Cargo"}),s.jsx("th",{className:"px-4 py-3 text-right font-medium text-gray-700",children:"Salário Base"}),s.jsx("th",{className:"px-4 py-3 text-center font-medium text-gray-700",children:"Ações"})]})}),s.jsxs("tbody",{className:"divide-y divide-gray-200",children:[a&&s.jsxs("tr",{className:"bg-blue-50",children:[s.jsx("td",{className:"px-4 py-3",children:s.jsx("input",{type:"text",value:c.name,onChange:R=>d({...c,name:R.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"Nome do cargo"})}),s.jsx("td",{className:"px-4 py-3",children:s.jsx("input",{type:"number",value:c.salary,onChange:R=>d({...c,salary:R.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500 text-right",placeholder:"0.00",step:"0.01"})}),s.jsx("td",{className:"px-4 py-3 text-center",children:s.jsxs("div",{className:"flex items-center justify-center space-x-1",children:[s.jsx("button",{onClick:O,className:"p-1 text-green-600 hover:text-green-800",children:s.jsx(hs,{className:"w-3 h-3"})}),s.jsx("button",{onClick:()=>{i(!1),d({name:"",salary:""})},className:"p-1 text-red-600 hover:text-red-800",children:s.jsx(ne,{className:"w-3 h-3"})})]})})]}),k.map(R=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-4 py-3",children:e===R.id?s.jsx("input",{type:"text",value:h.name,onChange:$=>g({...h,name:$.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"}):s.jsx("span",{className:"font-medium text-gray-900",children:R.role_name})}),s.jsx("td",{className:"px-4 py-3 text-right",children:e===R.id?s.jsx("input",{type:"number",value:h.salary,onChange:$=>g({...h,salary:$.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500 text-right",step:"0.01"}):s.jsx("span",{className:"font-medium text-gray-900",children:D(R.base_salary)})}),s.jsx("td",{className:"px-4 py-3 text-center",children:s.jsx("div",{className:"flex items-center justify-center space-x-1",children:e===R.id?s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>N(R.id),className:"p-1 text-green-600 hover:text-green-800",children:s.jsx(hs,{className:"w-3 h-3"})}),s.jsx("button",{onClick:()=>t(null),className:"p-1 text-red-600 hover:text-red-800",children:s.jsx(ne,{className:"w-3 h-3"})})]}):s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>U(R),className:"p-1 text-blue-600 hover:text-blue-800",children:s.jsx(Zt,{className:"w-3 h-3"})}),s.jsx("button",{onClick:()=>_(R.id,R.role_name),className:"p-1 text-red-600 hover:text-red-800",children:s.jsx(It,{className:"w-3 h-3"})})]})})})]},R.id))]})]})})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-md font-semibold text-gray-900",children:"Escalas de Trabalho"}),s.jsxs("button",{onClick:()=>l(!0),className:"bg-green-600 text-white px-3 py-1 rounded-lg text-sm hover:bg-green-700 transition-colors flex items-center space-x-1",children:[s.jsx(ze,{className:"w-3 h-3"}),s.jsx("span",{children:"Adicionar"})]})]}),s.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-700",children:"Escala"}),s.jsx("th",{className:"px-4 py-3 text-center font-medium text-gray-700",children:"Pessoas"}),s.jsx("th",{className:"px-4 py-3 text-center font-medium text-gray-700",children:"Dias"}),s.jsx("th",{className:"px-4 py-3 text-center font-medium text-gray-700",children:"Ações"})]})}),s.jsxs("tbody",{className:"divide-y divide-gray-200",children:[o&&s.jsxs("tr",{className:"bg-green-50",children:[s.jsx("td",{className:"px-4 py-3",children:s.jsx("input",{type:"text",value:u.name,onChange:R=>m({...u,name:R.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-green-500",placeholder:"Ex: 12h segunda a sexta"})}),s.jsx("td",{className:"px-4 py-3",children:s.jsx("input",{type:"number",value:u.people,onChange:R=>m({...u,people:R.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-green-500 text-center",placeholder:"1.37",step:"0.01"})}),s.jsx("td",{className:"px-4 py-3",children:s.jsx("input",{type:"number",value:u.days,onChange:R=>m({...u,days:R.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-green-500 text-center",placeholder:"21.00",step:"0.01"})}),s.jsx("td",{className:"px-4 py-3 text-center",children:s.jsxs("div",{className:"flex items-center justify-center space-x-1",children:[s.jsx("button",{onClick:T,className:"p-1 text-green-600 hover:text-green-800",children:s.jsx(hs,{className:"w-3 h-3"})}),s.jsx("button",{onClick:()=>{l(!1),m({name:"",people:"",days:""})},className:"p-1 text-red-600 hover:text-red-800",children:s.jsx(ne,{className:"w-3 h-3"})})]})})]}),p.map(R=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-4 py-3",children:r===R.id?s.jsx("input",{type:"text",value:b.name,onChange:$=>y({...b,name:$.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-green-500"}):s.jsx("span",{className:"font-medium text-gray-900",children:R.scale_name})}),s.jsx("td",{className:"px-4 py-3 text-center",children:r===R.id?s.jsx("input",{type:"number",value:b.people,onChange:$=>y({...b,people:$.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-green-500 text-center",step:"0.01"}):s.jsx("span",{className:"text-gray-900",children:R.people_quantity})}),s.jsx("td",{className:"px-4 py-3 text-center",children:r===R.id?s.jsx("input",{type:"number",value:b.days,onChange:$=>y({...b,days:$.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-green-500 text-center",step:"0.01"}):s.jsx("span",{className:"text-gray-900",children:R.working_days})}),s.jsx("td",{className:"px-4 py-3 text-center",children:s.jsx("div",{className:"flex items-center justify-center space-x-1",children:r===R.id?s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>P(R.id),className:"p-1 text-green-600 hover:text-green-800",children:s.jsx(hs,{className:"w-3 h-3"})}),s.jsx("button",{onClick:()=>n(null),className:"p-1 text-red-600 hover:text-red-800",children:s.jsx(ne,{className:"w-3 h-3"})})]}):s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>I(R),className:"p-1 text-blue-600 hover:text-blue-800",children:s.jsx(Zt,{className:"w-3 h-3"})}),s.jsx("button",{onClick:()=>z(R.id,R.scale_name),className:"p-1 text-red-600 hover:text-red-800",children:s.jsx(It,{className:"w-3 h-3"})})]})})})]},R.id))]})]})}),s.jsxs("div",{className:"mt-3 text-xs text-gray-500",children:["💡 ",s.jsx("strong",{children:"Dica:"})," Pessoas = quantos funcionários necessários para cobrir a escala. Dias = total de dias trabalhados no mês."]})]})]}),s.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[s.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"Como usar estes parâmetros"}),s.jsxs("div",{className:"text-sm text-blue-800 space-y-1",children:[s.jsxs("p",{children:["• ",s.jsx("strong",{children:"Cargos:"})," Definem o salário base para cada função nos orçamentos"]}),s.jsxs("p",{children:["• ",s.jsx("strong",{children:"Escalas:"})," Determinam quantas pessoas e dias são necessários"]}),s.jsxs("p",{children:["• ",s.jsx("strong",{children:"Cálculos:"})," Estes valores são usados automaticamente nos 8 blocos de cada posto"]})]})]})]})},Ly=()=>{const{selectedYear:e}=Tt(),{canEdit:t,canView:r}=Js(),n=t("settings"),a=r("settings"),[i,o]=M.useState(null),[l,c]=M.useState(null),[d,u]=M.useState(!1),{monthlyGoals:m,loading:h,updateGoals:g,getAnnualGoal:b}=Mh(),[y,k]=M.useState([]),[x,f]=M.useState([]),[p,S]=M.useState([]),[C,v]=M.useState([]),[j,A]=M.useState([2024,2025]);je.useEffect(()=>{(async()=>{try{u(!0);const[Q,te,se]=await Promise.all([Bt.getCommissionTiers(),Bt.getWeeklyMetrics(),Bt.getOperationalCosts()]);f(Q),S(te);const ge=se.map(we=>({...we,years:we.years||j.map(Be=>({year:Be,months:we.months||Array.from({length:12},(ss,Ps)=>({month:Ps+1,value:0}))}))}));v(ge)}catch(Q){console.error("Error loading configurations:",Q),alert("Erro ao carregar configurações. Tente novamente.")}finally{u(!1)}})()},[]),je.useEffect(()=>{m.length>0&&k([...m])},[m]);const L=(V,Q)=>{k(te=>te.map(se=>se.month===V?{...se,targetValue:Q}:se))},E=async()=>{try{u(!0),await g(y),alert("Metas atualizadas com sucesso!"),c(null)}catch(V){console.error("Erro ao salvar metas:",V),alert("Erro ao salvar metas. Tente novamente.")}finally{u(!1)}},w=V=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(V),O=()=>s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-6xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Configurar Custos Operacionais"}),s.jsx("button",{onClick:()=>c(null),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(ne,{className:"w-5 h-5 text-gray-500"})})]}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:["Custos Mensais - ",e]}),s.jsx("p",{className:"text-gray-600",children:"Configure os custos mensais para cálculo do CAC (Custo de Aquisição de Cliente)"})]}),s.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg max-w-full",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-900 sticky left-0 bg-gray-50",style:{minWidth:"240px",width:"240px"},children:"Tipo de Custo"}),j.map(V=>s.jsxs("th",{className:"border-l border-gray-300",colSpan:12,children:[s.jsx("div",{className:"text-center text-lg font-bold text-gray-900 py-2 bg-blue-50",children:V}),s.jsx("div",{className:"grid grid-cols-12 bg-gray-50",children:Array.from({length:12},(Q,te)=>{const se=new Date(V,te,1).toLocaleDateString("pt-BR",{month:"short"});return s.jsx("div",{className:"px-1 py-2 text-center text-xs font-medium text-gray-700 border-r border-gray-200",style:{minWidth:"50px"},children:se},te+1)})})]},V)),s.jsx("th",{className:"px-2 py-3 text-center text-sm font-medium text-gray-900 sticky right-0 bg-gray-50",style:{minWidth:"80px"},children:s.jsx("button",{onClick:G,className:"px-2 py-1 bg-blue-600 text-white rounded text-xs hover:bg-blue-700 transition-colors",title:"Adicionar novo ano",children:"+ Ano"})})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:C.map(V=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-4 py-3 sticky left-0 bg-white",children:s.jsx("input",{type:"text",value:V.name,onChange:Q=>Y(V.id,Q.target.value),className:"w-full px-3 py-2 text-base border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Nome do custo"})}),j.map(Q=>{var te,se,ge;return s.jsx("td",{className:"border-l border-gray-200",colSpan:12,children:s.jsx("div",{className:"grid grid-cols-12",children:((ge=(se=(te=V.years)==null?void 0:te.find(we=>we.year===Q))==null?void 0:se.months)==null?void 0:ge.map(we=>s.jsx("div",{className:"px-1 py-2 border-r border-gray-100",children:s.jsx("input",{type:"number",value:we.value,onChange:Be=>F(V.id,Q,we.month,Number(Be.target.value)||0),className:"w-full px-1 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-green-500 text-center",placeholder:"0",min:"0",step:"0.01",style:{minWidth:"45px"}})},`${Q}-${we.month}`)))||Array.from({length:12},(we,Be)=>s.jsx("div",{className:"px-1 py-2 border-r border-gray-100",children:s.jsx("input",{type:"number",value:0,onChange:ss=>F(V.id,Q,Be+1,Number(ss.target.value)||0),className:"w-full px-1 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-green-500 text-center",placeholder:"0",min:"0",step:"0.01",style:{minWidth:"45px"}})},`${Q}-${Be+1}`))})},Q)}),s.jsx("td",{className:"px-2 py-3 text-center sticky right-0 bg-white",children:s.jsx("button",{onClick:()=>q(V.id),className:"p-1 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Remover linha",children:s.jsx(It,{className:"w-4 h-4"})})})]},V.id))})]})}),s.jsxs("button",{onClick:$,className:"w-full mt-4 border-2 border-dashed border-gray-300 rounded-lg p-4 text-gray-600 hover:border-blue-500 hover:text-blue-600 transition-colors flex items-center justify-center space-x-2",children:[s.jsx(ze,{className:"w-4 h-4"}),s.jsx("span",{children:"Adicionar Nova Linha de Custo"})]}),s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mt-6",children:[s.jsx("h4",{className:"font-medium text-red-900 mb-3",children:"Resumo dos Custos por Mês"}),s.jsx("div",{className:"space-y-4",children:j.map(V=>s.jsxs("div",{children:[s.jsx("h5",{className:"font-medium text-red-800 mb-2",children:V}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:Array.from({length:12},(Q,te)=>{const se=te+1,ge=new Date(V,te,1).toLocaleDateString("pt-BR",{month:"long"}),we=C.reduce((Be,ss)=>{var uc,mc;const Ps=(uc=ss.years)==null?void 0:uc.find(wi=>wi.year===V),Ni=(mc=Ps==null?void 0:Ps.months)==null?void 0:mc.find(wi=>wi.month===se);return Be+((Ni==null?void 0:Ni.value)||0)},0);return s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"font-bold text-red-600 capitalize",children:w(we)}),s.jsx("div",{className:"text-red-700 text-xs capitalize",children:ge})]},se)})})]},V))}),s.jsxs("div",{className:"mt-4 pt-4 border-t border-red-300 text-center",children:[s.jsx("div",{className:"text-lg font-bold text-red-600",children:w(j.reduce((V,Q)=>V+C.reduce((te,se)=>{var we,Be;const ge=(we=se.years)==null?void 0:we.find(ss=>ss.year===Q);return te+(((Be=ge==null?void 0:ge.months)==null?void 0:Be.reduce((ss,Ps)=>ss+(Ps.value||0),0))||0)},0),0))}),s.jsxs("div",{className:"text-sm text-red-700",children:["Total Geral (",j.join(", "),")"]})]})]}),s.jsxs("div",{className:"flex space-x-4 mt-6",children:[s.jsx("button",{onClick:T,disabled:d,className:"flex-1 bg-red-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-red-700 transition-colors disabled:opacity-50",children:d?"Salvando...":"Salvar Custos"}),s.jsx("button",{onClick:()=>c(null),disabled:d,className:"flex-1 border border-gray-300 text-gray-700 py-3 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Cancelar"})]})]})]})}),U=()=>s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-6xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Parâmetros para Orçamentos"}),s.jsx("button",{onClick:()=>c(null),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(ne,{className:"w-5 h-5 text-gray-500"})})]}),s.jsxs("div",{className:"p-6 space-y-8",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Configurações Base para Orçamentos"}),s.jsx("p",{className:"text-gray-600",children:"Configure cargos, salários base e escalas de trabalho utilizadas nos orçamentos"})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Cargos e Salários Base"}),s.jsxs("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-blue-700 transition-colors",children:[s.jsx(ze,{className:"w-4 h-4 inline mr-2"}),"Adicionar Cargo"]})]}),s.jsx("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-900",children:"Cargo"}),s.jsx("th",{className:"px-6 py-3 text-center text-sm font-medium text-gray-900",children:"Salário Base (R$)"}),s.jsx("th",{className:"px-6 py-3 text-center text-sm font-medium text-gray-900",children:"Status"}),s.jsx("th",{className:"px-6 py-3 text-center text-sm font-medium text-gray-900",children:"Ações"})]})}),s.jsxs("tbody",{className:"divide-y divide-gray-200",children:[s.jsxs("tr",{children:[s.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:"Porteiro"}),s.jsx("td",{className:"px-6 py-4 text-center text-sm font-medium text-gray-900",children:"R$ 1.412,00"}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full",children:"Ativo"})}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx("button",{className:"text-blue-600 hover:text-blue-800 text-sm",children:"Editar"})})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:"Controlador de Acesso"}),s.jsx("td",{className:"px-6 py-4 text-center text-sm font-medium text-gray-900",children:"R$ 1.412,00"}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full",children:"Ativo"})}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx("button",{className:"text-blue-600 hover:text-blue-800 text-sm",children:"Editar"})})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:"Vigilante"}),s.jsx("td",{className:"px-6 py-4 text-center text-sm font-medium text-gray-900",children:"R$ 1.412,00"}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full",children:"Ativo"})}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx("button",{className:"text-blue-600 hover:text-blue-800 text-sm",children:"Editar"})})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:"Supervisor de Segurança"}),s.jsx("td",{className:"px-6 py-4 text-center text-sm font-medium text-gray-900",children:"R$ 2.000,00"}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full",children:"Ativo"})}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx("button",{className:"text-blue-600 hover:text-blue-800 text-sm",children:"Editar"})})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:"Auxiliar de Limpeza"}),s.jsx("td",{className:"px-6 py-4 text-center text-sm font-medium text-gray-900",children:"R$ 1.412,00"}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full",children:"Ativo"})}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx("button",{className:"text-blue-600 hover:text-blue-800 text-sm",children:"Editar"})})]})]})]})})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Escalas de Trabalho"}),s.jsxs("button",{className:"bg-green-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-green-700 transition-colors",children:[s.jsx(ze,{className:"w-4 h-4 inline mr-2"}),"Adicionar Escala"]})]}),s.jsx("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-900",children:"Escala"}),s.jsx("th",{className:"px-6 py-3 text-center text-sm font-medium text-gray-900",children:"Quantidade de Pessoas"}),s.jsx("th",{className:"px-6 py-3 text-center text-sm font-medium text-gray-900",children:"Dias Trabalhados"}),s.jsx("th",{className:"px-6 py-3 text-center text-sm font-medium text-gray-900",children:"Status"}),s.jsx("th",{className:"px-6 py-3 text-center text-sm font-medium text-gray-900",children:"Ações"})]})}),s.jsxs("tbody",{className:"divide-y divide-gray-200",children:[s.jsxs("tr",{children:[s.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:"12h segunda a sexta"}),s.jsx("td",{className:"px-6 py-4 text-center text-sm font-medium text-gray-900",children:"1,37"}),s.jsx("td",{className:"px-6 py-4 text-center text-sm font-medium text-gray-900",children:"21"}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full",children:"Ativa"})}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx("button",{className:"text-blue-600 hover:text-blue-800 text-sm",children:"Editar"})})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:"12x36 segunda a domingo"}),s.jsx("td",{className:"px-6 py-4 text-center text-sm font-medium text-gray-900",children:"2,00"}),s.jsx("td",{className:"px-6 py-4 text-center text-sm font-medium text-gray-900",children:"30,44"}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full",children:"Ativa"})}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx("button",{className:"text-blue-600 hover:text-blue-800 text-sm",children:"Editar"})})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:"44hs segunda a sexta"}),s.jsx("td",{className:"px-6 py-4 text-center text-sm font-medium text-gray-900",children:"1,00"}),s.jsx("td",{className:"px-6 py-4 text-center text-sm font-medium text-gray-900",children:"22"}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full",children:"Ativa"})}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx("button",{className:"text-blue-600 hover:text-blue-800 text-sm",children:"Editar"})})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:"44hs segunda a sábado"}),s.jsx("td",{className:"px-6 py-4 text-center text-sm font-medium text-gray-900",children:"1,00"}),s.jsx("td",{className:"px-6 py-4 text-center text-sm font-medium text-gray-900",children:"25"}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full",children:"Ativa"})}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx("button",{className:"text-blue-600 hover:text-blue-800 text-sm",children:"Editar"})})]}),s.jsxs("tr",{children:[s.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:"44hs segunda a domingo"}),s.jsx("td",{className:"px-6 py-4 text-center text-sm font-medium text-gray-900",children:"1,30"}),s.jsx("td",{className:"px-6 py-4 text-center text-sm font-medium text-gray-900",children:"30,44"}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full",children:"Ativa"})}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx("button",{className:"text-blue-600 hover:text-blue-800 text-sm",children:"Editar"})})]})]})]})})]}),s.jsxs("div",{className:"flex space-x-4",children:[s.jsx("button",{disabled:d,className:"flex-1 bg-purple-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-purple-700 transition-colors disabled:opacity-50",children:d?"Salvando...":"Salvar Parâmetros"}),s.jsx("button",{onClick:()=>c(null),disabled:d,className:"flex-1 border border-gray-300 text-gray-700 py-3 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Cancelar"})]})]})]})}),N=async()=>{try{u(!0),await Bt.updateCommissionTiers(x),console.log("Comissões salvas no Supabase:",x),alert("Configurações de comissão atualizadas com sucesso!"),c(null)}catch(V){console.error("Erro ao salvar comissões:",V),alert("Erro ao salvar comissões. Tente novamente.")}finally{u(!1)}},_=async()=>{try{u(!0),await Bt.updateWeeklyMetrics(p),console.log("Métricas salvas no Supabase:",p),alert("Métricas de performance atualizadas com sucesso!"),c(null)}catch(V){console.error("Erro ao salvar métricas:",V),alert("Erro ao salvar métricas. Tente novamente.")}finally{u(!1)}},T=async()=>{try{u(!0),await Bt.updateOperationalCosts(C),console.log("Custos salvos no Supabase:",C),alert("Custos operacionais atualizados com sucesso!"),c(null)}catch(V){console.error("Erro ao salvar custos:",V),alert("Erro ao salvar custos. Tente novamente.")}finally{u(!1)}},I=()=>{const V={id:Date.now().toString(),percentage:.5,minValue:0,maxValue:1e5,label:"0 - 100k"};f([...x,V])},P=V=>{f(x.filter(Q=>Q.id!==V))},z=()=>{const V={id:Date.now().toString(),name:"Nova Métrica",points:1,role:"Both"};S([...p,V])},R=V=>{S(p.filter(Q=>Q.id!==V))},$=()=>{const V={id:Date.now().toString(),name:"Novo Custo",years:j.map(Q=>({year:Q,months:Array.from({length:12},(te,se)=>({month:se+1,value:0}))}))};v([...C,V])},q=V=>{v(C.filter(Q=>Q.id!==V))},Y=(V,Q)=>{v(C.map(te=>te.id===V?{...te,name:Q}:te))},F=(V,Q,te,se)=>{v(C.map(ge=>ge.id===V?{...ge,years:ge.years.map(we=>we.year===Q?{...we,months:we.months.map(Be=>Be.month===te?{...Be,value:se}:Be)}:we)}:ge))},G=()=>{const V=Math.max(...j)+1;A([...j,V]),v(C.map(Q=>({...Q,years:[...Q.years,{year:V,months:Array.from({length:12},(te,se)=>({month:se+1,value:0}))}]})))},W=()=>s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Configurar Metas Comerciais"}),s.jsx("button",{onClick:()=>c(null),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(ne,{className:"w-5 h-5 text-gray-500"})})]}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:["Metas Mensais - ",e]}),s.jsx("p",{className:"text-gray-600",children:"Configure o valor de contratos que deve ser fechado em cada mês"})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:y.map(V=>s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:V.monthName}),s.jsx("input",{type:"number",value:V.targetValue,onChange:Q=>{L(V.month,Number(Q.target.value)||0)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"300000",min:"0",step:"1000"}),s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:w(V.targetValue)})]},V.month))}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[s.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Resumo Anual"}),s.jsxs("div",{className:"text-sm text-blue-800",children:[s.jsxs("p",{children:["Total anual: ",w(y.reduce((V,Q)=>V+Q.targetValue,0))]}),s.jsxs("p",{children:["Média mensal: ",w(y.reduce((V,Q)=>V+Q.targetValue,0)/12)]}),s.jsxs("p",{children:["Ano: ",e]})]})]}),s.jsxs("div",{className:"flex space-x-4",children:[s.jsx("button",{onClick:E,disabled:d||h,className:"flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:opacity-50",children:d||h?"Salvando...":"Salvar Metas"}),s.jsx("button",{onClick:()=>c(null),disabled:d,className:"flex-1 border border-gray-300 text-gray-700 py-3 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Cancelar"})]})]})]})}),ee=()=>s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Configurar Comissões"}),s.jsx("button",{onClick:()=>c(null),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(ne,{className:"w-5 h-5 text-gray-500"})})]}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Faixas de Comissão"}),s.jsx("p",{className:"text-gray-600",children:"Configure as porcentagens e faixas de valor para comissões"})]}),s.jsx("div",{className:"space-y-4 mb-6",children:x.map((V,Q)=>s.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:s.jsxs("div",{className:"grid grid-cols-3 gap-4 items-center",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"% Comissão"}),s.jsx("input",{type:"number",step:"0.1",value:V.percentage,onChange:te=>{const se=x.map(ge=>ge.id===V.id?{...ge,percentage:Number(te.target.value)}:ge);f(se)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Faixa de Valor"}),s.jsx("input",{type:"text",value:V.label,onChange:te=>{const se=x.map(ge=>ge.id===V.id?{...ge,label:te.target.value}:ge);f(se)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0 - 600k"})]}),s.jsx("div",{className:"flex justify-end",children:x.length>1&&s.jsx("button",{onClick:()=>P(V.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:s.jsx(It,{className:"w-4 h-4"})})})]})},V.id))}),s.jsxs("button",{onClick:I,className:"w-full mb-6 border-2 border-dashed border-gray-300 rounded-lg p-4 text-gray-600 hover:border-blue-500 hover:text-blue-600 transition-colors flex items-center justify-center space-x-2",children:[s.jsx(ze,{className:"w-4 h-4"}),s.jsx("span",{children:"Adicionar Nova Faixa"})]}),s.jsxs("div",{className:"flex space-x-4",children:[s.jsx("button",{onClick:N,disabled:d,className:"flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:opacity-50",children:d?"Salvando...":"Salvar Comissões"}),s.jsx("button",{onClick:()=>c(null),disabled:d,className:"flex-1 border border-gray-300 text-gray-700 py-3 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Cancelar"})]})]})]})}),X=()=>s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-7xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Gerenciar Funcionários"}),s.jsx("button",{onClick:()=>c(null),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(ne,{className:"w-5 h-5 text-gray-500"})})]}),s.jsx("div",{className:"p-6",children:s.jsx(Ry,{})})]})}),le=()=>s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-7xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Gerenciar Usuários"}),s.jsx("button",{onClick:()=>c(null),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(ne,{className:"w-5 h-5 text-gray-500"})})]}),s.jsx("div",{className:"p-6",children:s.jsx(Oy,{})})]})}),ce=()=>s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Configurar Performance Semanal"}),s.jsx("button",{onClick:()=>c(null),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(ne,{className:"w-5 h-5 text-gray-500"})})]}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Métricas de Performance"}),s.jsx("p",{className:"text-gray-600",children:"Configure as métricas e seus pesos para avaliação semanal"})]}),s.jsx("div",{className:"space-y-4 mb-6",children:p.map(V=>s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[s.jsxs("div",{className:"grid grid-cols-4 gap-4 items-center",children:[s.jsxs("div",{className:"col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome da Métrica"}),s.jsx("input",{type:"text",value:V.name,onChange:Q=>{const te=p.map(se=>se.id===V.id?{...se,name:Q.target.value}:se);S(te)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pontos"}),s.jsx("input",{type:"number",value:V.points,onChange:Q=>{const te=p.map(se=>se.id===V.id?{...se,points:Number(Q.target.value)}:se);S(te)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Função"}),s.jsxs("select",{value:V.role,onChange:Q=>{const te=p.map(se=>se.id===V.id?{...se,role:Q.target.value}:se);S(te)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"Closer",children:"Closer"}),s.jsx("option",{value:"SDR",children:"SDR"}),s.jsx("option",{value:"Both",children:"Ambos"})]})]})]}),s.jsx("div",{className:"flex justify-end mt-3",children:s.jsx("button",{onClick:()=>R(V.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:s.jsx(It,{className:"w-4 h-4"})})})]},V.id))}),s.jsxs("button",{onClick:z,className:"w-full mb-6 border-2 border-dashed border-gray-300 rounded-lg p-4 text-gray-600 hover:border-blue-500 hover:text-blue-600 transition-colors flex items-center justify-center space-x-2",children:[s.jsx(ze,{className:"w-4 h-4"}),s.jsx("span",{children:"Adicionar Nova Métrica"})]}),s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:[s.jsx("h4",{className:"font-medium text-green-900 mb-2",children:"Resumo das Métricas"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm text-green-800",children:[s.jsxs("div",{children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Closers:"})," ",p.filter(V=>V.role==="Closer"||V.role==="Both").length," métricas"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"SDRs:"})," ",p.filter(V=>V.role==="SDR"||V.role==="Both").length," métricas"]})]}),s.jsxs("div",{children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Total de pontos possíveis (Closer):"})," ",p.filter(V=>V.role==="Closer"||V.role==="Both").reduce((V,Q)=>V+Q.points,0)]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Total de pontos possíveis (SDR):"})," ",p.filter(V=>V.role==="SDR"||V.role==="Both").reduce((V,Q)=>V+Q.points,0)]})]})]})]}),s.jsxs("div",{className:"flex space-x-4",children:[s.jsx("button",{onClick:_,disabled:d,className:"flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:opacity-50",children:d?"Salvando...":"Salvar Métricas"}),s.jsx("button",{onClick:()=>c(null),disabled:d,className:"flex-1 border border-gray-300 text-gray-700 py-3 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Cancelar"})]})]})]})});return s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[i&&s.jsxs("button",{onClick:()=>o(null),className:"flex items-center space-x-2 text-blue-600 hover:text-blue-800 transition-colors",children:[s.jsx(gf,{className:"w-4 h-4"}),s.jsx("span",{children:"Voltar"})]}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:i?dt(i):"Configurações"}),s.jsx("p",{className:"text-gray-600",children:i?ts(i):n?"Gerencie funcionários, usuários e configurações do sistema":"Visualize as configurações do sistema (somente leitura)"})]})]}),a&&!n&&s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(tl,{className:"w-5 h-5 text-yellow-600"}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Modo Somente Leitura"}),s.jsx("p",{className:"text-sm text-yellow-700",children:"Para editar configurações, mude para o modo administrativo na barra lateral."})]})]})}),s.jsx(Iy,{}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsx("button",{onClick:()=>a&&c("goals"),className:`bg-white rounded-xl shadow-sm border border-gray-200 p-6 transition-shadow text-left ${a?"hover:shadow-md cursor-pointer":"cursor-not-allowed opacity-75"}`,disabled:!a,children:s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-lg flex items-center justify-center",children:s.jsx($e,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Meta Comercial"}),s.jsx("p",{className:"text-gray-600",children:n?"Configure as metas mensais de vendas":"Visualizar metas mensais"})]})]})}),s.jsx("button",{onClick:()=>a&&c("commissions"),className:`bg-white rounded-xl shadow-sm border border-gray-200 p-6 transition-shadow text-left ${a?"hover:shadow-md cursor-pointer":"cursor-not-allowed opacity-75"}`,disabled:!a,children:s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-lg flex items-center justify-center",children:s.jsx(De,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Comissões"}),s.jsx("p",{className:"text-gray-600",children:n?"Configure faixas e percentuais de comissão":"Visualizar configurações de comissão"})]})]})}),s.jsx("button",{onClick:()=>a&&c("employees"),className:`bg-white rounded-xl shadow-sm border border-gray-200 p-6 transition-shadow text-left ${a?"hover:shadow-md cursor-pointer":"cursor-not-allowed opacity-75"}`,disabled:!a,children:s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-12 h-12 bg-purple-500 rounded-lg flex items-center justify-center",children:s.jsx(Ve,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Funcionários"}),s.jsx("p",{className:"text-gray-600",children:n?"Gerencie cadastro de funcionários":"Visualizar funcionários"})]})]})}),s.jsx("button",{onClick:()=>a&&c("performance"),className:`bg-white rounded-xl shadow-sm border border-gray-200 p-6 transition-shadow text-left ${a?"hover:shadow-md cursor-pointer":"cursor-not-allowed opacity-75"}`,disabled:!a,children:s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-12 h-12 bg-purple-500 rounded-lg flex items-center justify-center",children:s.jsx(Pe,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Performance Semanal"}),s.jsx("p",{className:"text-gray-600",children:n?"Configure métricas e pesos de avaliação":"Visualizar métricas de performance"})]})]})}),s.jsx("button",{onClick:()=>a&&c("users"),className:`bg-white rounded-xl shadow-sm border border-gray-200 p-6 transition-shadow text-left ${a?"hover:shadow-md cursor-pointer":"cursor-not-allowed opacity-75"}`,disabled:!a,children:s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-12 h-12 bg-purple-500 rounded-lg flex items-center justify-center",children:s.jsx(ih,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Gerenciar Usuários"}),s.jsx("p",{className:"text-gray-600",children:n?"Configure usuários e permissões":"Visualizar usuários"})]})]})}),s.jsx("button",{onClick:()=>a&&c("costs"),className:`bg-white rounded-xl shadow-sm border border-gray-200 p-6 transition-shadow text-left ${a?"hover:shadow-md cursor-pointer":"cursor-not-allowed opacity-75"}`,disabled:!a,children:s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-12 h-12 bg-red-500 rounded-lg flex items-center justify-center",children:s.jsx(De,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Custos Operacionais"}),s.jsx("p",{className:"text-gray-600",children:n?"Configure custos mensais para CAC":"Visualizar custos operacionais"})]})]})}),s.jsx("button",{onClick:()=>a&&c("budget-params"),className:`bg-white rounded-xl shadow-sm border border-gray-200 p-6 transition-shadow text-left ${a?"hover:shadow-md cursor-pointer":"cursor-not-allowed opacity-75"}`,disabled:!a,children:s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-12 h-12 bg-purple-500 rounded-lg flex items-center justify-center",children:s.jsx(Us,{className:"w-6 h-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Parâmetros para Orçamentos"}),s.jsx("p",{className:"text-gray-600",children:n?"Configure cargos e escalas para orçamentos":"Visualizar parâmetros de orçamento"})]})]})})]}),l==="goals"&&W(),l==="commissions"&&ee(),l==="employees"&&X(),l==="users"&&le(),l==="performance"&&ce(),l==="costs"&&O(),l==="budget-params"&&U()]});function dt(V){switch(V){case"employees":return"Gerenciar Funcionários";case"users":return"Gerenciar Usuários";case"profile":return"Configurações do Perfil";case"goals":return"Metas Mensais";case"commissions":return"Configuração de Comissões";case"weekly-metrics":return"Métricas Semanais";case"operational-costs":return"Custos Operacionais";case"budget-params":return"Parâmetros para Orçamentos";default:return"Configurações"}}function ts(V){switch(V){case"employees":return"Adicione, edite e gerencie SDRs e Closers";case"users":return"Controle de acesso e permissões do sistema";case"profile":return"Gerencie suas informações pessoais e configurações de conta";case"goals":return"Configure metas mensais de vendas por ano";case"commissions":return"Defina escalas e percentuais de comissão";case"weekly-metrics":return"Configure pontuação e pesos das métricas semanais";case"operational-costs":return"Gerencie custos operacionais mensais";case"budget-params":return"Configure cargos e escalas utilizados nos orçamentos";default:return""}}},Ht={async getAllChallenges(){const{data:e,error:t}=await ie.from("challenges").select("*").order("end_date",{ascending:!0});if(t)throw t;return e||[]},async getChallengeById(e){const{data:t,error:r}=await ie.from("challenges").select("*").eq("id",e).single();if(r)throw r;return t},async createChallenge(e){try{console.log("🚀 Criando desafio no Supabase:",e);const{data:t,error:r}=await ie.from("challenges").insert(e).select().single();if(r)throw console.error("❌ Erro do Supabase ao criar desafio:",{error:r,errorMessage:r.message,errorCode:r.code,errorDetails:r.details,errorHint:r.hint,challengeData:e}),r;return console.log("✅ Desafio criado com sucesso:",t),t}catch(t){throw console.error("💥 Erro inesperado ao criar desafio:",t),t}},async updateChallenge(e,t){const{data:r,error:n}=await ie.from("challenges").update(t).eq("id",e).select().single();if(n)throw n;return r},async deleteChallenge(e){const{error:t}=await ie.from("challenges").delete().eq("id",e);if(t)throw t},async markChallengeCompleted(e,t){const{data:r,error:n}=await ie.from("challenges").update({status:"completed",completion_date:t}).eq("id",e).select().single();if(n)throw n;return r},async markChallengeExpired(e){const{data:t,error:r}=await ie.from("challenges").update({status:"expired"}).eq("id",e).select().single();if(r)throw r;return t},async assignWinners(e,t){const{data:r,error:n}=await ie.from("challenges").update({winner_ids:t}).eq("id",e).select().single();if(n)throw n;return r},async getChallengesByStatus(e){const{data:t,error:r}=await ie.from("challenges").select("*").eq("status",e).order("end_date",{ascending:!0});if(r)throw r;return t||[]},async calculateChallengeProgress(e,t,r,n,a){const i=new Date(e.start_date),o=new Date(e.end_date);let l=e.participants_ids&&e.participants_ids.length>0?e.participants_ids:t.filter(u=>u.role!=="Admin").map(u=>u.id);a&&(l=l.filter(u=>u===a)),console.log("🎯 Calculando progresso do desafio:",{challengeId:e.id,targetType:e.target_type,participantIds:l,participantCount:l.length,hasSpecificParticipants:e.participants_ids&&e.participants_ids.length>0,specificEmployeeId:a||"todos"});const c=r.filter(u=>{const m=new Date(u.week_ending_date),h=l.includes(u.employee_id),g=m>=i&&m<=o;return h&&g});console.log("📊 Performance relevante filtrada:",{totalPerformanceRecords:r.length,filteredPerformanceRecords:c.length,participantIds:l,dateRange:{startDate:i.toISOString().split("T")[0],endDate:o.toISOString().split("T")[0]}});const d=[...new Set(c.map(u=>u.employee_id))];if(console.log("👥 Participantes com dados no período:",{expectedParticipants:l,actualParticipants:d,missingParticipants:l.filter(u=>!d.includes(u))}),e.target_type==="points"){const u=c.reduce((m,h)=>m+(h.total_points||0),0);return console.log("🎯 Progresso de pontos:",{totalPoints:u,recordsCount:c.length}),u}else if(e.target_type==="mql"){const u=c.reduce((m,h)=>m+(h.mql||0),0);return console.log("📞 Progresso de MQL:",{totalMQL:u,recordsCount:c.length}),u}else if(e.target_type==="visitas_agendadas"){const u=c.reduce((m,h)=>m+(h.visitas_agendadas||0),0);return console.log("📅 Progresso de visitas agendadas:",{totalVisitas:u,recordsCount:c.length}),u}else if(e.target_type==="contratos_assinados"){const u=c.reduce((m,h)=>m+(h.contrato_assinado||0),0);return console.log("🤝 Progresso de contratos assinados:",{totalContratos:u,recordsCount:c.length}),u}else if(e.target_type==="pontos_educacao"){const u=c.reduce((m,h)=>m+(h.pontos_educacao||0),0);return console.log("🎓 Progresso de pontos de educação:",{totalEducacao:u,recordsCount:c.length}),u}else if(e.target_type==="sales"){const u=n.filter(h=>{if(h.status!=="Fechado")return!1;const g=h.closing_date?new Date(h.closing_date):new Date(h.created_at),b=g>=i&&g<=o,y=l.includes(h.closer_id)||h.sdr_id&&l.includes(h.sdr_id);return console.log("💰 Verificando proposta para vendas:",{client:h.client,closerId:h.closer_id,sdrId:h.sdr_id,isParticipant:y,isInPeriod:b,participantIds:l}),b&&y}),m=u.reduce((h,g)=>h+(g.total_value||0),0);return console.log("💰 Progresso de vendas:",{totalSales:m,proposalsCount:u.length,proposals:u.map(h=>({client:h.client,value:h.total_value,closer:h.closer_id,sdr:h.sdr_id}))}),m}return console.log("❌ Tipo de meta não reconhecido:",e.target_type),0}},Fy=({challenge:e,employees:t,weeklyPerformance:r,proposals:n,onEdit:a,onDelete:i,onAssignWinners:o,onDuplicate:l,readOnly:c=!1})=>{const[d,u]=M.useState(0),[m,h]=M.useState(0),[g,b]=M.useState(!1),[y,k]=M.useState([]),[x,f]=M.useState(!1),[p,S]=M.useState(!1);M.useEffect(()=>{const _=async()=>{try{console.log("🎯 [ChallengeCard] Calculando progresso para:",{challengeTitle:e.title,challengeId:e.id,targetType:e.targetType,targetValue:e.targetValue,participantsIds:e.participantsIds,hasSpecificParticipants:e.participantsIds&&e.participantsIds.length>0});const R={id:e.id,title:e.title,description:e.description||null,start_date:e.startDate,end_date:e.endDate,prize:e.prize,target_type:e.targetType,target_value:e.targetValue,status:e.status,participants_ids:e.participantsIds||null,winner_ids:e.winnerIds||null,completion_date:e.completionDate||null,created_at:e.createdAt,updated_at:e.updatedAt},$=await Ht.calculateChallengeProgress(R,t,r,n);if(console.log("📊 [ChallengeCard] Progresso calculado:",{challengeTitle:e.title,currentProgress:$,targetValue:e.targetValue,progressPercentage:Math.min($/e.targetValue*100,100).toFixed(1)+"%"}),u($),e.status==="active"){const q=e.participantsIds&&e.participantsIds.length>0?e.participantsIds:t.filter(F=>F.role!=="Admin").map(F=>F.id),Y=[];for(const F of q){const G=t.find(W=>W.id===F);if(G){const W=await Ht.calculateChallengeProgress(R,t,r,n,F);Y.push({employeeId:F,name:G.name,progress:W})}}Y.sort((F,G)=>G.progress-F.progress),k(Y)}}catch(R){console.error("Erro ao calcular progresso:",R),u(0),k([])}},T=new Date(e.endDate),I=new Date,P=T.getTime()-I.getTime(),z=Math.ceil(P/(1e3*60*60*24));h(z),e.status==="active"&&_()},[e,t,r,n]);const C=_=>{switch(_){case"active":return"bg-blue-100 text-blue-800 border-blue-200";case"completed":return"bg-green-100 text-green-800 border-green-200";case"expired":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},v=_=>{switch(_){case"active":return s.jsx(Lt,{className:"w-4 h-4"});case"completed":return s.jsx(Yt,{className:"w-4 h-4"});case"expired":return s.jsx(Dn,{className:"w-4 h-4"});default:return s.jsx(ft,{className:"w-4 h-4"})}},j=_=>{switch(_){case"active":return"Ativo";case"completed":return"Concluído";case"expired":return"Expirado";default:return"Desconhecido"}},A=_=>st(_),L=()=>Math.min(d/e.targetValue*100,100),E=()=>{if(!e.participantsIds||e.participantsIds.length===0)return"Todos os funcionários";const _=e.participantsIds.map(T=>{var I;return(I=t.find(P=>P.id===T))==null?void 0:I.name}).filter(Boolean);return _.length<=2?_.join(", "):`${_[0]} e mais ${_.length-1}`},O=!e.winnerIds||e.winnerIds.length===0?null:e.winnerIds.map(T=>t.find(I=>I.id===T)).filter(Boolean),U=(_,T=80)=>_.length<=T?_:_.substring(0,T).trim(),N=(_,T=80)=>_.length>T;return s.jsxs("div",{className:`bg-white rounded-xl shadow-sm border-2 h-[520px] flex flex-col ${e.status==="completed"?"border-green-200":e.status==="expired"?"border-red-200":m<=5&&e.status==="active"?"border-orange-200":"border-gray-200"} overflow-hidden hover:shadow-md transition-all relative`,children:[s.jsx("div",{className:"absolute top-4 right-4 z-10",children:s.jsxs("span",{className:`inline-flex items-center space-x-1 px-3 py-1 rounded-full text-sm font-medium border ${C(e.status)}`,children:[v(e.status),s.jsx("span",{children:j(e.status)})]})}),s.jsxs("div",{className:"p-6 flex-1 flex flex-col",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2 pr-20",children:e.title}),e.description&&s.jsx("div",{className:"text-sm text-gray-600 mb-3",children:s.jsxs("p",{children:[x?e.description:U(e.description),N(e.description)&&s.jsx("button",{onClick:()=>f(!x),className:"ml-1 text-blue-600 hover:text-blue-800 font-medium",children:x?"menos":"... mais"})]})})]}),s.jsxs("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[s.jsx(At,{className:"w-4 h-4 text-yellow-600"}),s.jsx("span",{className:"text-sm font-medium text-yellow-800",children:"Prêmio"})]}),s.jsx("div",{className:"text-sm text-yellow-900 font-medium",children:s.jsxs("p",{children:[p?e.prize:U(e.prize,60),N(e.prize,60)&&s.jsx("button",{onClick:()=>S(!p),className:"ml-1 text-yellow-700 hover:text-yellow-900 font-medium",children:p?"menos":"... mais"})]})})]}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[e.targetType==="points"?s.jsx($e,{className:"w-4 h-4 text-purple-600"}):e.targetType==="sales"?s.jsx(De,{className:"w-4 h-4 text-green-600"}):e.targetType==="mql"?s.jsx(Ve,{className:"w-4 h-4 text-blue-600"}):e.targetType==="visitas_agendadas"?s.jsx(Pe,{className:"w-4 h-4 text-indigo-600"}):s.jsx(ft,{className:"w-4 h-4 text-orange-600"}),s.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Meta: ",e.targetType==="points"?`${e.targetValue.toLocaleString()} pontos`:e.targetType==="sales"?D(e.targetValue):e.targetType==="mql"?`${e.targetValue.toLocaleString()} MQLs`:e.targetType==="visitas_agendadas"?`${e.targetValue.toLocaleString()} visitas`:e.targetType==="pontos_educacao"?`${e.targetValue.toLocaleString()} pontos de educação`:`${e.targetValue.toLocaleString()} contratos`]})]}),e.status==="active"&&s.jsx("span",{className:"text-sm text-gray-600",children:e.targetType==="points"?`${d.toLocaleString()} pts`:e.targetType==="sales"?D(d):e.targetType==="mql"?`${d.toLocaleString()} MQLs`:e.targetType==="visitas_agendadas"?`${d.toLocaleString()} visitas`:e.targetType==="pontos_educacao"?`${d.toLocaleString()} pts educação`:`${d.toLocaleString()} contratos`})]}),e.status==="active"&&s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:`h-2 rounded-full transition-all ${L()>=100?"bg-green-500":L()>=75?"bg-blue-500":L()>=50?"bg-yellow-500":"bg-orange-500"}`,style:{width:`${L()}%`}})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Início:"}),s.jsx("div",{className:"font-medium",children:A(e.startDate)})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Fim:"}),s.jsx("div",{className:"font-medium",children:A(e.endDate)})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[s.jsx(Ve,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Participantes"})]}),s.jsx("button",{onClick:()=>b(!0),className:"text-sm text-gray-600 hover:text-blue-600 hover:underline transition-colors text-left w-full",title:"Clique para ver todos os participantes",children:E()})]}),O&&O.length>0&&s.jsxs("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsx(Yt,{className:"w-4 h-4 text-green-600"}),s.jsxs("span",{className:"text-sm font-medium text-green-800",children:["Vencedor",O.length>1?"es":""]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[O.slice(0,3).map((_,T)=>s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("img",{src:_.avatar,alt:_.name,className:"w-8 h-8 rounded-full border-2 border-green-300"}),T===0&&s.jsx("span",{className:"text-sm font-medium text-green-900",children:_.name})]},_.id)),O.length>3&&s.jsxs("span",{className:"text-xs text-green-700",children:["+",O.length-3," mais"]})]}),e.completionDate&&s.jsxs("p",{className:"text-xs text-green-700 mt-1",children:["Concluído em ",st(e.completionDate)]})]}),e.status==="expired"&&(!e.winnerIds||e.winnerIds.length===0)&&s.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Dn,{className:"w-4 h-4 text-red-600"}),s.jsx("span",{className:"text-sm font-medium text-red-800",children:"Desafio Expirado sem Vencedor"})]})}),s.jsx("div",{className:"mt-auto",children:!c&&(a||i||o||l)&&s.jsxs("div",{className:"flex items-center space-x-2 pt-4 border-t border-gray-200",children:[l&&s.jsxs("button",{onClick:()=>l(e),className:"flex-1 bg-gray-600 text-white py-2 px-3 rounded-lg text-sm font-medium hover:bg-gray-700 transition-colors flex items-center justify-center space-x-1",title:"Duplicar este desafio",children:[s.jsx(bf,{className:"w-4 h-4"}),s.jsx("span",{children:"Duplicar"})]}),a&&s.jsxs("button",{onClick:()=>a(e),className:"flex-1 bg-blue-600 text-white py-2 px-3 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors flex items-center justify-center space-x-1",children:[s.jsx(Zt,{className:"w-4 h-4"}),s.jsx("span",{children:"Editar"})]}),o&&e.status==="completed"&&(!e.winnerIds||e.winnerIds.length===0)&&s.jsxs("button",{onClick:()=>o(e),className:"flex-1 bg-green-600 text-white py-2 px-3 rounded-lg text-sm font-medium hover:bg-green-700 transition-colors flex items-center justify-center space-x-1",children:[s.jsx(Ve,{className:"w-4 h-4"}),s.jsx("span",{children:"Vencedor"})]}),i&&s.jsx("button",{onClick:()=>i(e.id),className:"px-3 py-2 border border-red-300 text-red-600 rounded-lg text-sm font-medium hover:bg-red-50 transition-colors",children:s.jsx(It,{className:"w-4 h-4"})})]})})]}),g&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4 max-h-[80vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:s.jsx(Ve,{className:"w-5 h-5 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Participantes do Desafio"}),s.jsx("p",{className:"text-sm text-gray-600",children:e.title})]})]}),s.jsx("button",{onClick:()=>b(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(ne,{className:"w-5 h-5 text-gray-500"})})]}),s.jsxs("div",{className:"p-6",children:[!e.participantsIds||e.participantsIds.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(Ve,{className:"w-8 h-8 text-blue-500"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Todos os Funcionários"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Este desafio está aberto para todos os funcionários da empresa"}),s.jsx("div",{className:"space-y-3",children:t.filter(_=>_.role!=="Admin").map(_=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("img",{src:_.avatar,alt:_.name,className:"w-10 h-10 rounded-full"}),s.jsxs("div",{className:"flex-1 text-left",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:_.name}),s.jsxs("div",{className:"text-xs text-gray-500",children:[_.role," • ",_.department]})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-sm font-bold text-blue-600",children:(()=>{const T=y.find(I=>I.employeeId===_.id);return T?e.targetType==="sales"?D(T.progress):`${T.progress.toLocaleString()} ${e.targetType==="points"?"pts":e.targetType==="mql"?"MQLs":e.targetType==="visitas_agendadas"?"visitas":e.targetType==="pontos_educacao"?"pts edu":"contratos"}`:"0"})()}),s.jsx("div",{className:"text-xs text-gray-500",children:"contribuição"})]}),s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${_.role==="Closer"?"bg-blue-100 text-blue-800":_.role==="SDR"?"bg-green-100 text-green-800":"bg-purple-100 text-purple-800"}`,children:_.role})]})]},_.id))})]}):s.jsxs("div",{children:[s.jsxs("div",{className:"mb-4",children:[s.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:["Participantes Selecionados (",e.participantsIds.length,")"]}),s.jsx("p",{className:"text-sm text-gray-600",children:"Apenas os funcionários listados abaixo podem participar deste desafio"})]}),s.jsx("div",{className:"space-y-3",children:e.participantsIds.map(_=>{const T=t.find(P=>P.id===_),I=y.find(P=>P.employeeId===_);return T?s.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg border border-blue-200",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("img",{src:T.avatar,alt:T.name,className:"w-10 h-10 rounded-full border-2 border-blue-300"}),s.jsxs("div",{className:"flex-1 text-left",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:T.name}),s.jsxs("div",{className:"text-xs text-gray-500",children:[T.role," • ",T.department]})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-sm font-bold text-blue-600",children:I?e.targetType==="sales"?D(I.progress):`${I.progress.toLocaleString()} ${e.targetType==="points"?"pts":e.targetType==="mql"?"MQLs":e.targetType==="visitas_agendadas"?"visitas":e.targetType==="pontos_educacao"?"pts edu":"contratos"}`:"0"}),s.jsx("div",{className:"text-xs text-gray-500",children:"contribuição"})]}),s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${T.role==="Closer"?"bg-blue-100 text-blue-800":T.role==="SDR"?"bg-green-100 text-green-800":"bg-purple-100 text-purple-800"}`,children:T.role})]})]},T.id):null})})]}),s.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:s.jsx("button",{onClick:()=>b(!1),className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"Fechar"})})]})]})}),e.status==="active"&&m<=5&&m>0&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-r from-orange-500 to-red-500 text-white p-2 text-center",children:s.jsxs("div",{className:"flex items-center justify-center space-x-1",children:[s.jsx(Lt,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-bold",children:m===1?"ÚLTIMO DIA!":`Faltam ${m} dias!`})]})}),e.status==="completed"&&s.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-r from-green-500 to-emerald-500 text-white p-2 text-center",children:s.jsxs("div",{className:"flex items-center justify-center space-x-1",children:[s.jsx(Yt,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-bold",children:"DESAFIO CONCLUÍDO!"})]})})]})},zy=({isOpen:e,onClose:t,challenge:r,employees:n})=>{const[a,i]=M.useState(!1),[o,l]=M.useState({title:"",description:"",startDate:new Date().toISOString().split("T")[0],endDate:"",prize:"",targetType:"points",targetValue:0,participantsIds:[]});if(M.useEffect(()=>{l(r?{title:r.title,description:r.description||"",startDate:r.startDate,endDate:r.endDate,prize:r.prize,targetType:r.targetType,targetValue:r.targetValue,participantsIds:r.participantsIds||[]}:{title:"",description:"",startDate:new Date().toISOString().split("T")[0],endDate:"",prize:"",targetType:"points",targetValue:0,participantsIds:[]})},[r]),!e)return null;const c=async g=>{var b;if(g.preventDefault(),!o.title.trim()){alert("O título do desafio é obrigatório");return}if(!o.endDate){alert("A data final do desafio é obrigatória");return}if(new Date(o.endDate)<=new Date(o.startDate)){alert("A data final deve ser posterior à data inicial");return}if(o.targetValue<=0){alert("O valor da meta deve ser maior que zero");return}if(!o.prize.trim()){alert("A descrição do prêmio é obrigatória");return}i(!0);try{const y={title:o.title,description:o.description||null,start_date:o.startDate,end_date:o.endDate,prize:o.prize,target_type:o.targetType,target_value:o.targetValue,participants_ids:o.participantsIds.length>0?o.participantsIds:null};r&&r.id?(await Ht.updateChallenge(r.id,y),alert("✅ Desafio atualizado com sucesso!")):(await Ht.createChallenge(y),localStorage.setItem("newChallengeCreatedAt",new Date().toISOString()),alert("✅ Desafio criado com sucesso!")),t()}catch(y){console.error("Erro ao salvar desafio:",y),console.error("Erro completo:",{error:y,errorType:typeof y,errorConstructor:(b=y==null?void 0:y.constructor)==null?void 0:b.name,errorMessage:y instanceof Error?y.message:String(y),errorStack:y instanceof Error?y.stack:void 0,errorCode:y==null?void 0:y.code,errorDetails:y==null?void 0:y.details,errorHint:y==null?void 0:y.hint,supabaseError:y});let k="Erro desconhecido";if(y instanceof Error){if(k=y.message,y.message&&typeof y=="object"){const x=y;x.code&&(k+=` (Código: ${x.code})`),x.details&&(k+=` | Detalhes: ${x.details}`),x.hint&&(k+=` | Dica: ${x.hint}`)}}else if(typeof y=="object"&&y!==null){const x=y;x.message?k=x.message:x.error?k=x.error:k=JSON.stringify(y,null,2)}else k=String(y);alert(`❌ Erro ao salvar desafio: ${k}

🔍 Verifique o console do navegador (F12 > Console) para mais detalhes técnicos.`)}finally{i(!1)}},d=g=>{l(b=>({...b,participantsIds:b.participantsIds.includes(g)?b.participantsIds.filter(y=>y!==g):[...b.participantsIds,g]}))},u=()=>{const g=n.filter(b=>b.role!=="Admin");l(b=>({...b,participantsIds:g.map(y=>y.id)}))},m=()=>{l(g=>({...g,participantsIds:[]}))},h=n.filter(g=>g.role!=="Admin");return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:s.jsx(ft,{className:"w-5 h-5 text-orange-600"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:r&&r.id?"Editar Desafio":"Novo Desafio"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Configure os parâmetros do desafio"})]})]}),s.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(ne,{className:"w-5 h-5 text-gray-500"})})]}),s.jsxs("form",{onSubmit:c,className:"p-6 space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Título do Desafio *"}),s.jsx("input",{type:"text",value:o.title,onChange:g=>l({...o,title:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"Ex: Desafio de Vendas do Trimestre",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descrição (Opcional)"}),s.jsx("textarea",{value:o.description,onChange:g=>l({...o,description:g.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"Detalhes adicionais sobre o desafio..."})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data de Início *"}),s.jsx("input",{type:"date",value:o.startDate,onChange:g=>l({...o,startDate:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data Final *"}),s.jsx("input",{type:"date",value:o.endDate,onChange:g=>l({...o,endDate:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",min:o.startDate,required:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prêmio *"}),s.jsx("textarea",{value:o.prize,onChange:g=>l({...o,prize:g.target.value}),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",placeholder:"Ex: Vale-presente de R$ 500, Dia de folga, Jantar em restaurante...",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Tipo de Meta *"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("label",{className:`relative flex items-center p-4 border rounded-lg cursor-pointer transition-colors ${o.targetType==="points"?"border-orange-500 bg-orange-50":"border-gray-200 hover:bg-gray-50"}`,children:[s.jsx("input",{type:"radio",name:"targetType",value:"points",checked:o.targetType==="points",onChange:g=>l({...o,targetType:g.target.value}),className:"sr-only"}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx($e,{className:`w-5 h-5 ${o.targetType==="points"?"text-orange-600":"text-gray-400"}`}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:"Pontuação"}),s.jsx("div",{className:"text-sm text-gray-600",children:"Total performance semanal"})]})]})]}),s.jsxs("label",{className:`relative flex items-center p-4 border rounded-lg cursor-pointer transition-colors ${o.targetType==="sales"?"border-orange-500 bg-orange-50":"border-gray-200 hover:bg-gray-50"}`,children:[s.jsx("input",{type:"radio",name:"targetType",value:"sales",checked:o.targetType==="sales",onChange:g=>l({...o,targetType:g.target.value}),className:"sr-only"}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(De,{className:`w-5 h-5 ${o.targetType==="sales"?"text-orange-600":"text-gray-400"}`}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:"Vendas"}),s.jsx("div",{className:"text-sm text-gray-600",children:"Contratos fechados"})]})]})]}),s.jsxs("label",{className:`relative flex items-center p-4 border rounded-lg cursor-pointer transition-colors ${o.targetType==="mql"?"border-orange-500 bg-orange-50":"border-gray-200 hover:bg-gray-50"}`,children:[s.jsx("input",{type:"radio",name:"targetType",value:"mql",checked:o.targetType==="mql",onChange:g=>l({...o,targetType:g.target.value}),className:"sr-only"}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Ve,{className:`w-5 h-5 ${o.targetType==="mql"?"text-orange-600":"text-gray-400"}`}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:"MQL"}),s.jsx("div",{className:"text-sm text-gray-600",children:"Marketing Qualified Leads"})]})]})]}),s.jsxs("label",{className:`relative flex items-center p-4 border rounded-lg cursor-pointer transition-colors ${o.targetType==="visitas_agendadas"?"border-orange-500 bg-orange-50":"border-gray-200 hover:bg-gray-50"}`,children:[s.jsx("input",{type:"radio",name:"targetType",value:"visitas_agendadas",checked:o.targetType==="visitas_agendadas",onChange:g=>l({...o,targetType:g.target.value}),className:"sr-only"}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Pe,{className:`w-5 h-5 ${o.targetType==="visitas_agendadas"?"text-orange-600":"text-gray-400"}`}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:"Visitas Agendadas"}),s.jsx("div",{className:"text-sm text-gray-600",children:"Agendamentos realizados"})]})]})]}),s.jsxs("label",{className:`relative flex items-center p-4 border rounded-lg cursor-pointer transition-colors ${o.targetType==="contratos_assinados"?"border-orange-500 bg-orange-50":"border-gray-200 hover:bg-gray-50"}`,children:[s.jsx("input",{type:"radio",name:"targetType",value:"contratos_assinados",checked:o.targetType==="contratos_assinados",onChange:g=>l({...o,targetType:g.target.value}),className:"sr-only"}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(ft,{className:`w-5 h-5 ${o.targetType==="contratos_assinados"?"text-orange-600":"text-gray-400"}`}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:"Contratos Assinados"}),s.jsx("div",{className:"text-sm text-gray-600",children:"Fechamentos confirmados"})]})]})]}),s.jsxs("label",{className:`relative flex items-center p-4 border rounded-lg cursor-pointer transition-colors ${o.targetType==="pontos_educacao"?"border-orange-500 bg-orange-50":"border-gray-200 hover:bg-gray-50"}`,children:[s.jsx("input",{type:"radio",name:"targetType",value:"pontos_educacao",checked:o.targetType==="pontos_educacao",onChange:g=>l({...o,targetType:g.target.value}),className:"sr-only"}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx($e,{className:`w-5 h-5 ${o.targetType==="pontos_educacao"?"text-orange-600":"text-gray-400"}`}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:"Pontos de Educação"}),s.jsx("div",{className:"text-sm text-gray-600",children:"Capacitação e treinamento"})]})]})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:o.targetType==="points"?"Pontuação Alvo *":o.targetType==="sales"?"Valor de Vendas Alvo *":o.targetType==="mql"?"Quantidade de MQL *":o.targetType==="visitas_agendadas"?"Quantidade de Visitas *":o.targetType==="pontos_educacao"?"Pontos de Educação Alvo *":"Quantidade de Contratos *"}),s.jsx("input",{type:"number",value:o.targetValue,onChange:g=>l({...o,targetValue:Number(g.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",min:"1",step:o.targetType==="sales"?"0.01":"1",placeholder:o.targetType==="points"?"Ex: 1000":o.targetType==="sales"?"Ex: 50000":o.targetType==="mql"?"Ex: 50":o.targetType==="visitas_agendadas"?"Ex: 30":o.targetType==="pontos_educacao"?"Ex: 100":"Ex: 10",required:!0}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:o.targetType==="points"?"Soma total dos pontos de performance semanal no período":o.targetType==="sales"?"Valor total em vendas fechadas no período":o.targetType==="mql"?"Quantidade total de MQLs gerados no período":o.targetType==="visitas_agendadas"?"Quantidade total de visitas agendadas no período":o.targetType==="pontos_educacao"?"Soma total dos pontos de educação no período":"Quantidade total de contratos assinados no período"})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Participantes"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{type:"button",onClick:u,className:"text-xs text-orange-600 hover:text-orange-700 font-medium",children:"Selecionar Todos"}),s.jsx("span",{className:"text-gray-300",children:"|"}),s.jsx("button",{type:"button",onClick:m,className:"text-xs text-gray-600 hover:text-gray-700 font-medium",children:"Limpar Seleção"})]})]}),s.jsxs("div",{className:"border border-gray-300 rounded-lg p-4 max-h-40 overflow-y-auto",children:[o.participantsIds.length===0&&s.jsxs("div",{className:"text-sm text-blue-600 bg-blue-50 border border-blue-200 rounded-lg p-3 mb-3",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Ve,{className:"w-4 h-4"}),s.jsx("span",{className:"font-medium",children:"Todos os funcionários podem participar"})]}),s.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"Deixe vazio para incluir todos, ou selecione funcionários específicos"})]}),s.jsx("div",{className:"space-y-2",children:h.map(g=>s.jsxs("label",{className:"flex items-center space-x-3 p-2 hover:bg-gray-50 rounded-lg cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:o.participantsIds.includes(g.id),onChange:()=>d(g.id),className:"rounded border-gray-300 text-orange-600 focus:ring-orange-500"}),s.jsx("img",{src:g.avatar,alt:g.name,className:"w-8 h-8 rounded-full"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:g.name}),s.jsxs("div",{className:"text-xs text-gray-500",children:[g.role," • ",g.department]})]})]},g.id))})]}),o.participantsIds.length>0&&s.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[o.participantsIds.length," funcionário",o.participantsIds.length>1?"s":""," selecionado",o.participantsIds.length>1?"s":""]})]}),s.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[s.jsx("h4",{className:"text-sm font-medium text-orange-900 mb-2",children:"Preview do Desafio"}),s.jsxs("div",{className:"text-sm text-orange-800 space-y-1",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Meta:"})," ",o.targetType==="points"?`${o.targetValue} pontos`:o.targetType==="sales"?`R$ ${o.targetValue.toLocaleString("pt-BR",{minimumFractionDigits:2})}`:o.targetType==="mql"?`${o.targetValue} MQLs`:o.targetType==="visitas_agendadas"?`${o.targetValue} visitas agendadas`:o.targetType==="pontos_educacao"?`${o.targetValue} pontos de educação`:`${o.targetValue} contratos assinados`]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Período:"})," ",o.startDate?new Date(o.startDate).toLocaleDateString("pt-BR"):"?"," até ",o.endDate?new Date(o.endDate).toLocaleDateString("pt-BR"):"?"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Participantes:"})," ",o.participantsIds.length===0?"Todos os funcionários":`${o.participantsIds.length} selecionados`]})]})]}),s.jsxs("div",{className:"flex space-x-4 pt-4",children:[s.jsx("button",{type:"submit",disabled:a,className:"flex-1 bg-orange-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-orange-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:a?"Salvando...":r&&r.id?"Atualizar Desafio":"Criar Desafio"}),s.jsx("button",{type:"button",onClick:t,disabled:a,className:"flex-1 border border-gray-300 text-gray-700 py-3 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancelar"})]})]})]})})},Vy=({isOpen:e,onClose:t,challenge:r,employees:n})=>{const[a,i]=M.useState([]),[o,l]=M.useState(!1);if(!e)return null;const c=r.participantsIds&&r.participantsIds.length>0?n.filter(m=>r.participantsIds.includes(m.id)):n.filter(m=>m.role!=="Admin"),d=m=>{i(h=>h.includes(m)?h.filter(g=>g!==m):[...h,m])},u=async m=>{if(m.preventDefault(),a.length===0){alert("Selecione pelo menos um vencedor");return}l(!0);try{await Ht.assignWinners(r.id,a),alert(`✅ Vencedor${a.length>1?"es":""} atribuído${a.length>1?"s":""} com sucesso!`),t()}catch(h){console.error("Erro ao atribuir vencedores:",h),alert(`❌ Erro ao atribuir vencedores: ${h instanceof Error?h.message:"Erro desconhecido"}`)}finally{l(!1)}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4 max-h-[80vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:s.jsx(Yt,{className:"w-5 h-5 text-green-600"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Atribuir Vencedores"}),s.jsx("p",{className:"text-sm text-gray-600",children:r.title})]})]}),s.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(ne,{className:"w-5 h-5 text-gray-500"})})]}),s.jsxs("form",{onSubmit:u,className:"p-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsx(Yt,{className:"w-4 h-4 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-green-800",children:"Desafio Concluído!"})]}),s.jsxs("p",{className:"text-sm text-green-700",children:["A meta de ",s.jsx("strong",{children:r.targetType==="points"?`${r.targetValue.toLocaleString()} pontos`:r.targetType==="sales"?`R$ ${r.targetValue.toLocaleString("pt-BR",{minimumFractionDigits:2})}`:r.targetType==="mql"?`${r.targetValue.toLocaleString()} MQLs`:r.targetType==="visitas_agendadas"?`${r.targetValue.toLocaleString()} visitas agendadas`:`${r.targetValue.toLocaleString()} contratos assinados`})," foi atingida. Selecione quem são os vencedores deste desafio."]})]}),s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Selecionar Vencedores *"}),s.jsx("div",{className:"border border-gray-300 rounded-lg p-4 max-h-64 overflow-y-auto",children:s.jsx("div",{className:"space-y-3",children:c.map(m=>s.jsxs("label",{className:"flex items-center space-x-3 p-3 hover:bg-gray-50 rounded-lg cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:a.includes(m.id),onChange:()=>d(m.id),className:"rounded border-gray-300 text-green-600 focus:ring-green-500"}),s.jsx("img",{src:m.avatar,alt:m.name,className:"w-10 h-10 rounded-full"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:m.name}),s.jsxs("div",{className:"text-xs text-gray-500",children:[m.role," • ",m.department]})]})]},m.id))})}),a.length>0&&s.jsxs("p",{className:"text-sm text-green-600 mt-2 font-medium",children:[a.length," vencedor",a.length>1?"es":""," selecionado",a.length>1?"s":""]})]}),s.jsxs("div",{className:"flex space-x-4",children:[s.jsx("button",{type:"submit",disabled:o||a.length===0,className:"flex-1 bg-green-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:o?"Salvando...":"Confirmar Vencedores"}),s.jsx("button",{type:"button",onClick:t,disabled:o,className:"flex-1 border border-gray-300 text-gray-700 py-3 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancelar"})]})]})]})})},Uy=()=>{const{canEdit:e,canView:t}=Js(),r=e("challenges"),n=t("challenges"),[a,i]=M.useState(!1),[o,l]=M.useState(!1),[c,d]=M.useState(null),[u,m]=M.useState(null),[h,g]=M.useState("all"),[b,y]=M.useState(""),{data:k=[],loading:x,refetch:f}=J("challenges",{orderBy:{column:"end_date",ascending:!0}}),{data:p=[]}=J("employees"),{data:S=[]}=J("weekly_performance"),{data:C=[]}=J("proposals"),v=k.map(T=>({id:T.id,title:T.title,description:T.description||void 0,startDate:T.start_date,endDate:T.end_date,prize:T.prize,targetType:T.target_type,targetValue:T.target_value,status:T.status,participantsIds:T.participants_ids||void 0,winnerIds:T.winner_ids||void 0,completionDate:T.completion_date||void 0,createdAt:T.created_at,updatedAt:T.updated_at})),j=async()=>{try{const T=v.filter(z=>z.status==="active");let I=0,P=0;for(const z of T){const R=new Date,$=new Date(z.endDate);if(R>$){await Ht.markChallengeExpired(z.id),P++;continue}await Ht.calculateChallengeProgress(k.find(Y=>Y.id===z.id),p,S,C)>=z.targetValue&&(await Ht.markChallengeCompleted(z.id,new Date().toISOString()),I++)}if(I>0||P>0){const z=[];I>0&&z.push(`🎉 ${I} desafio${I>1?"s":""} concluído${I>1?"s":""}!`),P>0&&z.push(`⏰ ${P} desafio${P>1?"s":""} expirado${P>1?"s":""}`),y(z.join(" • ")),await f(),setTimeout(()=>y(""),5e3)}}catch(T){console.error("Erro ao avaliar desafios:",T)}};M.useEffect(()=>{if(v.length>0&&p.length>0){j();const T=setInterval(j,5*60*1e3);return()=>clearInterval(T)}},[v.length,p.length,S.length,C.length]);const L=v.filter(T=>h==="all"?!0:T.status===h).sort((T,I)=>{const P={active:1,expired:2,completed:3},z=P[T.status]||999,R=P[I.status]||999;if(z!==R)return z-R;const $=new Date(T.endDate),q=new Date(I.endDate);return $.getTime()-q.getTime()}),E=()=>{d(null),i(!0)},w=T=>{d(T),i(!0)},O=async T=>{const I=v.find(z=>z.id===T);if(!I)return;const P=prompt(`⚠️ EXCLUIR DESAFIO

Tem certeza que deseja excluir o desafio "${I.title}"?

Esta ação não pode ser desfeita.

Digite "EXCLUIR" para confirmar:`);if(P==="EXCLUIR")try{await Ht.deleteChallenge(T),await f(),alert("✅ Desafio excluído com sucesso!")}catch(z){console.error("Erro ao excluir desafio:",z),alert(`❌ Erro ao excluir desafio: ${z instanceof Error?z.message:"Erro desconhecido"}`)}else P!==null&&alert('Exclusão cancelada. Digite exatamente "EXCLUIR" para confirmar.')},U=T=>{m(T),l(!0)},N=T=>{const I=new Date,P=new Date(I);P.setDate(I.getDate()+7);const z={...T,id:"",title:`${T.title} (Cópia)`,startDate:I.toISOString().split("T")[0],endDate:P.toISOString().split("T")[0],status:"active",winnerIds:void 0,completionDate:void 0,createdAt:I.toISOString(),updatedAt:I.toISOString()};d(z),i(!0)},_=()=>{i(!1),l(!1),d(null),m(null),f()};return x?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-600"})}):s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Desafios e Prêmios"}),s.jsx("p",{className:"text-gray-600",children:n&&r?"Gerencie desafios de performance e premie sua equipe":n?"Visualize os desafios ativos e acompanhe seu progresso":"Acesso restrito aos desafios"})]}),n&&r?s.jsxs("button",{onClick:E,className:"bg-orange-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:bg-orange-700 transition-colors",children:[s.jsx(ze,{className:"w-4 h-4"}),s.jsx("span",{children:"Adicionar Novo Desafio"})]}):n?s.jsxs("div",{className:"bg-gray-100 text-gray-500 px-4 py-2 rounded-lg flex items-center space-x-2",children:[s.jsx(ft,{className:"w-4 h-4"}),s.jsx("span",{children:"Modo Somente Leitura"})]}):null]}),b&&s.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Yt,{className:"w-5 h-5 text-green-600"}),s.jsx("span",{className:"text-green-800 font-medium",children:b})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total de Desafios"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:v.length})]}),s.jsx("div",{className:"w-12 h-12 rounded-lg bg-purple-500 flex items-center justify-center",children:s.jsx(ft,{className:"w-6 h-6 text-white"})})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Desafios Ativos"}),s.jsx("p",{className:"text-2xl font-bold text-blue-600",children:v.filter(T=>T.status==="active").length})]}),s.jsx("div",{className:"w-12 h-12 rounded-lg bg-blue-500 flex items-center justify-center",children:s.jsx(Lt,{className:"w-6 h-6 text-white"})})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Concluídos"}),s.jsx("p",{className:"text-2xl font-bold text-green-600",children:v.filter(T=>T.status==="completed").length})]}),s.jsx("div",{className:"w-12 h-12 rounded-lg bg-green-500 flex items-center justify-center",children:s.jsx(Yt,{className:"w-6 h-6 text-white"})})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Expirados"}),s.jsx("p",{className:"text-2xl font-bold text-red-600",children:v.filter(T=>T.status==="expired").length})]}),s.jsx("div",{className:"w-12 h-12 rounded-lg bg-red-500 flex items-center justify-center",children:s.jsx(Dn,{className:"w-6 h-6 text-white"})})]})})]}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(ah,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Filtrar por status:"})]}),s.jsxs("select",{value:h,onChange:T=>g(T.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-orange-500",children:[s.jsx("option",{value:"all",children:"Todos"}),s.jsx("option",{value:"active",children:"Ativos"}),s.jsx("option",{value:"completed",children:"Concluídos"}),s.jsx("option",{value:"expired",children:"Expirados"})]}),s.jsxs("div",{className:"text-sm text-gray-500 bg-gray-50 px-3 py-2 rounded-lg",children:["Mostrando ",L.length," de ",v.length," desafios"]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:L.map(T=>s.jsx(Fy,{challenge:T,employees:p,weeklyPerformance:S,proposals:C,onEdit:r?w:void 0,onDelete:r?O:void 0,onAssignWinners:r?U:void 0,onDuplicate:r?N:void 0,readOnly:!r},T.id))}),L.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(ft,{className:"w-8 h-8 text-gray-400"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:h==="all"?"Nenhum desafio criado":`Nenhum desafio ${h==="active"?"ativo":h==="completed"?"concluído":"expirado"}`}),s.jsx("p",{className:"text-gray-500",children:r&&h==="all"?'Clique em "Adicionar Novo Desafio" para começar a engajar sua equipe!':`Não há desafios ${h==="active"?"ativos":h==="completed"?"concluídos":"expirados"} no momento.`})]}),a&&s.jsx(zy,{isOpen:a,onClose:_,challenge:c,employees:p}),o&&u&&s.jsx(Vy,{isOpen:o,onClose:_,challenge:u,employees:p})]})},By=({formData:e,jobRoles:t,workScales:r,cities:n,onSave:a,onBack:i,loading:o})=>{const{data:l=[]}=J("budget_social_charges",{filter:{is_active:!0},orderBy:{column:"charge_name",ascending:!0}}),{data:c=[]}=J("budget_materials",{filter:{is_active:!0},orderBy:{column:"name",ascending:!0}}),{data:d=[]}=J("budget_uniforms",{filter:{is_active:!0},orderBy:{column:"item_name",ascending:!0}}),[u,m]=M.useState({salaryBase:0,nightShift:!1,additionalNight:0,extraNightHour:0,salaryAdditionsTotal:0,block1Total:0,socialCharges:0,block2Total:0,vtValue:6.8,vrValue:25,vaValue:35,benefitsTotal:0,block3Total:0,materials:[],block4Total:0,uniforms:[],block5Total:0,hasIntrajornada:!1,intrajornadaValue:0,block6Total:0,profitMargin:15,adminMargin:4.25,pis:.65,cofins:3,iss:0,bdiTotal:0,block7Total:0,subtotalWithoutBdi:0,finalTotal:0}),h=t.find(E=>E.id===e.cargo_id),g=r.find(E=>E.id===e.escala_id),b=n.find(E=>E.id===e.city_id);M.useEffect(()=>{h&&g&&b&&y()},[h,g,e.turno,b,e.salary_additions]),M.useEffect(()=>{if(c.length>0&&u.materials.length===0){const E=c.slice(0,5).map(w=>({name:w.name,unitValue:w.unit_value||0,quantity:1,total:w.unit_value||0}));m(w=>({...w,materials:E}))}if(d.length>0&&u.uniforms.length===0){const E=d.map(w=>({name:w.item_name,unitValue:w.unit_value||0,qtyPerEmployee:w.qty_per_collaborator||1,usefulLife:w.life_time_months||12,total:0}));m(w=>({...w,uniforms:E}))}},[c,d]);const y=()=>{if(!h||!g||!b)return;const E=h.salary_base||0,w=g.people_quantity||1,O=g.working_days||21,U=e.turno==="Noturno",N=k(E,w,O,U),_=x(N.total),T=f(w,O),I=p(),P=S(w),z=C(E,w),R=N.total+_.total+T.total+I.total+P.total+z.total,$=v(R,((b==null?void 0:b.iss_percent)||0)/100),q=R+$.total;m(Y=>({...Y,salaryBase:E,nightShift:U,additionalNight:N.additionalNight,extraNightHour:N.extraNightHour,salaryAdditionsTotal:N.salaryAdditionsTotal,block1Total:N.total,socialCharges:_.socialCharges,block2Total:_.total,benefitsTotal:T.benefitsTotal,block3Total:T.total,block4Total:I.total,block5Total:P.total,hasIntrajornada:u.hasIntrajornada,intrajornadaValue:z.intrajornadaValue,block6Total:z.total,iss:b.iss_percent,bdiTotal:$.bdiTotal,block7Total:$.total,subtotalWithoutBdi:R,finalTotal:q}))},k=(E,w,O,U)=>{const N=E*w;let _=0,T=0;U&&(_=O*8*E/220*.2*w,T=O*E/220*1.2*w);const I=1412;let P=0;e.salary_additions.forEach(R=>{R.calculationBase==="salario_minimo"?P+=I*(R.percentage/100)*w:R.calculationBase==="salario_base"?P+=E*(R.percentage/100)*w:R.calculationBase==="valor_fixo"&&(P+=(R.fixedValue||0)*w)});const z=N+_+T+P;return{baseSalaryTotal:N,additionalNight:_,extraNightHour:T,salaryAdditionsTotal:P,total:z}},x=E=>{const w=l.reduce((O,U)=>O+E*U.percentage,0);return{socialCharges:w,total:w}},f=(E,w)=>{const O=u.vtValue*w*E,U=u.vrValue*w*E,N=u.vaValue*w*E,_=O+U+N;return{vtTotal:O,vrTotal:U,vaTotal:N,benefitsTotal:_,total:_}},p=()=>({total:u.materials.reduce((w,O)=>w+O.total,0)}),S=E=>{const w=u.uniforms.map(U=>{const N=U.unitValue*U.qtyPerEmployee/U.usefulLife*E;return{...U,total:N}}),O=w.reduce((U,N)=>U+N.total,0);return m(U=>({...U,uniforms:w})),{total:O}},C=(E,w)=>{let O=0;return u.hasIntrajornada&&(O=w*(E/220*1.5)),{intrajornadaValue:O,total:O}},v=(E,w)=>{const O=E*(u.profitMargin/100),U=E*(u.adminMargin/100),N=E*(u.pis/100),_=E*(u.cofins/100),T=E*w,I=O+U+N+_+T;return{profitMarginValue:O,adminMarginValue:U,pisValue:N,cofinsValue:_,issValue:T,bdiTotal:I,total:I}},j=(E,w,O)=>{m(U=>{const N=[...U.materials];return N[E]={...N[E],[w]:O,total:w==="unitValue"?O*N[E].quantity:N[E].unitValue*O},{...U,materials:N}})},A=()=>{m(E=>({...E,materials:[...E.materials,{name:"Novo material",unitValue:0,quantity:1,total:0}]}))},L=E=>{m(w=>({...w,materials:w.materials.filter((O,U)=>U!==E)}))};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 border border-green-200 rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Posto: ",e.nome_posto]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[h==null?void 0:h.role_name," • ",g==null?void 0:g.scale_name," • ",e.turno]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:D(u.finalTotal)}),s.jsx("div",{className:"text-sm text-gray-500",children:"Valor total do posto"})]})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"font-bold text-blue-600",children:D(u.block1Total)}),s.jsx("div",{className:"text-gray-600",children:"Salários"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"font-bold text-purple-600",children:D(u.block2Total+u.block3Total)}),s.jsx("div",{className:"text-gray-600",children:"Encargos + Benefícios"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"font-bold text-orange-600",children:D(u.block4Total+u.block5Total)}),s.jsx("div",{className:"text-gray-600",children:"Materiais + Uniformes"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"font-bold text-red-600",children:D(u.block7Total)}),s.jsx("div",{className:"text-gray-600",children:"BDI"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[s.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx("span",{className:"w-6 h-6 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-bold mr-2",children:"1"}),"Composição de Salário"]}),s.jsxs("div",{className:"space-y-3 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("span",{children:["Salário base (",g==null?void 0:g.people_quantity," pessoas):"]}),s.jsx("span",{className:"font-medium",children:D(u.salaryBase*((g==null?void 0:g.people_quantity)||1))})]}),u.nightShift&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Adicional noturno (20%):"}),s.jsx("span",{className:"font-medium",children:D(u.additionalNight)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Hora noturna adicional:"}),s.jsx("span",{className:"font-medium",children:D(u.extraNightHour)})]})]}),e.salary_additions.length>0&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Adicionais salariais:"}),s.jsx("span",{className:"font-medium",children:D(u.salaryAdditionsTotal)})]}),s.jsxs("div",{className:"border-t pt-2 flex justify-between font-bold text-blue-600",children:[s.jsx("span",{children:"Total Bloco 1:"}),s.jsx("span",{children:D(u.block1Total)})]})]}),e.salary_additions.length>0&&s.jsxs("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:[s.jsx("h5",{className:"text-sm font-medium text-blue-800 mb-2",children:"Adicionais Aplicados:"}),s.jsx("div",{className:"space-y-1 text-xs text-blue-700",children:e.salary_additions.map((E,w)=>{const U=(h==null?void 0:h.salary_base)||0,N=(g==null?void 0:g.people_quantity)||1;let _=0,T="";return E.calculationBase==="salario_minimo"?(_=1412*(E.percentage/100)*N,T=`${E.percentage}% × R$ ${1412 .toFixed(2)} × ${N}`):E.calculationBase==="salario_base"?(_=U*(E.percentage/100)*N,T=`${E.percentage}% × R$ ${U.toFixed(2)} × ${N}`):E.calculationBase==="valor_fixo"?(_=(E.fixedValue||0)*N,T=`R$ ${(E.fixedValue||0).toFixed(2)} × ${N}`):(_=0,T="Base inválida"),s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("span",{children:[E.name,":"]}),s.jsxs("span",{className:"font-medium",children:[D(_)," (",T,")"]})]},w)})})]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[s.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx("span",{className:"w-6 h-6 bg-purple-500 text-white rounded-full flex items-center justify-center text-sm font-bold mr-2",children:"2"}),"Encargos Sociais"]}),s.jsxs("div",{className:"space-y-2 text-sm",children:[l.map(E=>{const w=u.block1Total*E.percentage;return s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("span",{children:[E.charge_name," (",(E.percentage*100).toFixed(2),"%):"]}),s.jsx("span",{className:"font-medium",children:D(w)})]},E.id)}),s.jsxs("div",{className:"border-t pt-2 flex justify-between font-bold text-purple-600",children:[s.jsx("span",{children:"Total Bloco 2:"}),s.jsx("span",{children:D(u.block2Total)})]})]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[s.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx("span",{className:"w-6 h-6 bg-green-500 text-white rounded-full flex items-center justify-center text-sm font-bold mr-2",children:"3"}),"Benefícios Mensais"]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm text-gray-700",children:"VT (por dia):"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"text-xs text-gray-500",children:"R$"}),s.jsx("input",{type:"number",value:u.vtValue,onChange:E=>m(w=>({...w,vtValue:parseFloat(E.target.value)||0})),className:"w-20 px-2 py-1 text-sm border border-gray-300 rounded text-right",step:"0.01",min:"0"})]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("label",{className:"text-sm text-gray-700",children:"VR (por dia):"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"text-xs text-gray-500",children:"R$"}),s.jsx("input",{type:"number",value:u.vrValue,onChange:E=>m(w=>({...w,vrValue:parseFloat(E.target.value)||0})),className:"w-20 px-2 py-1 text-sm border border-gray-300 rounded text-right",step:"0.01",min:"0"})]})]}),s.jsxs("div",{className:"border-t pt-2 flex justify-between font-bold text-green-600",children:[s.jsx("span",{children:"Total Bloco 3:"}),s.jsx("span",{children:D(u.block3Total)})]})]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[s.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx("span",{className:"w-6 h-6 bg-orange-500 text-white rounded-full flex items-center justify-center text-sm font-bold mr-2",children:"4"}),"Materiais"]}),s.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:u.materials.map((E,w)=>s.jsxs("div",{className:"grid grid-cols-3 gap-2 items-center text-sm",children:[s.jsx("input",{type:"text",value:E.name,onChange:O=>{m(U=>{const N=[...U.materials];return N[w].name=O.target.value,{...U,materials:N}})},className:"px-2 py-1 border border-gray-300 rounded text-xs",placeholder:"Nome do material"}),s.jsx("input",{type:"number",value:E.unitValue,onChange:O=>j(w,"unitValue",parseFloat(O.target.value)||0),className:"px-2 py-1 border border-gray-300 rounded text-xs text-right",placeholder:"Valor",step:"0.01",min:"0"}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("input",{type:"number",value:E.quantity,onChange:O=>j(w,"quantity",parseFloat(O.target.value)||0),className:"w-12 px-1 py-1 border border-gray-300 rounded text-xs text-center",placeholder:"Qtd",min:"0"}),s.jsx("button",{onClick:()=>L(w),className:"text-red-500 hover:text-red-700 text-xs",children:"×"})]})]},w))}),s.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[s.jsx("button",{onClick:A,className:"text-sm text-blue-600 hover:text-blue-800",children:"+ Adicionar material"}),s.jsx("div",{className:"font-bold text-orange-600",children:D(u.block4Total)})]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[s.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx("span",{className:"w-6 h-6 bg-indigo-500 text-white rounded-full flex items-center justify-center text-sm font-bold mr-2",children:"6"}),"Custos de Intrajornada"]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("label",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"radio",name:"intrajornada",checked:!u.hasIntrajornada,onChange:()=>m(E=>({...E,hasIntrajornada:!1})),className:"text-red-600"}),s.jsx("span",{className:"text-sm",children:"Sem intrajornada"})]}),s.jsxs("label",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"radio",name:"intrajornada",checked:u.hasIntrajornada,onChange:()=>m(E=>({...E,hasIntrajornada:!0})),className:"text-green-600"}),s.jsx("span",{className:"text-sm",children:"Com intrajornada remunerada"})]})]}),u.hasIntrajornada&&s.jsxs("div",{className:"text-xs text-gray-600 bg-blue-50 p-2 rounded",children:[s.jsx("strong",{children:"Fórmula:"})," ",g==null?void 0:g.people_quantity," × (",h==null?void 0:h.salary_base," ÷ 220 × 1,5)"]}),s.jsxs("div",{className:"border-t pt-2 flex justify-between font-bold text-indigo-600",children:[s.jsx("span",{children:"Total Bloco 6:"}),s.jsx("span",{children:D(u.block6Total)})]})]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[s.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx("span",{className:"w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center text-sm font-bold mr-2",children:"7"}),"BDI - Base de Despesas Indiretas"]}),s.jsxs("div",{className:"space-y-3 text-sm",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{children:"Margem de Lucro:"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"number",value:u.profitMargin,onChange:E=>m(w=>({...w,profitMargin:parseFloat(E.target.value)||0})),className:"w-16 px-2 py-1 border border-gray-300 rounded text-right",step:"0.01",min:"0"}),s.jsx("span",{children:"%"})]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Margem Administrativa (fixo):"}),s.jsxs("span",{children:[u.adminMargin,"%"]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"PIS (fixo):"}),s.jsxs("span",{children:[u.pis,"%"]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Cofins (fixo):"}),s.jsxs("span",{children:[u.cofins,"%"]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("span",{children:["ISS ",b==null?void 0:b.city_name,":"]}),s.jsxs("span",{children:[b==null?void 0:b.iss_percent,"%"]})]}),s.jsxs("div",{className:"border-t pt-2 flex justify-between font-bold text-red-600",children:[s.jsx("span",{children:"Total BDI:"}),s.jsx("span",{children:D(u.block7Total)})]})]})]})]}),s.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-green-600 text-white rounded-lg p-6",children:[s.jsxs("h4",{className:"text-xl font-bold mb-4 flex items-center",children:[s.jsx(yf,{className:"w-6 h-6 mr-2"}),"Resumo Financeiro do Posto"]}),s.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-lg font-bold mb-2",children:"Subtotal (sem BDI)"}),s.jsx("div",{className:"text-2xl font-bold",children:D(u.subtotalWithoutBdi)})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-lg font-bold mb-2",children:"Total Final (com BDI)"}),s.jsx("div",{className:"text-3xl font-bold",children:D(u.finalTotal)})]})]})]}),s.jsxs("div",{className:"flex space-x-4",children:[s.jsxs("button",{onClick:i,disabled:o,className:"flex items-center space-x-2 px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:[s.jsx(Xo,{className:"w-4 h-4"}),s.jsx("span",{children:"Voltar"})]}),s.jsxs("button",{onClick:()=>a(u.finalTotal),disabled:o,className:"flex-1 bg-green-600 text-white py-3 px-6 rounded-lg font-medium hover:bg-green-700 transition-colors disabled:opacity-50 flex items-center justify-center space-x-2",children:[s.jsx(hs,{className:"w-4 h-4"}),s.jsx("span",{children:o?"Salvando Posto...":"Salvar Posto Completo"})]})]})]})},qy=({isOpen:e,onClose:t,budgetId:r,onPositionAdded:n})=>{const[a,i]=M.useState(!1),[o,l]=M.useState("basic"),[c,d]=M.useState({name:"",salary:""}),[u,m]=M.useState({name:"",people:"",days:""});M.useState({name:"",description:""});const[h,g]=M.useState(!1),[b,y]=M.useState(!1),[k,x]=M.useState({nome_posto:"",cargo_id:"",escala_id:"",turno:"Diurno",city_id:"",salary_additions:[]}),{data:f=[],refetch:p}=J("budget_job_roles",{filter:{is_active:!0},orderBy:{column:"role_name",ascending:!0}}),{data:S=[],refetch:C}=J("budget_work_scales",{filter:{is_active:!0},orderBy:{column:"scale_name",ascending:!0}}),{data:v=[]}=J("budget_salary_additions",{filter:{is_active:!0},orderBy:{column:"name",ascending:!0}}),{data:j=[],loading:A}=J("budget_iss_rates",{select:"id, city_name, iss_rate, is_active",filter:{is_active:!0},orderBy:{column:"city_name",ascending:!0}});je.useEffect(()=>{console.log("🏙️ Cidades carregadas da tabela budget_iss_rates:",{total:j.length,cities:j.map($=>({id:$.id,nome:$.city_name,iss:$.iss_rate,ativa:$.is_active})),tabela:"budget_iss_rates",filtro:"is_active = true"})},[j]);const{insert:L}=Ns("budget_job_roles"),{insert:E}=Ns("budget_work_scales"),{insert:w}=Ns("budget_posts");if(!e)return null;const O=async $=>{if($.preventDefault(),!k.nome_posto.trim()){alert("O nome do posto é obrigatório");return}if(!k.cargo_id){alert("Selecione um cargo");return}if(!k.escala_id){alert("Selecione uma escala");return}if(!k.turno){alert("Selecione um turno");return}if(!k.city_id){alert("Selecione uma cidade para o ISS");return}l("calculations")},U=async $=>{i(!0);try{console.log("🚀 Salvando posto no banco de dados:",{budgetId:r,formData:k,finalTotal:$});const q={budget_id:r,post_name:k.nome_posto,role_id:k.cargo_id,scale_id:k.escala_id,turn:k.turno,city_id:k.city_id,salary_additions:k.salary_additions,total_cost:$},Y=await w(q);console.log("✅ Posto salvo no banco:",Y),alert(`✅ Posto "${k.nome_posto}" salvo com sucesso!

💰 Custo total: ${$.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}
🔄 Total do orçamento será atualizado automaticamente.`),n($),t()}catch(q){console.error("Erro ao salvar posto:",q),alert(`❌ Erro ao salvar posto: ${q instanceof Error?q.message:"Erro desconhecido"}

Verifique se todas as tabelas auxiliares estão criadas no Supabase.`)}finally{i(!1)}},N=async()=>{if(!c.name.trim()||!c.salary){alert("⚠️ Preencha o nome do cargo e o salário base.");return}try{await L({role_name:c.name,salary_base:parseFloat(c.salary),is_active:!0}),d({name:"",salary:""}),y(!1),p(),alert("✅ Cargo adicionado com sucesso!")}catch($){alert(`❌ Erro ao adicionar cargo: ${$ instanceof Error?$.message:"Erro desconhecido"}`)}},_=async()=>{if(!u.name.trim()||!u.people||!u.days){alert("⚠️ Preencha todos os campos da escala.");return}try{await E({scale_name:u.name,people_quantity:parseFloat(u.people),working_days:parseFloat(u.days),is_active:!0}),m({name:"",people:"",days:""}),g(!1),C(),alert("✅ Escala adicionada com sucesso!")}catch($){alert(`❌ Erro ao adicionar escala: ${$ instanceof Error?$.message:"Erro desconhecido"}`)}},T=$=>{x(q=>({...q,salary_additions:[...q.salary_additions,{addition_id:$,value:0}]}))},I=$=>{x(q=>({...q,salary_additions:q.salary_additions.filter((Y,F)=>F!==$)}))},P=($,q)=>{x(Y=>({...Y,salary_additions:Y.salary_additions.map((F,G)=>G===$?{...F,value:q}:F)}))},z=()=>{x({nome_posto:"",cargo_id:"",escala_id:"",turno:"Diurno",city_id:"",salary_additions:[]}),l("basic")},R=()=>{z(),t()};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-6xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:s.jsx(Ve,{className:"w-5 h-5 text-green-600"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:o==="basic"?"Novo Posto - Configurações Básicas":"Novo Posto - Blocos de Cálculo"}),s.jsx("p",{className:"text-sm text-gray-600",children:o==="basic"?"Configure cargo, escala, turno e cidade":"Configure os 8 blocos de cálculo do posto"})]})]}),s.jsx("button",{onClick:R,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(ne,{className:"w-5 h-5 text-gray-500"})})]}),o==="basic"?s.jsxs("form",{onSubmit:O,className:"p-6 space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome do Posto"}),s.jsx("input",{type:"text",value:k.nome_posto,onChange:$=>x({...k,nome_posto:$.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",required:!0,placeholder:"Ex: Portaria Principal, Limpeza Geral..."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cargo"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("select",{value:k.cargo_id,onChange:$=>x({...k,cargo_id:$.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",required:!0,children:[s.jsx("option",{value:"",children:"Selecione um cargo"}),f.map($=>s.jsxs("option",{value:$.id,children:[$.role_name," - R$ ",$.salary_base?$.salary_base.toFixed(2):"0.00"]},$.id))]}),s.jsx("button",{type:"button",onClick:()=>y(!0),className:"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",title:"Adicionar novo cargo",children:s.jsx(ze,{className:"w-4 h-4"})})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Escala de Trabalho"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("select",{value:k.escala_id,onChange:$=>x({...k,escala_id:$.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",required:!0,children:[s.jsx("option",{value:"",children:"Selecione uma escala"}),S.map($=>s.jsxs("option",{value:$.id,children:[$.scale_name," - ",$.people_quantity," pessoas - ",$.working_days," dias"]},$.id))]}),s.jsx("button",{type:"button",onClick:()=>g(!0),className:"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",title:"Adicionar nova escala",children:s.jsx(ze,{className:"w-4 h-4"})})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Turno"}),s.jsxs("select",{value:k.turno,onChange:$=>x({...k,turno:$.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",required:!0,children:[s.jsx("option",{value:"",children:"Selecione um turno"}),s.jsx("option",{value:"Diurno",children:"Diurno"}),s.jsx("option",{value:"Noturno",children:"Noturno"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cidade (para cálculo do ISS)"}),A?s.jsx("div",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-500",children:"Carregando cidades..."}):s.jsxs("select",{value:k.city_id,onChange:$=>x({...k,city_id:$.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",required:!0,children:[s.jsx("option",{value:"",children:"Selecione uma cidade"}),j.length>0?j.map($=>s.jsxs("option",{value:$.id,children:[$.city_name," (",$.iss_rate||0,"% ISS)"]},$.id)):null]}),!A&&s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:j.length>0?`✅ ${j.length} cidade${j.length>1?"s ativas":" ativa"} da tabela budget_iss_rates`:"❌ Nenhuma cidade encontrada - verifique se a migração foi aplicada"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Adicionais Salariais (Opcional)"}),k.salary_additions.length>0&&s.jsx("div",{className:"space-y-2 mb-3",children:k.salary_additions.map(($,q)=>{const Y=v.find(F=>F.id===$.addition_id);return s.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-gray-50 rounded border",children:[s.jsx("span",{className:"flex-1 text-sm",children:Y==null?void 0:Y.name}),s.jsx("input",{type:"number",value:$.value,onChange:F=>P(q,parseFloat(F.target.value)||0),className:"w-20 px-2 py-1 text-sm border border-gray-300 rounded",placeholder:"0.00",step:"0.01",min:"0"}),s.jsx("span",{className:"text-sm text-gray-500",children:"%"}),s.jsx("button",{type:"button",onClick:()=>I(q),className:"p-1 text-red-600 hover:text-red-800",children:s.jsx(ne,{className:"w-3 h-3"})})]},q)})}),s.jsxs("select",{onChange:$=>{$.target.value&&(T($.target.value),$.target.value="")},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",children:[s.jsx("option",{value:"",children:"Adicionar adicional salarial..."}),v.filter($=>!k.salary_additions.some(q=>q.addition_id===$.id)).map($=>s.jsxs("option",{value:$.id,children:[$.name," (",$.default_percentage,"% padrão)"]},$.id))]})]}),s.jsxs("div",{className:"flex space-x-4",children:[s.jsx("button",{type:"submit",disabled:a,className:"flex-1 bg-green-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-green-700 transition-colors disabled:opacity-50",children:"Próximo: Configurar Blocos →"}),s.jsx("button",{type:"button",onClick:R,disabled:a,className:"flex-1 border border-gray-300 text-gray-700 py-3 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Cancelar"})]})]}):s.jsx("div",{className:"p-6",children:s.jsx(By,{formData:k,jobRoles:f,workScales:S,cities:j,salaryAdditions:v,onSave:U,onBack:()=>l("basic"),loading:a})})]})}),h&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-60",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:s.jsx(Lt,{className:"w-4 h-4 text-blue-600"})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Adicionar Nova Escala"})]}),s.jsx("button",{onClick:()=>g(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(ne,{className:"w-4 h-4 text-gray-500"})})]}),s.jsxs("div",{className:"p-6 space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome da Escala"}),s.jsx("input",{type:"text",value:u.name,onChange:$=>m({...u,name:$.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ex: 12h segunda a sexta",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quantidade de Pessoas"}),s.jsx("input",{type:"number",value:u.people,onChange:$=>m({...u,people:$.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"1.37",step:"0.01",min:"0",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dias Trabalhados no Mês"}),s.jsx("input",{type:"number",value:u.days,onChange:$=>m({...u,days:$.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"21.00",step:"0.01",min:"0",required:!0})]}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:_,className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"Adicionar Escala"}),s.jsx("button",{onClick:()=>g(!1),className:"flex-1 border border-gray-300 text-gray-700 py-2 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Cancelar"})]})]})]})}),b&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-60",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:s.jsx(nh,{className:"w-4 h-4 text-blue-600"})}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Adicionar Novo Cargo"})]}),s.jsx("button",{onClick:()=>y(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(ne,{className:"w-4 h-4 text-gray-500"})})]}),s.jsxs("div",{className:"p-6 space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome do Cargo"}),s.jsx("input",{type:"text",value:c.name,onChange:$=>d({...c,name:$.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ex: Técnico de Segurança",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Salário Base (R$)"}),s.jsx("input",{type:"number",value:c.salary,onChange:$=>d({...c,salary:$.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"1412.00",step:"0.01",min:"0",required:!0})]}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:N,className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"Adicionar Cargo"}),s.jsx("button",{onClick:()=>y(!1),className:"flex-1 border border-gray-300 text-gray-700 py-2 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Cancelar"})]})]})]})})]})},Wy=({isOpen:e,onClose:t,budget:r})=>{const[n,a]=M.useState(!1),[i,o]=M.useState(!1),[l,c]=M.useState(null);Ns("budgets");const[d,u]=M.useState({nome:""}),{data:m=[],refetch:h}=J("budget_posts",{filter:l?{budget_id:l}:void 0,select:"id, post_name, role_id, scale_id, turn_id, city_id, salary_additions, total_cost, created_at",orderBy:{column:"created_at",ascending:!0}});if(M.useEffect(()=>{r?(u({nome:r.nome||""}),c(r.id)):(u({nome:""}),c(null))},[r]),!e)return null;const g=async x=>{x.preventDefault(),a(!0);try{const f=Math.floor(Math.random()*1e6)+1e5,p={client:d.nome,project_name:d.nome,budget_number:f,total_value:0,status:"Rascunho"};if(r&&r.id){const{data:S,error:C}=await ie.from("budgets").update({client:p.client,project_name:p.project_name,updated_at:new Date().toISOString()}).eq("id",r.id).select().single();if(C)throw C;console.log("🔄 Orçamento atualizado:",S),c(r.id),alert("✅ Orçamento atualizado com sucesso!")}else{console.log("➕ Criando novo orçamento no Supabase:",p);const{data:S,error:C}=await ie.from("budgets").insert(p).select().single();if(C)throw C;console.log("✅ Orçamento criado com UUID:",S),c(S.id),alert(`✅ Orçamento criado com sucesso!

📋 ID: ${S.id}
🔢 Número: #${S.budget_number}

➡️ Agora você pode adicionar postos ao orçamento.`)}ht("budgets")}catch(f){console.error("Erro ao salvar orçamento:",f),alert(`❌ Erro ao salvar orçamento: ${f instanceof Error?f.message:"Erro desconhecido"}`)}finally{a(!1)}},b=()=>{if(!l){alert("⚠️ Salve o orçamento primeiro antes de adicionar postos.");return}o(!0)},y=x=>{console.log("🔄 Posto adicionado com custo:",x),h(),o(!1)},k=x=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(x);return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:s.jsx(Us,{className:"w-5 h-5 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:r?"Editar Orçamento":"Novo Orçamento"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Configure os dados básicos e adicione postos"})]})]}),s.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(ne,{className:"w-5 h-5 text-gray-500"})})]}),s.jsxs("div",{className:"p-6",children:[s.jsxs("form",{onSubmit:g,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome do Orçamento"}),s.jsx("input",{type:"text",value:d.nome,onChange:x=>u({...d,nome:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,placeholder:"Ex: Serviços de Segurança - Empresa ABC"})]}),s.jsxs("div",{className:"flex space-x-4",children:[s.jsx("button",{type:"submit",disabled:n,className:"flex-1 bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:opacity-50",children:n?"Salvando...":r?"Atualizar Orçamento":"Criar Orçamento"}),s.jsx("button",{type:"button",onClick:t,disabled:n,className:"flex-1 border border-gray-300 text-gray-700 py-3 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Cancelar"})]})]}),l&&s.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Postos do Orçamento"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Cada posto possui 8 blocos de cálculo"})]}),s.jsxs("button",{onClick:b,className:"bg-green-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:bg-green-700 transition-colors",children:[s.jsx(ze,{className:"w-4 h-4"}),s.jsx("span",{children:"Adicionar Posto"})]})]}),m.length>0?s.jsx("div",{className:"space-y-4 max-h-80 overflow-y-auto",children:m.map((x,f)=>s.jsx("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h4",{className:"font-medium text-gray-900",children:[f+1,". ",x.post_name]}),s.jsx("div",{className:"text-sm text-gray-600 mt-1 space-y-1",children:s.jsxs("div",{children:["📅 Criado: ",new Date(x.created_at).toLocaleDateString("pt-BR")]})})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-lg font-semibold text-green-600",children:k(x.total_cost||0)}),s.jsx("div",{className:"text-sm text-gray-500",children:"Custo calculado"})]})]})},x.id))}):s.jsxs("div",{className:"text-center py-8 border-2 border-dashed border-gray-300 rounded-lg",children:[s.jsx(Ve,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),s.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum posto adicionado"}),s.jsx("p",{className:"text-sm text-gray-500",children:'Clique em "Adicionar Posto\\" para começar a construir o orçamento'})]})]})]})]})}),i&&l&&s.jsx(qy,{isOpen:i,onClose:()=>o(!1),budgetId:l,onPositionAdded:y})]})},Hy=()=>{const{canEdit:e,canView:t}=Js(),r=e("budgets"),n=t("budgets"),[a,i]=M.useState(!1),[o,l]=M.useState(null),{data:c=[],loading:d,refetch:u}=J("budgets",{orderBy:{column:"created_at",ascending:!1}}),{data:m=[]}=J("budget_posts"),h=()=>{l(null),i(!0)},g=j=>{l(j),i(!0)},b=()=>{i(!1),l(null),u()},y=async j=>{try{console.log("✅ Aprovando orçamento:",j),alert(`✅ Orçamento aprovado com sucesso!

🔄 Funcionalidade de integração com propostas será implementada em breve.`),u()}catch(A){console.error("Erro ao aprovar orçamento:",A),alert("❌ Erro ao aprovar orçamento: Funcionalidade em desenvolvimento")}},k=async j=>{try{console.log("❌ Reprovando orçamento:",j),alert("❌ Orçamento reprovado com sucesso."),u()}catch(A){console.error("Erro ao reprovar orçamento:",A),alert("❌ Erro ao reprovar orçamento: Funcionalidade em desenvolvimento")}};if(d)return s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});const x=j=>{switch(j){case"aprovado":return"bg-green-100 text-green-800";case"pendente":return"bg-yellow-100 text-yellow-800";case"reprovado":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},f=j=>{switch(j){case"aprovado":return"Aprovado";case"pendente":return"Pendente";case"reprovado":return"Reprovado";default:return j}},p=c.length,S=c.filter(j=>j.status==="aprovado").length,C=c.filter(j=>j.status==="pendente").length,v=c.filter(j=>j.status==="reprovado").length;return s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Orçamentos de Serviço"}),s.jsx("p",{className:"text-gray-600",children:n&&r?"Gerencie orçamentos modulares com postos e blocos de cálculo":n?"Visualize os orçamentos do sistema (modo somente leitura)":"Acesso restrito aos orçamentos"})]}),n&&r?s.jsxs("button",{onClick:h,className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:bg-blue-700 transition-colors",children:[s.jsx(ze,{className:"w-4 h-4"}),s.jsx("span",{children:"Novo Orçamento"})]}):n?s.jsxs("div",{className:"bg-gray-100 text-gray-500 px-4 py-2 rounded-lg flex items-center space-x-2",children:[s.jsx(Us,{className:"w-4 h-4"}),s.jsx("span",{children:"Modo Somente Leitura"})]}):null]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total de Orçamentos"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:p})]}),s.jsx("div",{className:"w-12 h-12 rounded-lg bg-blue-500 flex items-center justify-center",children:s.jsx(Us,{className:"w-6 h-6 text-white"})})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pendentes"}),s.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:C})]}),s.jsx("div",{className:"w-12 h-12 rounded-lg bg-yellow-500 flex items-center justify-center",children:s.jsx(Lt,{className:"w-6 h-6 text-white"})})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Reprovados"}),s.jsx("p",{className:"text-2xl font-bold text-red-600",children:v})]}),s.jsx("div",{className:"w-12 h-12 rounded-lg bg-red-500 flex items-center justify-center",children:s.jsx(ne,{className:"w-6 h-6 text-white"})})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Aprovados"}),s.jsx("p",{className:"text-2xl font-bold text-green-600",children:S})]}),s.jsx("div",{className:"w-12 h-12 rounded-lg bg-green-500 flex items-center justify-center",children:s.jsx(wr,{className:"w-6 h-6 text-white"})})]})})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Orçamentos Cadastrados"})}),c.length>0?s.jsx("div",{className:"divide-y divide-gray-200",children:c.map(j=>s.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[s.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["#",j.budget_number||"TBD"," - ",j.project_name||j.client||"Orçamento sem nome"]}),s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${x(j.status)}`,children:f(j.status)})]}),s.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[s.jsxs("span",{children:["Criado em: ",st(j.created_at)]}),s.jsxs("span",{children:[m.filter(A=>A.budget_id===j.id).length," postos"]})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[r&&j.status==="pendente"&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>y(j.id),className:"px-3 py-1 bg-green-600 text-white text-xs rounded-lg hover:bg-green-700 transition-colors",children:"Aprovar"}),s.jsx("button",{onClick:()=>k(j.id),className:"px-3 py-1 bg-red-600 text-white text-xs rounded-lg hover:bg-red-700 transition-colors",children:"Reprovar"})]}),r&&s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>g(j),className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Editar orçamento",children:s.jsx(Zt,{className:"w-4 h-4"})}),s.jsx("button",{className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Excluir orçamento",children:s.jsx(It,{className:"w-4 h-4"})})]})]})]})},j.id))}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(Us,{className:"w-8 h-8 text-gray-400"})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum orçamento criado"}),s.jsx("p",{className:"text-gray-500",children:r?'Clique em "Novo Orçamento" para começar a criar orçamentos de serviços.':"Não há orçamentos cadastrados no sistema."})]})]}),a&&s.jsx(Wy,{isOpen:a,onClose:b,budget:o}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-4",children:"Como Funciona"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-blue-800",children:[s.jsxs("div",{children:[s.jsxs("p",{children:["• ",s.jsx("strong",{children:"1. Criação:"})," Novo orçamento com nome"]}),s.jsxs("p",{children:["• ",s.jsx("strong",{children:"2. Postos:"})," Adicionar postos com cargo/escala/turno"]}),s.jsxs("p",{children:["• ",s.jsx("strong",{children:"3. Blocos:"})," 8 blocos fixos de cálculo por posto"]})]}),s.jsxs("div",{children:[s.jsxs("p",{children:["• ",s.jsx("strong",{children:"4. Aprovação:"})," Admin aprova/reprova orçamentos"]}),s.jsxs("p",{children:["• ",s.jsx("strong",{children:"5. Integração:"})," Orçamento aprovado → Nova proposta"]}),s.jsxs("p",{children:["• ",s.jsx("strong",{children:"6. Configurações:"})," Cargos e escalas editáveis"]})]})]})]})]})};function Gy(){const[e,t]=M.useState("dashboard"),[r,n]=M.useState(0),[a,i]=M.useState(!1);J("weekly_performance",{orderBy:{column:"created_at",ascending:!1}});const o=()=>{console.log("Refreshing all app data..."),n(m=>m+1)},l=()=>{i(!a)},c=()=>{i(!1)},d=m=>{t(m),c()},u=()=>{switch(e){case"dashboard":return s.jsx(my,{},`dashboard-${r}`);case"proposals":return s.jsx(Bd,{onDataChange:o},`proposals-${r}`);case"commissions":return s.jsx(Ty,{},`commissions-${r}`);case"weekly-performance":return s.jsx(Ay,{});case"bonus-fund":return s.jsx($y,{},`bonus-fund-${r}`);case"employee-of-month":return s.jsx(My,{});case"challenges":return s.jsx(Uy,{},`challenges-${r}`);case"budgets":return s.jsx(Hy,{},`budgets-${r}`);case"settings":return s.jsx(Ly,{});default:return s.jsx(Bd,{onDataChange:o},`proposals-${r}`)}};return s.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[s.jsx("button",{onClick:l,className:"md:hidden fixed top-4 left-4 z-50 p-2 bg-white rounded-lg shadow-lg border border-gray-200 hover:bg-gray-50 transition-colors",children:a?s.jsx(ne,{className:"w-6 h-6 text-gray-600"}):s.jsx(Pf,{className:"w-6 h-6 text-gray-600"})}),s.jsx("div",{className:`
        fixed inset-y-0 left-0 z-40 w-64 
        transform transition-transform duration-300 ease-in-out
        md:relative md:translate-x-0 md:z-auto
        ${a?"translate-x-0":"-translate-x-full"}
      `,children:s.jsx(Lf,{activeTab:e,setActiveTab:d})}),a&&s.jsx("div",{className:"md:hidden fixed inset-0 z-30 bg-black bg-opacity-50",onClick:c}),s.jsx("main",{className:"flex-1 overflow-y-auto md:ml-0 pt-16 md:pt-0",children:u()})]})}sh(document.getElementById("root")).render(s.jsx(M.StrictMode,{children:s.jsx(Mf,{children:s.jsx(Of,{children:s.jsx(Gy,{})})})}));
